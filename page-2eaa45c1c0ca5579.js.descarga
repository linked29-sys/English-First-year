!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3f2a4de6-18c9-49a5-9772-69fbad5e822d",e._sentryDebugIdIdentifier="sentry-dbid-3f2a4de6-18c9-49a5-9772-69fbad5e822d")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41340],{27502:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(79342),l=s(25859),n=s(23232),i=s(91102),r=s(88382),o=s(65146),c=s(39489),d=s(10953),u=s(61312),m=s(97225),h=s(16506),f=s(4295),x=s(39116),p=s(11750);function g(){let{t:e}=(0,o.Bd)("base"),t=(0,n._)(),{os:s}=(0,i.c)(),{APP_STORE_URL:g,GOOGLE_PLAY_URL:j}=(0,c.v)(),[y,b]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),N=(0,x.useRouter)(),{resolvedTheme:I,setTheme:C}=(0,h.D)(),S=(0,f.c)();(0,r.useEffect)(()=>{"dark"!==I&&C("dark")},[]),(0,r.useEffect)(()=>{if("undetermined"!==s&&!y){b(!0);let{ios:e,android:t}=v(),a=document.createElement("iframe");"android"===s?a.src=t:a.src=e,a.style.display="none",a.height="0",a.width="0",document.body.appendChild(a),setTimeout(()=>{document.hasFocus()&&document.body.removeChild(a)},1e3)}},[s,y]);let E=(0,r.useCallback)(()=>{t("clicked_download_app",s,{location:"imagine-page",os:s}),"android"!==s?window.location.href=g:window.location.href=j},[t,s,g,j]),_=(0,r.useCallback)(()=>{let e=new URLSearchParams({return_to:location.pathname}).toString();t("sign_up_redirect",s,{location:"imagine-page",os:s}),N.push("/sign-up".concat(e?"?".concat(e):""))},[t,s,N]),z=(0,r.useCallback)(()=>{let e=new URLSearchParams({return_to:location.pathname}).toString();t("sign_in_redirect",s,{location:"imagine-page",os:s}),N.push("/sign-in".concat(e?"?".concat(e):""))},[t,s,N]),{setOpen:P}=(0,m.cL)(),A=(0,r.useRef)(null);return((0,r.useEffect)(()=>{function e(){let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}return P(!1),e(),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}},[]),"undetermined"===s)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-secondary",children:e("imagine.loading","Loading...")})]})}):(0,a.jsxs)("div",{className:(0,u.cn)("dark min-w-full flex items-center justify-center px-4","relative overflow-hidden"),style:{height:"calc(var(--vh, 1vh) * 100)"},onClick:()=>{var e;null==(e=A.current)||e.play()},children:[(0,a.jsx)("div",{className:(0,u.cn)("absolute inset-0 bg-cover bg-center bg-no-repeat",'bg-[url("/backgrounds/grok-imagine-small.png")]','md:bg-[url("/backgrounds/grok-imagine-medium.png")]',"transition-opacity ease-in-out"),style:{opacity:+!w,transitionDuration:"2000ms",zIndex:1}}),(0,a.jsx)("video",{ref:A,autoPlay:!0,muted:!0,loop:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover",style:{zIndex:0,transform:"scale(1.2) translate(-10px, -180px)"},onLoadedData:()=>{var e;k(!0),null==(e=A.current)||e.play()},onError:()=>k(!1),children:(0,a.jsx)("source",{src:"https://storage.googleapis.com/grok-web-public/grok-imagine-horizontal-4k.mp4",type:"video/mp4"})}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/90 to-transparent pointer-events-none",style:{zIndex:2}}),(0,a.jsxs)("div",{className:"flex flex-col items-center text-center max-w-md mx-auto relative z-10",children:[(0,a.jsx)(d.$r,{className:"w-24 h-24 text-primary"}),(0,a.jsx)("h1",{className:"text-[56px] text-primary mt-3 leading-none tracking-[-2.5px] font-[550]",children:e("imagine.title","Grok Imagine")}),(0,a.jsx)("p",{className:"text-xl text-primary mt-6",children:e("imagine.subtitle","Introducing the fastest image and video generation experience")}),!S&&(0,a.jsxs)("div",{className:"flex flex-row gap-4 items-center mt-8",children:[(0,a.jsxs)(l.$n,{className:"font-semibold text-xl",variant:"primary",size:"xl",shape:"pill",onClick:_,children:[(0,a.jsx)(p.KJW,{size:18,strokeWidth:3}),e("Sign up","Sign up")]}),(0,a.jsx)(l.$n,{className:"font-semibold text-xl",variant:"secondary",size:"xl",shape:"pill",onClick:z,children:e("Sign in","Sign in")})]}),S&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.$n,{variant:"primary",size:"xl",shape:"pill",onClick:E,className:"mt-8 mb-10 text-xl font-semibold",children:e("imagine.download_button","Download Grok app")}),(0,a.jsx)("button",{type:"button",onClick:()=>{t("clicked_have_app",s,{location:"imagine-page",os:s});let{ios:e,android:a}=v();"android"!==s?window.location.href=e:window.location.href=a},className:"text-primary underline transition-colors text-base cursor-pointer bg-transparent border-0 p-0",children:e("imagine.app_link_2","I already have the app")})]})]})]})}function v(){let e=window.location.pathname,t=window.location.search,s=e.replace(/^\/imagine/,""),a="source=web";return t&&(a=t.substring(1)+"&"+a),{ios:"com.grokapp://imagine".concat(s,"?").concat(a),android:"intent://imagine".concat(s,"?").concat(a,"#Intent;scheme=grok;package=com.grokapp;end")}}},38245:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(79342),l=s(28503),n=s(10953),i=s(84499),r=s(65146);function o(){let{t:e}=(0,r.Bd)("base");return(0,a.jsxs)("div",{className:"w-full min-h-dvh flex flex-col items-center justify-center pt-4",children:[(0,a.jsx)(i.N_,{route:{page:"main"},className:"block focus:outline-none focus-visible:ring-1 focus-visible:ring-ring rounded-lg",children:(0,a.jsx)(n.r1,{height:20,width:60,className:"opacity-80 hover:opacity-100 fill-black dark:fill-white"})}),(0,a.jsx)(l.J,{title:e("pages.404.title","Page not found"),description:e("pages.404.description","There was an error loading this page. Please verify that you are using a correct URL or contact one of the admins if the issue persists."),cta:e("pages.404.home","Return to home")})]})}},41405:(e,t,s)=>{"use strict";function a(e){let t=["B","KB","MB","GB","TB"];if(0===e||e===BigInt(0))return"0.00 B";let s="bigint"==typeof e?Number(e):e;if("bigint"==typeof e&&e>BigInt(Number.MAX_SAFE_INTEGER)){let s=0,a=e;for(;a>=BigInt(1e3)&&s<t.length-1;)a/=BigInt(1e3),s++;return Number(a).toFixed(2)+" "+t[s]}let a=Math.floor(Math.log(s)/Math.log(1e3));return(s/Math.pow(1e3,a)).toFixed(2)+" "+t[a]}s.d(t,{z:()=>a})},55410:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>lT});var a=s(79342),l=s(13002),n=s(38614),i=s(20301),r=s(13010),o=s(28503),c=s(54344),d=s(11750),u=s(57614),m=s(56691),h=s(61312),f=s(33846),x=s(84969),p=s(65146),g=s(61349),v=s(68332),j=s(56115),y=s(23232),b=s(24734),w=s(17703),k=s(55985),N=s(49972),I=s(56907),C=s(74995),S=s(14908);let E="soft-deleted-conversations",_=()=>{let{data:e,fetchNextPage:t,hasNextPage:s,isFetchingNextPage:a,isLoading:l,error:n,refetch:i}=(0,I.qu)({queryKey:[E],queryFn:async e=>{let{pageParam:t}=e;return await k.chatApi.chatListSoftDeletedConversations({pageSize:"100",pageToken:t})},getNextPageParam:e=>e.nextPageToken||void 0,initialPageParam:void 0,staleTime:0}),r=(null==e?void 0:e.pages.flatMap(e=>e.conversations||[]))||[],{loadMoreRef:o,historyContainerRef:c}=(0,j.R)({hasNextPage:s,isFetchingNextPage:a,isLoading:l,fetchNextPage:()=>{t().catch(e=>(0,w.vV)("soft-deleted-conversations-load-more",e))}});return{conversations:r,isLoading:l,error:n,loadMoreRef:o,historyContainerRef:c,refetch:i}},z=()=>{let{t:e}=(0,p.Bd)(),t=(0,g.SX)(),s=(0,b.K)(),l=(0,y._)(),{routeToConversation:n}=(0,v.o)(),i=(0,N.w1)(C.A("fetchGetConversation")),{mutate:r,isPending:o}=(0,I.n_)({mutationFn:async e=>{l("restore-conversation",void 0,{location:"restore-conversation:mutate",conversationId:e}),await k.chatApi.chatRestoreSoftDeletedConversation({body:{conversationId:e}})},onError:t=>{s("restore-conversation",t,e("deleted-conversations.restore.error","Failed to restore conversation")),(0,w.vV)("restore-conversation",t)},onSuccess:(s,r)=>{t.invalidateQueries({queryKey:[E]}),i(r).then(()=>{S.oR.success(e("deleted-conversations.restore.success","Successfully restored conversation"),{action:(0,a.jsx)(m.$n,{variant:"filledSecondary",size:"sm",onClick:()=>{n(r),l("view-restored-conversation",void 0,{location:"restore-conversation:onSuccess",conversationId:r})},children:e("deleted-conversations.restore.view","View")})})}).catch(e=>{(0,w.vV)("restore-conversation",e)})}});return{restoreConversation:r,isPending:o}},P=()=>{let{t:e}=(0,p.Bd)(),t=(0,g.SX)(),s=(0,b.K)(),a=(0,y._)(),l=(0,N.w1)(C.A("fetchForceDeleteConversation")),{mutate:n,isPending:i}=(0,I.n_)({mutationFn:async e=>{await l(e),a("force-delete-conversation",void 0,{location:"force-delete-conversation:mutate",conversationId:e})},onError:t=>{s("force-delete-conversation",t,e("deleted-conversations.force-delete.error","Failed to force delete conversation")),(0,w.vV)("force-delete-conversation",t)},onSuccess:()=>{t.invalidateQueries({queryKey:[E]})}});return{forceDeleteConversation:n,isPending:i}},A=e=>{var t;let{conversation:s,restore:l,forceDelete:n}=e,{t:i}=(0,p.Bd)("base");return(0,a.jsxs)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"flex justify-between items-center p-2 border rounded-xl bg-card",children:[(0,a.jsx)("span",{className:"truncate",children:null!=(t=s.title)?t:s.conversationId}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.$n,{onClick:()=>s.conversationId&&l(s.conversationId),variant:"outline",children:i("deleted-conversations.restore","Restore")}),(0,a.jsx)(m.$n,{onClick:()=>s.conversationId&&n(s.conversationId),variant:"destructive",children:i("deleted-conversations.force-delete","Force Delete")})]})]})};function M(){let{t:e}=(0,p.Bd)("base"),{user:t}=(0,u.useSession)(),{conversations:s,isLoading:l,error:n,refetch:g,loadMoreRef:v,historyContainerRef:j}=_(),{restoreConversation:y}=z(),{forceDeleteConversation:b}=P();return t?(0,a.jsxs)("main",{className:(0,h.cn)("h-dvh w-full relative flex flex-col items-center"),children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)(r.CommandMenu,{}),(0,a.jsxs)("div",{className:"max-w-[50rem] px-5 pt-16 pb-8 @sm:pt-18 mx-auto w-full flex flex-col h-full",ref:j,children:[(0,a.jsx)("h1",{className:"text-2xl flex gap-2 items-center",children:e("deleted-conversations.title","Deleted Conversations")}),(0,a.jsx)("div",{className:"flex flex-col w-full items-start text-xs text-muted-foreground pb-4",children:e("deleted-conversations.description","Conversations marked for deletion will be permanently deleted after 30 days.")}),(0,a.jsx)(c.D,{children:(0,a.jsxs)(x.N,{children:[null==s?void 0:s.map(e=>(0,a.jsx)(A,{conversation:e,restore:y,forceDelete:b},e.conversationId)),(null==s?void 0:s.length)===0&&!l&&(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center",children:e("deleted-conversations.no-conversations-found","No deleted conversations found")})},"no-conversations-found"),l&&(0,a.jsx)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px]",children:(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(d.krw,{className:"animate-spin"})})})},"deleted-conversations-loading"),n&&(0,a.jsxs)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px] flex-col gap-4",children:[(0,a.jsx)("div",{className:"text-center",children:e("deleted-conversations.error.description","There was an issue loading your deleted conversations")}),(0,a.jsx)(m.$n,{variant:"filledSecondary",onClick:()=>g(),children:e("Retry","Retry")})]},"deleted-conversations-error"),(0,a.jsx)("div",{ref:v})]})})]})]}):(0,a.jsx)("main",{className:(0,h.cn)("w-screen h-dvh relative"),children:(0,a.jsx)(o.J,{title:e("deleted-conversations.error.title","Error"),description:e("deleted-conversations.error.anonymous-user","You must be logged in to access this page"),cta:e("deleted-conversation-page.cta","Return home")})})}var D=s(38245),R=s(10953),T=s(17035),B=s(24429),L=s(84499),F=s(88382);let O=()=>{let{t:e}=(0,p.Bd)(),{isSuperGrokUser:t,isSuperGrokProUser:s,isEnterpriseUser:l}=(0,B.Q2)(),n=(0,B.hd)(),{push:i}=(0,L.wK)();return(0,a.jsxs)("div",{className:(0,h.cn)("fixed z-50 bg-background grid inset-0 place-items-center gap-4 duration-200 w-[100vw] min-h-[100vh] overflow-x-hidden","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 p-6"),children:[(0,a.jsx)("meta",{name:"description",content:"Unlock advanced AI capabilities with SuperGrok. With SuperGrok you get signifcantly more access to our premium models and early access to new features."})," ",(0,a.jsx)("meta",{name:"keywords",content:"Grok, Supergrok, Subscription, xAI, AI, Models, Context, Images, Generation, Tools, Features"}),(0,a.jsx)(m.$n,{asChild:!0,variant:"secondary",size:"pill",className:"absolute top-8 z-10 h-10 pr-5",children:(0,a.jsxs)(L.N_,{route:{page:"main"},children:[(0,a.jsx)(d.JGc,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"-mt-px",children:e("Go to","Go to")}),(0,a.jsx)("div",{className:"-mx-0.5 -mt-px",children:(0,a.jsx)(R.r1,{className:"h-3"})})]})}),(0,a.jsx)(T.W,{isSubscribed:t||s||l||!1,isSuccessful:n,onSuccess:()=>i({page:"main"})})]})};var G=s(39890),U=s(32171),q=s.n(U);let W=e=>{let{shareLink:t,conversation:s}=e,{t:l}=(0,p.Bd)("base"),{deleteShareLink:n,isPending:i}=(0,G.Y)();return(0,a.jsxs)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"flex justify-between items-center py-2 px-4 border rounded-xl bg-card gap-2",children:[(0,a.jsx)(q(),{href:"/share/".concat(t.publicId),className:"group cursor-pointer relative text-sm flex-1 min-w-0",children:(0,a.jsx)("span",{className:"flex flex-row items-center gap-1",children:(0,a.jsx)("span",{className:"line-clamp-1 font-semibold",children:s?s.title:l("share-links.unknown-conversation","Untitled")})})}),(0,a.jsx)(m.$n,{onClick:()=>t.shareLinkId&&n(t.shareLinkId),variant:"outline",rounded:!0,disabled:i,children:l("share-links.remove","Unshare")})]})};function K(){let{t:e}=(0,p.Bd)("base"),{user:t}=(0,u.useSession)(),{shareLinks:s,isLoading:l,error:n,refetch:g,loadMoreRef:v,historyContainerRef:j}=(0,G.m)();return t?(0,a.jsxs)("main",{className:(0,h.cn)("h-dvh w-full relative flex flex-col items-center"),children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)(r.CommandMenu,{}),(0,a.jsxs)("div",{className:"max-w-[50rem] px-5 pt-16 pb-8 @sm:pt-18 mx-auto w-full flex flex-col h-full",ref:j,children:[(0,a.jsx)("div",{className:"flex justify-between align-center min-h-[42px] w-full",children:(0,a.jsx)("h1",{className:"text-2xl flex gap-2 items-center font-semibold",children:e("share-links.title","Shared Conversations")})}),(0,a.jsx)("div",{className:"flex flex-col w-full items-start text-muted-foreground",children:e("share-links.description","Share links can be viewed by anyone with the link.")}),(0,a.jsxs)(c.D,{className:"gap-2 pt-6",children:[(0,a.jsxs)(x.N,{children:[null==s?void 0:s.map(e=>{var t;return(0,a.jsx)(W,{shareLink:e,conversation:null==e||null==(t=e.sharedLink)?void 0:t.conversation},e.shareLinkId)}),(null==s?void 0:s.length)===0&&!l&&(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center h-40 flex items-center justify-center w-full py-8 border rounded-3xl flex-col gap-4 p-4 sm:p-6 select-none",children:(0,a.jsx)("div",{className:"font-semibold",children:e("share-links.no-share-links-found","Nothing shared yet")})})},"no-share-links-found"),l&&(0,a.jsx)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px]",children:(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(d.krw,{className:"animate-spin"})})})},"share-links-loading"),n&&(0,a.jsxs)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px] flex-col gap-4",children:[(0,a.jsx)("div",{className:"text-center",children:e("share-links.error.description","Can't load shared conversations")}),(0,a.jsx)(m.$n,{variant:"filledSecondary",onClick:()=>g(),children:e("Retry","Try Again")})]},"share-links-error")]}),(0,a.jsx)("div",{ref:v})]})]})]}):(0,a.jsx)("main",{className:(0,h.cn)("w-screen h-dvh relative"),children:(0,a.jsx)(o.J,{title:e("deleted-conversations.error.title","Sign In Required"),description:e("deleted-conversations.error.anonymous-user","Sign in to view your shared conversations"),cta:e("share-links-page-error.cta","Return home")})})}var V=s(42557),$=s(35692),H=s(43086),Y=s(46748),Q=s(75500),X=s(41320),J=s(2280),Z=s(27636),ee=s(73304),et=s(35589),es=s(16506),ea=s(39116);function el(e){let{children:t,numOfLines:s,...l}=e;return(0,a.jsx)("p",{style:{display:"-webkit-box",WebkitLineClamp:s,WebkitBoxOrient:"vertical",overflow:"hidden"},...l,children:t})}var en=s(18921);function ei(e){let{task:t,onClick:s}=e,l=(0,y._)(),{getScheduleLabel:n}=(0,Z.Ay)(),i=(0,ee.d)(C.A("setCreateDialogIsOpen")),r=(0,ee.d)(C.A("setTaskToEdit")),o=(0,F.useCallback)(()=>{l("task_preset_clicked",void 0,{location:"task-presets:handleClick"}),i(!0),r(t),null==s||s()},[s,i,r,l,t]),c=(0,en.O$)(t),d=(0,F.useMemo)(()=>{var e,t;if(c)return n(c.cadence,c.timeOfDay,c.ianaTimezone,c.localDayOfWeek,c.localDayOfMonth,null!=(t=null==(e=c.localDayOfYear)?void 0:e.toISODate())?t:void 0)},[n,c]),{resolvedTheme:u}=(0,es.D)();return(0,a.jsxs)("div",{className:(0,h.cn)("group h-40 grow w-full rounded-2xl pt-4 px-4 flex flex-col items-center gap-3 border cursor-pointer bg-surface-l1 hover:bg-surface-l2",{"hover:bg-surface-base":"light"===u}),onClick:o,children:[(0,a.jsx)("h1",{className:"font-semibold text-sm",children:t.cta||t.name}),(0,a.jsxs)("div",{className:"grow w-full rounded-t-xl border bg-surface-l2 overflow-hidden p-3 group-hover:bg-surface-l3",children:[(0,a.jsx)(el,{className:"text-xs text-fg-secondary font-normal mb-2",numOfLines:2,children:t.prompt}),(0,a.jsx)("p",{className:"text-xs font-normal",children:d})]})]})}var er=s(62227);function eo(){let e=(0,ea.useRouter)(),{t}=(0,p.Bd)("base"),s=(0,y._)(),l=new URLSearchParams({return_to:"".concat(location.pathname).concat(location.search).concat(location.hash)}).toString(),n=(0,F.useCallback)(()=>{s("sign_in_redirect",void 0,{location:"tasks-anon-page"}),e.push("/sign-in".concat(l?"?".concat(l):""))},[s,e,l]),i=(0,F.useCallback)(()=>{s("sign_up_redirect",void 0,{location:"tasks-anon-page"}),e.push("/sign-up".concat(l?"?".concat(l):""))},[s,e,l]);return(0,a.jsxs)("main",{className:"h-full flex flex-col justify-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4 text-center",children:"Unlock Automation with Grok Tasks"}),(0,a.jsxs)("p",{className:"mb-6 text-lg",children:["Discover ",(0,a.jsx)("strong",{children:"Tasks"})," – your automation tool for scheduling recurring operations with Grok."]}),(0,a.jsx)(ec,{}),(0,a.jsxs)("p",{className:"font-semibold text-center mb-4",children:["Ready to get started? ",(0,a.jsx)("strong",{children:"Log in"})," to your Grok account now and create your first task today! If you don't have an account, signing up is quick and easy."]}),(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,a.jsxs)(m.$n,{size:"pill",variant:"primary",className:"h-8 px-3 text-sm",onClick:i,children:[(0,a.jsx)(d.KJW,{size:16,strokeWidth:2}),(0,a.jsx)("div",{children:t("Sign up","Sign up")})]}),(0,a.jsx)(m.$n,{size:"pill",variant:"none",className:(0,h.cn)("hidden @sm:flex","h-8 px-3 text-sm text-primary bg-transparent ring-1 ring-inset ring-toggle-border","hover:bg-button-secondary-hover hover:border-text-secondary"),onClick:n,children:(0,a.jsx)("div",{children:t("Sign in","Sign in")})})]})]})}function ec(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"What You Can Do with Tasks"}),(0,a.jsxs)("ul",{className:"list-disc pl-6 mb-6 space-y-2",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Create and Schedule"}),": Set up a new task in seconds. Define cron-like schedules and provide prompts to guide Grok's actions."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Automated Operations"}),": Grok's LLM, with full internet access, executes your tasks on schedule – processing data, fetching information, and performing actions like sending emails or push notifications."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Customize and Manage"}),": Tailor tasks to your needs, monitor executions, and edit schedules or prompts as required. Keep your automations organized and efficient."]})]}),(0,a.jsx)("p",{className:"mb-6",children:"Tasks are designed to make your Grok experience more automated, productive, and hands-off. Whether you're monitoring updates, sending reminders, or integrating workflows, Tasks handle it seamlessly."})]})}function ed(){return(0,V.wV)().user?(0,a.jsx)(eu,{}):(0,a.jsxs)("div",{className:"h-dvh w-full relative selection:bg-highlight",children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)("div",{className:"max-w-[50rem] px-2 pt-16 @sm:pt-18 mx-auto w-full flex-col h-full relative items-center",children:(0,a.jsx)(eo,{})}),(0,a.jsx)(r.CommandMenu,{})]})}function eu(){let e=(0,Q.h)(),{t}=(0,p.Bd)("tasks"),s=(0,y._)(),l=(0,X.Di)(),n=(0,ee.d)(C.A("setSelectedTaskIdForSidePanel")),o=(0,ee.d)(C.A("selectedTaskIdForSidePanel")),c=(0,ee.d)(C.A("setTaskPageTabMode")),u=(0,ee.d)(C.A("setCreateDialogIsOpen")),{route:f,replace:x}=(0,L.wK)(),g="tasks"===f.page&&f.taskId||null,v="tasks"===f.page&&f.tab||null;(0,F.useEffect)(()=>{g&&n(g),v&&c("active"===v?en.RJ.ACTIVE:en.RJ.ARCHIVED),x({page:"tasks",taskId:null,tab:null})},[g,v,n,c,x]);let[j,b]=(0,F.useState)({}),w=(0,ee.d)(C.A("taskPageTabMode")),{taskPresets:k}=(0,Z.hB)(),N=(0,ee.d)(C.A("userActiveTasks")),I=(0,ee.d)(C.A("userInactiveTasks")),S=(0,ee.d)(C.A("initialized")),E=(0,F.useCallback)((e,t)=>{b(s=>({...s,[e]:t}))},[b]);(0,F.useEffect)(()=>{let e=t("tasks-page-document-title","Tasks");document.title="".concat(e," - Grok")},[t]),(0,Y.r)(t("tasks-page-document-title","Tasks")),(0,F.useEffect)(()=>{s("opened_tasks_page",void 0,{location:"tasks-page:useEffect"})},[s]);let _=!!(0,V.wV)().user,z=e.ENABLE_GROK_TASKS&&_,P=(0,F.useRef)(null),[A,M]=(0,F.useState)(!0),[D,R]=(0,F.useState)(!1);(0,F.useEffect)(()=>{let e=()=>{if(P.current){let{scrollTop:e,scrollHeight:t,clientHeight:s}=P.current;0===e?M(!0):M(!1),e+s>=t-5?R(!0):R(!1)}},t=P.current;return t&&t.addEventListener("scroll",e),()=>{t&&t.removeEventListener("scroll",e)}},[P]);let T=(0,F.useCallback)(()=>{s("clicked_add_new_task",void 0,{location:"tasks-page"}),u(!0)},[u,s]),B=(0,F.useMemo)(()=>{if(w===en.RJ.ACTIVE){var e;return e=N.filter(e=>{var t;return null==(t=e.task)?void 0:t.isActive}),e.sort((e,t)=>{var s,a,l,n;let i=j[null!=(l=null==(s=e.task)?void 0:s.taskId)?l:""],r=j[null!=(n=null==(a=t.task)?void 0:a.taskId)?n:""];return i&&r?et.c9.fromISO(r).diff(et.c9.fromISO(i)).toMillis():i?-1:1*!!r})}return w===en.RJ.ARCHIVED?I.filter(e=>{var t;return!(null==(t=e.task)?void 0:t.isActive)}):[]},[w,N,j,I]),O=(0,F.useMemo)(()=>k.sort(()=>Math.random()-.5).slice(0,2),[k]);if(!z)return(0,ea.redirect)("/");let G=w===en.RJ.ACTIVE&&B.length<=3;return(0,a.jsxs)("div",{className:(0,h.cn)("h-dvh w-full relative selection:bg-highlight",{"overflow-y-auto":l}),children:[!o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)(r.CommandMenu,{})]}),(0,a.jsxs)("div",{className:(0,h.cn)("max-w-[50rem] px-5 pt-16 @sm:pt-18 mx-auto w-full flex flex-col h-full items-center pb-4","transition-all duration-300 spring"),style:D?{}:{maskImage:J.pA,WebkitMaskImage:J.pA},children:[(0,a.jsx)("div",{className:"flex justify-between align-center min-h-[42px] w-full",children:(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 group",children:(0,a.jsx)("h1",{className:"text-2xl flex gap-2 items-center font-semibold",children:t("tasks.page-title","Tasks")})}),(0,a.jsxs)(m.$n,{variant:"outline",onClick:T,size:"md",children:[(0,a.jsx)(d.FWt,{size:16}),(0,a.jsx)("span",{children:t("tasks.create","Add new")})]})]})}),S?(0,a.jsxs)("div",{className:"pt-6 w-full overflow-auto relative no-scrollbar",style:A?{}:{maskImage:J.l1,WebkitMaskImage:J.l1},ref:P,children:[0===B.length&&w===en.RJ.ACTIVE&&(0,a.jsx)(ef,{onClick:T}),0===B.length&&w===en.RJ.ARCHIVED&&(0,a.jsx)(ex,{}),(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col gap-4 pb-4 w-full "),children:[B.length>0&&B.filter(e=>!!e.task).map(e=>{if(e.task){var t;return(0,a.jsx)(em,{task:e,updateTaskIdIsUnread:E},null==(t=e.task)?void 0:t.taskId)}}),G?(0,a.jsx)("div",{className:(0,h.cn)("pt-4 flex items-center pb-20",{"flex-col pb-8":l}),children:(0,a.jsx)("div",{className:(0,h.cn)("flex w-full gap-4",{"flex-col":l}),children:O.map((e,t)=>(0,a.jsx)(ei,{task:e},t))})}):null]})]}):(0,a.jsx)("div",{className:"grow shrink self-stretch flex items-center justify-center",children:(0,a.jsx)(H.y,{size:"sm"})})]})]})}function em(e){var t,s,l,n,i,r,o,c,u;let{task:f,updateTaskIdIsUnread:g}=e,{t:v}=(0,p.Bd)("tasks"),j=(0,y._)(),{resolvedTheme:b}=(0,es.D)(),w=(0,X.Di)(),N=(0,ee.d)(C.A("selectedTaskIdForSidePanel")),S=(0,ee.d)(C.A("setSelectedTaskIdForSidePanel")),E=N===(null==(t=f.task)?void 0:t.taskId),[_,z]=(0,F.useState)(!1),P=(0,F.useCallback)(()=>{z(!0)},[z]),A=(0,F.useCallback)(()=>{z(!1)},[z]),M=(0,Q.h)(),D=(0,F.useCallback)(()=>{var e;if(j("clicked_tasks_card",void 0,{location:"tasks-page:handleClick"}),E)return S(void 0);S(null==(e=f.task)?void 0:e.taskId)},[E,S,j,null==(s=f.task)?void 0:s.taskId]),R=null==(l=f.schedules)?void 0:l.at(0),{data:T}=(0,I.IT)({queryKey:["latest-task-result",null==(n=f.task)?void 0:n.taskId],queryFn:async()=>{var e;if(!(null==(e=f.task)?void 0:e.taskId))throw Error("TaskId is required");return k.Cs.grokTasksGetTaskResults({taskId:f.task.taskId,limit:1})},enabled:M.ENABLE_GROK_TASKS&&!!(null==(i=f.task)?void 0:i.taskId),staleTime:0,refetchOnMount:"always"}),B=null==T||null==(r=T.results)?void 0:r.at(0),L=!(null==(o=f.task)?void 0:o.isActive),O=!!(B&&!L),G=null==B?void 0:B.createTime;(0,F.useEffect)(()=>{var e,t;g(null!=(t=null==(e=f.task)?void 0:e.taskId)?t:"",G)},[g,null==(c=f.task)?void 0:c.taskId,G]);let U=!!((null==(u=f.task)?void 0:u.isActive)&&(null==R?void 0:R.isEnabled)),q=(0,ee.d)(C.A("setTaskToEdit")),{pauseOrUnpauseTaskSchedule:W}=(0,Z.ek)(),K=(0,F.useCallback)(e=>{e.stopPropagation(),j("edit_task_clicked",void 0,{location:"tasks-side-panel:handleEditClick"}),q((0,en.Yc)(f))},[q,f,j]),V=(0,F.useCallback)(e=>{e.stopPropagation(),j("pause_task_clicked",void 0,{location:"tasks-side-panel:handlePauseClick"}),W({enabled:!1,scheduleId:null==R?void 0:R.scheduleId})},[W,R,j]),$=(0,F.useCallback)(e=>{e.stopPropagation(),j("resume_task_clicked",void 0,{location:"tasks-side-panel:handleUnpauseClick"}),W({enabled:!0,scheduleId:null==R?void 0:R.scheduleId})},[W,R,j]);return f.task&&R?(0,a.jsxs)("div",{className:(0,h.cn)("w-full flex flex-col py-0 rounded-3xl border bg-surface-l1 hover:bg-surface-l2 cursor-pointer  relative",{"hover:bg-surface-base":"light"===b},{"bg-surface-l2 hover:bg-surface-l3":E},{"py-1":!(O&&B)},{"bg-surface-inset hover:bg-button-ghost-hover":E&&"light"===b}),onMouseEnter:P,onMouseLeave:A,onClick:D,children:[(0,a.jsxs)("div",{className:"flex flex-col px-5 py-3 gap-0.5",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)("h1",{className:(0,h.cn)("text-sm font-semibold line-clamp-1",{"text-xs":w}),children:f.task.name&&f.task.name.length>0?f.task.name:"Task"}),!w&&(0,a.jsx)("div",{children:_?(0,a.jsxs)("div",{className:"flex flow-row m-0 p-0 h-4 -mt-4 -mr-2",children:[(0,a.jsx)(m.$n,{className:"m-0 p-0",variant:"ghost",size:"iconSm",onClick:K,"aria-label":v("tasks-result.edit-label","Edit"),children:(0,a.jsx)(d.gHP,{size:12})}),U||L?(0,a.jsx)(m.$n,{variant:"ghost",size:"iconSm",onClick:V,"aria-label":v("tasks-result.pause-label","Pause"),children:(0,a.jsx)(d.vRz,{size:14})}):(0,a.jsx)(m.$n,{variant:"ghost",size:"iconSm",onClick:$,"aria-label":v("tasks-result.resume-label","Resume"),children:(0,a.jsx)(d.jGG,{size:14})})]}):(0,a.jsx)(er.N,{task:R,isScheduled:U,iconPosition:"right"})})]}),w&&(0,a.jsx)(er.N,{task:R,isScheduled:U})]}),(0,a.jsx)(x.N,{children:!w&&O&&B&&(0,a.jsx)("div",{className:"border-t-[0.5px]",children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(eh,{taskResult:B})})})})]}):null}function eh(e){var t;let{taskResult:s}=e,{t:l}=(0,p.Bd)("tasks"),n=(0,X.Di)(),i=(0,F.useMemo)(()=>{var e;if(!s.createTime)return null;let t=et.c9.fromISO(s.createTime),a=et.c9.now();return null!=(e=t.toRelative({base:a}))?e:l("just-now","Just now")},[l,s.createTime]);return(0,a.jsxs)("div",{className:"flex-nowrap px-5 pb-3 pt-2 flex items-center justify-between w-full text-sm h-full gap-0.5",children:[(0,a.jsxs)("div",{className:(0,h.cn)("flex items-center gap-1.5",{"justify-between w-full":n}),children:[!n&&(0,a.jsx)(d.oFn,{size:14,className:"text-fg-secondary "}),(0,a.jsx)("p",{className:"text-fg-secondary line-clamp-1",children:null!=(t=s.title)?t:l("new-task-result-label","New task result")}),n&&(0,a.jsx)($.x,{variant:"sm"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-fg-secondary",children:[(0,a.jsx)("p",{className:(0,h.cn)("line-clamp-1",{"text-xs":n}),children:i}),!s.isRead&&(0,a.jsx)("div",{className:"w-[14px] h-full flex items-center justify-center",children:!n&&(0,a.jsx)($.x,{variant:"sm"})})]})]})}let ef=e=>{let{onClick:t}=e,{t:s}=(0,p.Bd)("tasks");return(0,a.jsxs)("div",{className:"w-full py-8 border rounded-xl flex flex-col items-center gap-4 px-4",children:[(0,a.jsx)(m.$n,{size:"iconMd",variant:"secondary",className:"rounded-full",onClick:t,"aria-label":s("tasks.create","Add new"),children:(0,a.jsx)(d.shx,{size:20})}),(0,a.jsxs)("div",{className:"flex flex-col items-center w-full gap-2 text-lg font-semibold",children:[(0,a.jsx)("h1",{children:s("no-tasks-banner.title","Get started by adding a task")}),(0,a.jsx)("p",{className:"text-xs font-normal text-fg-secondary text-center leading-1",children:s("no-tasks-banner.subtitle","Schedule a task to automate actions and get reminders when they complete.")})]})]})},ex=()=>{let{t:e}=(0,p.Bd)("tasks");return(0,a.jsxs)("div",{className:"w-full py-8 border rounded-xl flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center rounded-full bg-surface-l1 p-4",children:(0,a.jsx)(d.Tde,{size:20})}),(0,a.jsxs)("div",{className:"flex flex-col items-center w-full gap-2 text-lg font-semibold",children:[(0,a.jsx)("h1",{children:e("no-archived-tasks-banner.title","No archived tasks")}),(0,a.jsx)("p",{className:"text-xs font-normal text-fg-secondary text-center leading-1",children:e("no-archived=tasks-banner.subtitle","Archived tasks will show up here")})]})]})};var ep=s(5790),eg=s(32507),ev=s(69648),ej=s(40873);let ey=e=>{let{handlePersonalityClick:t}=e;return{"what-is-grok":{anchor:"what-is-grok",question:"What is Grok?",answer:(0,a.jsx)("p",{children:"Grok is a conversational generative AI powered by xAI's state-of-the-art Large Language Models. It's built to assist with a wide range of tasks while being helpful, entertaining, and truthful. Grok aims to answer questions about the universe, help with deep work, and provide real-time insights, all with a touch of humor and personality."})},"key-features":{anchor:"key-features",question:"What are Grok's key features?",answer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Grok offers a variety of powerful features, including:"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Natural Language Processing and Question Answering"}),": Handles text and voice queries for accurate, context-aware responses."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Real-Time Search and Information Retrieval"}),": Searches public X posts (formerly Twitter) and the web in real-time for up-to-date information."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Creative Writing and Content Generation"}),": Assists with writing stories, articles, or other creative content."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Image Generation and Editing"}),": Creates and edits images based on your descriptions."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Image and Video Understanding"}),": Analyzes uploaded images or videos to provide insights or descriptions."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Coding Assistance"}),": Helps write, debug, and explain code."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Document Analysis"}),": Upload documents for summarization, analysis, or extraction of key information."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Personas and Customization"}),": Choose fun personas (e.g., witty, unhinged, or role-playing like a wizard) to customize Grok's tone and style."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Native Tool Use"}),": Integrates tools like code interpreters and internet access to query missing context and adjust responses dynamically."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Multilingual Capabilities"}),": Supports multiple languages with high precision."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Private Chat Mode"}),": Activate for conversations that aren't saved long-term, ensuring privacy for sensitive discussions."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Conversation History"}),": View and manage past chats for continuity."]})]}),(0,a.jsx)("p",{children:'Grok stands out for its real-time capabilities, reasoning agents, and focus on being a "trusted assistant for deep work."'})]})},models:{anchor:"models",question:"What models power Grok, and what are their features?",answer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Grok is powered by advanced models from xAI, each with unique strengths:"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Grok 4"}),": The most intelligent model in the world, featuring native tool use, real-time search integration, and superior reasoning. Available to SuperGrok and Premium+ subscribers."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Grok 4 Heavy"}),": The most powerful version of Grok 4, offering enhanced performance and higher rate limits. Accessible through the SuperGrok Heavy subscription tier."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Grok 3"}),": Fast model that combines reasoning with extensive pretraining knowledge. It includes code interpreters, internet access, and the ability to dynamically adjust approaches for complex tasks."]})]})]})},"creative-tasks":{anchor:"creative-tasks",question:"Can Grok handle creative or specialized tasks?",answer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Yes! Grok excels at:"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)(L.N_,{route:{page:"files"},children:"Generating rich documents, stories, or reports"}),"."]}),(0,a.jsx)("li",{children:"Writing and debugging code in various languages."}),(0,a.jsxs)("li",{children:[(0,a.jsx)(L.N_,{route:{page:"files",emptyView:"image"},children:'Creating/editing images (e.g., via prompts like "generate a cosmic landscape")'}),"."]}),(0,a.jsx)("li",{children:"Analyzing images for descriptions, insights, or edits."}),(0,a.jsx)("li",{children:'Role-playing or adopting personas for fun interactions (e.g., "Respond as a pirate captain").'})]})]})},"real-time-search":{anchor:"real-time-search",question:"Does Grok have real-time search and how does it work?",answer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Yes, Grok has the most advanced real-time search capabilities. It can:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Search public X posts for the latest discussions."}),(0,a.jsx)("li",{children:"Perform web searches for current information."}),(0,a.jsx)("li",{children:"Integrate results into responses for up-to-date, accurate answers."})]}),(0,a.jsx)("p",{children:"This is powered by models like Grok 4, ensuring responses are timely and relevant."})]})},"customize-responses":{anchor:"customize-responses",question:"Can I customize Grok's responses?",answer:(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("p",{children:["Absolutely. You can choose one of predefined styles or write your own instructions in"," ",(0,a.jsx)("a",{onClick:t,className:"cursor-pointer",children:"settings"}),"."]})})},"mistakes-inaccuracies":{anchor:"mistakes-inaccuracies",question:"How does Grok handle mistakes or inaccuracies?",answer:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("p",{children:'Like all AIs, Grok may occasionally "hallucinate" or provide incorrect info based on its training data. It encourages users to verify facts, and you can provide feedback to help improve it. Grok\'s design prioritizes truthfulness to minimize this.'})})},"share-links":{anchor:"share-links",question:"How do share links work?",answer:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-yellow-100/10 dark:bg-yellow-900/10 border border-yellow-200/50 dark:border-yellow-800/50 rounded-lg px-4 py-2 mb-4 flex flex-row items-center gap-3",children:[(0,a.jsx)(d.hcu,{className:"text-yellow-200 dark:text-yellow-100 size-5"}),(0,a.jsx)("p",{className:"font-semibold",children:"Share links can be viewed by anyone with the link."})]}),(0,a.jsx)("h4",{children:"Can I share my Grok conversations?"}),(0,a.jsx)("p",{children:"Yes, you control what you choose to share. You can share your Grok conversations with others:"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:'On grok.com by clicking "Share" in the top right corner of your browser or the share icon below your conversation to create and copy a share link'}),(0,a.jsx)("li",{children:"On the Grok Apps by tapping the share icon under your conversation to create a share link"})]}),(0,a.jsx)("p",{children:"From there, you also control where you share your Grok conversation."}),(0,a.jsx)("h4",{children:"What happens when you share"}),(0,a.jsx)("p",{children:"When you create a share link, anyone with the link can view your entire conversation—including messages, uploads, and generated content. No Grok account required."}),(0,a.jsx)("p",{children:"Note: Any share link you generate will be accessible to anyone you choose to share the link with. For example, if you share the link publicly on a social media platform, it may be subject to indexing by a search engine (e.g., Google) just like any other publicly shared content."}),(0,a.jsx)("h4",{children:"Can I revoke access to my shared Grok conversations?"}),(0,a.jsx)("p",{children:"Yes, you control what you share and how long it is shared. You can revoke access to any or all of your Grok conversation share links by:"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:["Logging into grok.com, navigating to"," ",(0,a.jsx)(L.N_,{route:{page:"share-links"},children:"grok.com/share-links"}),', and clicking "Remove" next to the share link you no longer wish to share']}),(0,a.jsx)("li",{children:"Using the menu in your chat"}),(0,a.jsx)("li",{children:"Clicking Unshare on the shared conversation page"})]}),(0,a.jsx)("h4",{children:"Before you share"}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Review your entire conversation"}),(0,a.jsx)("li",{children:"Remove any personal or sensitive information"}),(0,a.jsx)("li",{children:"Remember that recipients can save or download content"})]}),(0,a.jsx)("p",{className:"mt-4",children:"Tip: Use Private Chat Mode for sensitive conversations that shouldn't be shared."})]})}}},eb=e=>{let{anchor:t,children:s}=e;return(0,a.jsx)(L.N_,{route:{page:"faq",anchor:t},children:(0,a.jsx)(m.$n,{variant:"ghost",size:"lg","aria-label":"View answer",className:"my-1",asChild:!0,children:(0,a.jsxs)("div",{className:"flex justify-between w-full items-center",id:t,children:[(0,a.jsx)("span",{className:"text-lg overflow-hidden text-ellipsis",children:s}),(0,a.jsx)(d.vKP,{className:"w-4 h-4"})]})})})},ew=(0,F.memo)(function(){var e,t,s;let l=(0,eg.XO)(e=>e.route),n="faq"===l.page?l:(0,ej.Z)("only for /faq"),r=(0,ep.iV)(e=>e.setTab),o=(0,ep.iV)(e=>e.toggleOpen),c=(0,F.useCallback)(e=>{e.preventDefault(),o(),r("personality")},[o,r]),u=(0,F.useMemo)(()=>ey({handlePersonalityClick:c}),[c]);return(0,a.jsxs)("div",{className:"h-dvh flex-1 overflow-auto relative",children:[(0,a.jsx)("div",{className:"sm:hidden mt-2",children:(0,a.jsx)(i.n9,{shared:!1})}),(0,a.jsx)("div",{className:"prose pb-8 px-4 mt-8 mx-auto pt-2 sm:pt-8",children:n.anchor&&u[n.anchor]?(0,a.jsxs)("section",{children:[(0,a.jsx)("nav",{"aria-label":"Breadcrumb",children:(0,a.jsxs)("ol",{className:"flex items-center m-0 p-0 gap-4",children:[(0,a.jsx)("li",{className:"flex items-center list-none",children:(0,a.jsx)(L.N_,{route:{page:"faq",anchor:null},children:(0,a.jsx)(m.$n,{variant:"link","aria-label":"FAQ",className:"text-muted-foreground p-0",asChild:!0,children:(0,a.jsx)("span",{children:"FAQ"})})})}),(0,a.jsx)("span",{className:"text-muted-foreground",children:(0,a.jsx)(d.vKP,{className:"w-4 h-4"})}),(0,a.jsx)("li",{className:"list-none m-0 p-0",children:(0,a.jsx)("span",{className:"text-muted-foreground",id:n.anchor,children:null==(e=u[n.anchor])?void 0:e.question})})]})}),(0,a.jsxs)("header",{className:"flex flex-col my-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:null==(t=u[n.anchor])?void 0:t.question}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Updated on Aug 13, 2025"})]}),(0,a.jsx)(ev.w,{className:"my-8"}),(0,a.jsx)("div",{children:null==(s=u[n.anchor])?void 0:s.answer})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{children:[(0,a.jsx)(L.N_,{route:{page:"faq",anchor:null},children:(0,a.jsx)("h1",{children:"Grok Web FAQ"})}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground mb-8",children:"Updated on Aug 13, 2025"})]}),(0,a.jsxs)("main",{children:[(0,a.jsxs)("p",{children:["Welcome to the Grok Web FAQ page! Grok is designed to be a helpful, witty, and maximally truthful assistant, inspired by the Hitchhiker's Guide to the Galaxy and JARVIS from Iron Man. This FAQ focuses on Grok's Web features, capabilities, and how to make the most of them. For legal terms, privacy, or account issues, visit"," ",(0,a.jsx)("a",{href:"https://x.ai/legal",target:"_blank",rel:"noreferrer noopener",children:"x.ai/legal"}),"."]}),(0,a.jsxs)("p",{children:["If your question isn't covered here, feel free to"," ",(0,a.jsx)(L.N_,{route:{page:"main"},children:"ask Grok directly"}),"."]}),(0,a.jsx)(ev.w,{className:"my-8"}),Object.values(u).map((e,t)=>{let{anchor:s,question:l}=e;return(0,a.jsx)(eb,{anchor:s,children:l},t)}),(0,a.jsx)(ev.w,{className:"my-8"}),(0,a.jsxs)("p",{children:["If you have more questions,"," ",(0,a.jsx)(L.N_,{route:{page:"main"},children:"chat with Grok now! \uD83D\uDE80"})]})]})]})})]})});var ek=s(51375),eN=s(37469),eI=s(65761),eC=s(41405),eS=s(87891);let eE=(0,F.memo)(e=>{let{asset:t,isFileSelected:s}=e,{t:l}=(0,p.Bd)(),i=(0,y._)(),r=(0,n.aP)(C.A("setSidePanelContent")),[o,c]=(0,F.useState)(!1),u=(0,eS.R)(e=>e.deleteAsset),x=(0,F.useCallback)(()=>{if(s)return void r(void 0);r({type:"asset",data:(0,eN.B)(t),hideEdit:!0})},[t,s,r]),g=(0,F.useCallback)(e=>{var s,a;e.stopPropagation(),u(t.assetId),i("delete_asset","asset_row",{location:"asset-row",assetId:t.assetId,assetName:t.name,assetSize:null!=(a=null==(s=t.sizeBytes)?void 0:s.toString())?a:"unknown",assetType:t.mimeType})},[t,u,i]);return(0,a.jsxs)(f.P.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:(0,h.cn)("flex flex-shrink-0 items-center gap-4 p-2 border rounded-xl bg-card hover:bg-card-hover cursor-pointer focus:bg-card-hover focus:outline-none mb-2 overflow-x-hidden",s&&"bg-card-hover"),tabIndex:0,onClick:x,children:[(0,a.jsx)(ek.E,{metadata:(0,eN.B)(t),className:"rounded-lg w-12 h-12 ms-0 me-0 [&>img]:h-full [&>img]:w-full"}),(0,a.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,a.jsx)("span",{className:"line-clamp-1 break-all",children:t.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 line-clamp-1 break-all",children:[(0,a.jsx)("span",{children:t.sizeBytes?(0,eC.z)(t.sizeBytes):l("file-browser.unknown-size","Unknown")}),(0,a.jsx)("span",{children:" • "}),(0,a.jsx)("span",{children:t.createTime?(0,eI.P)(t.createTime):""}),(0,a.jsx)("span",{children:" • "}),(0,a.jsx)("span",{children:t.mimeType})]})]}),o?(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)(m.gx,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),c(!1)},tooltipContent:l("Cancel","Cancel"),"aria-label":l("Cancel","Cancel"),className:"flex items-center gap-3 size-8 rounded-md",children:(0,a.jsx)(d.X,{size:16})}),(0,a.jsx)(m.gx,{variant:"ghost",size:"sm",btnColor:"danger",onClick:g,tooltipContent:l("Confirm","Confirm"),"aria-label":l("Confirm","Confirm"),className:"flex items-center gap-3 size-8 rounded-md",children:(0,a.jsx)(d.TBR,{size:16})})]}):(0,a.jsx)(m.gx,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),c(!0)},tooltipContent:l("Delete","Delete"),"aria-label":l("Delete","Delete"),className:"flex items-center gap-3 size-8 rounded-md",children:(0,a.jsx)(d.TBR,{size:16})})]},t.assetId)});var e_=s(73772),ez=s(74933),eP=s(48589);let eA=()=>{let{route:e}=(0,L.wK)(),t=(0,eS.R)(e=>e.loadFirstPage),s=(0,eS.R)(e=>e.loadNextPage),a=(0,eS.R)(e=>e.listPageToken),l=(0,eS.R)(e=>e.listStatus),n=(0,eS.Z0)(),i="files"===e.page?e.sort:"used",r="files"===e.page?e.search:void 0;(0,F.useEffect)(()=>{t({sort:i,search:r})},[t,i,r,e.page]);let{loadMoreRef:o,historyContainerRef:c}=(0,j.R)({hasNextPage:!!a,isFetchingNextPage:"loading"===l,isLoading:"loading"===l,fetchNextPage:()=>{s().catch(e=>(0,w.vV)("files-load-more",e))}});return{assets:n,isLoading:"loading"===l,hasError:"error"===l,refetch:t,loadMoreRef:o,historyContainerRef:c}},eM=[{label:(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.size",defaults:"Size"}),value:"size"},{label:(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.name",defaults:"Name"}),value:"name"},{label:(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.created-time",defaults:"Created Time"}),value:"created"},{label:(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.last-used-time",defaults:"Last Used Time"}),value:"used"}];function eD(){let{t:e}=(0,p.Bd)("base"),{user:t}=(0,u.useSession)(),{push:s,replace:l,route:g}=(0,L.wK)(),v="files"===g.page?g:(0,ej.Z)("only for /files"),[j,y]=(0,F.useState)(""),b=v.sort||"used",w=(0,X.Di)(),k=(0,eP.o)(j,500);(0,F.useEffect)(()=>{l({...v,search:k})},[k,l,v]);let N=e=>{s({...v,sort:e})},I=(0,n.aP)(e=>{var t;return(null==(t=e.sidePanelContent)?void 0:t.type)!=="asset"?null:e.sidePanelContent.data.fileMetadataId}),{assets:C,isLoading:S,hasError:E,refetch:_,loadMoreRef:z,historyContainerRef:P}=eA();return t?(0,a.jsxs)("main",{className:(0,h.cn)("h-dvh w-full relative flex flex-col items-center"),children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)(r.CommandMenu,{}),(0,a.jsxs)("div",{className:"max-w-[50rem] px-5 pt-16 pb-8 @sm:pt-18 mx-auto w-full flex flex-col h-full",ref:P,children:[(0,a.jsx)("h1",{className:(0,h.cn)("text-2xl flex gap-2 items-center pb-4 font-semibold",w&&"ps-3"),children:e("Files","Files")}),(0,a.jsxs)("div",{className:"flex gap-2 items-center justify-between w-full pb-2",children:[(0,a.jsx)(ez.p,{value:j,onChange:e=>y(e.target.value),placeholder:e("file-browser.filter.placeholder","Search files..."),className:"text-primary bg-surface-l1 border-border-l1 h-10 rounded-xl"}),(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(m.$n,{variant:"outline",className:"h-10 rounded-xl",children:[(0,a.jsx)(d.ufo,{size:15,className:"text-fg-secondary"}),e("files-sort-show-menu","Sort"),(0,a.jsx)(d.D3D,{className:"text-fg-secondary",size:14})]})}),(0,a.jsx)(e_.SQ,{children:eM.map(e=>(0,a.jsxs)(e_._2,{className:"gap-2",onSelect:()=>N(e.value),children:[e.label,b===e.value&&(0,a.jsx)("span",{className:"ms-auto text-xs text-primary",children:(0,a.jsx)(d.Srz,{size:16,className:"text-primary"})})]},e.value))})]})]}),(0,a.jsxs)(c.D,{children:[(0,a.jsxs)(x.N,{children:[null==C?void 0:C.map(e=>(0,a.jsx)(eE,{isFileSelected:e.assetId===I,asset:e},e.assetId)),(null==C?void 0:C.length)===0&&!S&&(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center",children:e("file-browser.no-files-found","No files found")})},"no-files-found"),S&&(0,a.jsx)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px]",children:(0,a.jsx)(f.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(d.krw,{className:"animate-spin"})})})},"files-loading"),E&&(0,a.jsxs)("div",{className:"flex justify-center items-center w-full h-full max-h-[150px] flex-col gap-4",children:[(0,a.jsx)("div",{className:"text-center",children:e("file-browser.error.description","There was an issue loading your files")}),(0,a.jsx)(m.$n,{variant:"filledSecondary",onClick:()=>_(),children:e("Retry","Retry")})]},"files-error")]}),(0,a.jsx)("div",{ref:z})]})]})]}):(0,a.jsx)("main",{className:(0,h.cn)("w-screen h-dvh relative"),children:(0,a.jsx)(o.J,{title:e("Error","Error"),description:e("file-browser.error.anonymous-user","You must be logged in to access this page"),cta:e("files-page-error.cta","Return home")})})}var eR=s(92437);function eT(e){let{className:t}=e,{t:s}=(0,p.Bd)("files"),l=(0,F.useRef)(null),n=(0,eS.R)(e=>e.uploadAsset),{push:i}=(0,L.wK)(),r=(0,F.useCallback)((e,t)=>{let a=t.items;if(!a||0===a.length||!a[0]||!("webkitGetAsEntry"in a[0]))return void e.forEach(e=>n(e));let l=e=>{".DS_Store"!==e.name&&n(e,e=>i({page:"files",fileId:e}))},r=e=>{(0,w.vV)("explorer-drop-zone:file-upload",e),S.oR.error(s("files-extract-error","Error when processing file"))};for(let e=0;e<a.length;e++){let t=a[e];if(!t)continue;let s=t.webkitGetAsEntry();s&&function e(t,s,a){t.isFile?t.file(s,a):t.isDirectory&&t.createReader().readEntries(t=>{for(let l of t)e(l,s,a)},a)}(s,l,r)}},[s,n,i]),o=(0,eR.t)({ref:l,onDrop:r});return(0,a.jsx)(eR.u,{ref:l,dragState:o,title:s("explorer-dropzone.title","Drop files to upload"),className:t})}var eB=s(41284),eL=s(25859),eF=s(86565);let eO=(0,F.memo)(e=>{let{children:t}=e,{t:s}=(0,p.Bd)("files"),l=(0,eS.R)(e=>e.createAsset),n=(0,y._)(),{push:i}=(0,L.wK)(),r=(0,eF.KR)(),{ENABLE_IMAGE_EDITOR_IN_FILES:o,ENABLE_XLSX_EDITING:c}=(0,Q.h)(),u=(0,F.useRef)(null),m=(0,eS.R)(e=>e.uploadAsset),h=(0,F.useCallback)(e=>i({page:"files",fileId:e}),[i]),f=(0,F.useCallback)(e=>{l(e,h),n("files.create-file",e,{location:"AddFileButton:handleCreate"})},[l,h,n]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:t||(0,a.jsxs)(eL.$n,{variant:"secondary",shape:"square",size:"sm",className:"flex-shrink-0",children:[(0,a.jsx)(d.FWt,{size:"18"}),(0,a.jsx)("span",{className:"sr-only",children:s("files-add-button.label","Add new file")})]})}),(0,a.jsxs)(e_.SQ,{align:"start",alignOffset:-8,sideOffset:8,className:"min-w-40",children:[(0,a.jsx)(eG,{fileTypeId:"markdown",onSelect:f}),c&&(0,a.jsxs)(e_._2,{onSelect:()=>{f(r.spreadsheet.newFileName)},children:[(0,F.createElement)(r.spreadsheet.Icon,{className:"me-2 text-secondary",size:16}),r.spreadsheet.name]}),o&&(0,a.jsxs)(e_._2,{onSelect:()=>i({page:"files",fileId:null,emptyView:"image"}),children:[(0,a.jsx)(d.XGR,{size:16,className:"me-2 text-secondary"}),s("files-add-image","Image")]}),(0,a.jsxs)(e_.lv,{children:[(0,a.jsxs)(e_.nV,{children:[(0,a.jsx)(d.bvm,{size:16,className:"me-2 text-secondary"}),s("files-add-code","Code")]}),(0,a.jsx)(e_.dc,{children:(0,a.jsx)(e_.M5,{sideOffset:12,alignOffset:-4,className:"min-w-36",children:eF.cC.map(e=>(0,a.jsx)(eG,{fileTypeId:e,disableIcons:!0,onSelect:f},e))})})]}),(0,a.jsx)(e_.mB,{className:"bg-border-l1 mx-2"}),(0,a.jsxs)(e_._2,{onSelect:()=>{u.current&&u.current.click()},children:[(0,a.jsx)(d.sjq,{size:16,className:"me-2 text-secondary"}),s("files-menu-upload.label","Upload Files")]})]})]}),(0,a.jsx)("input",{type:"file",ref:u,className:"hidden",onChange:e=>{e.target.files&&(Array.from(e.target.files).forEach(e=>{m(e,h)}),e.target.value="")},multiple:!0})]})});function eG(e){let{fileTypeId:t,onSelect:s,disableIcons:l}=e,{Icon:n,name:i,newFileName:r}=(0,eF.KR)()[t];return(0,a.jsxs)(e_._2,{onSelect:()=>s(r),children:[l?null:(0,a.jsx)(n,{size:16,className:"me-2 text-secondary"}),i]})}function eU(e){let{className:t,onClose:s,onBlur:l,...n}=e,{t:i}=(0,p.Bd)("files"),r=(0,h.cn)("rounded-full shadow-none border border-border ps-9 h-8 focus:ring-0",t),o=(0,F.useCallback)(e=>{null==l||l(e),""===e.target.value&&(null==s||s())},[l,s]);return(0,a.jsxs)("div",{className:"relative flex flex-1",children:[(0,a.jsx)(d.vji,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:16}),(0,a.jsx)(ez.p,{placeholder:i("files-search-input.placeholder","Search"),className:r,onBlur:o,...n})]})}function eq(){var e,t;let{t:s}=(0,p.Bd)("files"),l=(0,L.wK)(),{push:n,replace:i}=l,r="files"===l.route.page?l.route:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw Error(e)}("Only use Header in /files"),o=(0,V.wV)(),[c,u]=(0,F.useState)(null!=(e=r.search)?e:""),[m,g]=(0,F.useState)(null!=(t=r.search)&&t),[v,j]=(0,F.useState)(!1),y=(0,eP.o)(c,500);(0,F.useEffect)(()=>{i({page:"files",search:y})},[y,i]),(0,F.useEffect)(()=>{r.search||(j(!1),u(""))},[r.search]);let b=e=>{e.stopPropagation(),e.preventDefault(),j(!1),u(""),n({page:"files",sort:null,createdBy:null,fileType:null,search:""})},w="files"===r.page&&r.sort||null,k=e=>{n({page:"files",sort:e})},N="files"===r.page&&r.createdBy||null,I=e=>{n({page:"files",createdBy:e})},C="files"===r.page&&r.fileType||null,S=e=>{n({page:"files",fileType:e})},E=()=>{u(""),g(!1)},_=(0,F.useMemo)(()=>[{label:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eB.e,{className:"w-6 h-6",textClassName:"!text-[10px]",user:o.user}),(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.creator-human",defaults:"Me"})]}),value:"user"},{label:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(R.$r,{className:"w-6 h-6"}),(0,a.jsx)(p.x6,{ns:"base",i18nKey:"file-browser.sort.creator-grok",defaults:"Grok"})]}),value:"grok"}],[o.user]),z=[{value:"image",label:s("files-filter-images","Images"),icon:d.xfq},{value:"document",label:s("files-filter-documents","Documents"),icon:d.pyG},{value:"spreadsheet",label:s("files-filter-spreadsheets","Spreadsheets"),icon:d.KbA},{value:"code",label:s("files-filter-code","Code"),icon:d.loI},{value:"pdf",label:s("files-filter-pdf","PDF"),icon:d.yTC}];return(0,a.jsxs)("header",{className:"flex flex-col gap-px @container px-4",children:[(0,a.jsxs)("div",{className:"flex gap-2 h-header-height items-center",children:[(0,a.jsx)("div",{className:"flex-1 relative min-h-[32px]",children:(0,a.jsx)(x.N,{mode:"sync",children:m?(0,a.jsx)(f.P.div,{initial:{width:"32px",height:"32px",opacity:0},animate:{width:"100%",height:"auto",opacity:1},exit:{width:"32px",height:"32px",opacity:0},transition:{duration:.1,ease:"easeOut"},className:"flex justify-end items-center gap-2 absolute top-0 end-0",children:(0,a.jsx)(eU,{value:c,onChange:e=>{u(e.target.value)},autoFocus:!0,className:"flex-1",onKeyDown:e=>{"Escape"===e.key&&E()},onClose:E})},"search-input"):(0,a.jsxs)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1,ease:"easeOut"},className:"flex justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold flex items-center justify-start",children:(0,a.jsx)(L.N_,{route:{page:"files",fileId:null},children:s("files-explorer-header","Files")})}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(eL.$n,{variant:"tertiary",shape:"square",size:"sm","aria-label":s("files-explorer-collapse-button","Collapse"),onClick:()=>eS.R.getState().setIsFileExplorerCollapsed(!0),children:(0,a.jsx)(d.KD8,{size:18,className:"text-fg-secondary"})}),(0,a.jsxs)(eL.$n,{variant:"tertiary",shape:"square",size:"sm",onClick:()=>g(!0),children:[(0,a.jsx)(d.WIv,{size:18,className:"text-fg-secondary"}),(0,a.jsx)("span",{className:"sr-only",children:s("files-search-open-button.label","Show search input")})]})]})]},"title-and-button")})}),(0,a.jsx)(eO,{})]}),(0,a.jsxs)("div",{className:"flex gap-2 overflow-x-auto no-scrollbar h-subheader-height items-center",children:[(0,a.jsxs)(e_.rI,{open:v,onOpenChange:j,children:[(0,a.jsxs)("div",{className:(0,h.cn)("flex items-center rounded-full border gap-0.5 border-border-l2 h-8 overflow-hidden flex-shrink-0 focus-visible:bg-button-ghost-hover hover:bg-button-ghost-hover",(C||N)&&"bg-button-ghost-hover border-secondary pr-0"),children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(eL.$n,{variant:"secondary",size:"sm",shape:"rectangle",className:(0,h.cn)("border flex-shrink-0 border-transparent hover:bg-transparent",(C||N)&&"pr-0 hover:bg-transparent"),style:{boxShadow:"none"},children:[(0,a.jsx)(d.YGH,{size:16,className:"text-fg-secondary"}),(0,a.jsx)("span",{className:"sr-only",children:s("files-filter-open-button.label","Show filters")}),(0,a.jsx)("span",{className:"hidden @[160px]:inline-block",children:s("files-filter-show-menu","Filter")})]})}),C||N?(0,a.jsxs)(eL.$n,{variant:"tertiary",size:"sm",onClick:b,shape:"circle",children:[(0,a.jsx)(d.uv5,{size:16}),(0,a.jsx)("span",{className:"sr-only",children:s("files-filter-clear","Clear all filters")})]}):null]}),(0,a.jsxs)(e_.SQ,{side:"bottom",align:"start",sideOffset:6,className:"no-a11y-check rounded-2xl",children:[(0,a.jsxs)("div",{className:"min-w-40 flex flex-col gap-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-secondary ms-3 my-2 min-w-32",children:s("files-filter-by-creator","Created By")}),_.map(e=>(0,a.jsxs)(e_._2,{onSelect:()=>I(e.value),className:"flex items-center gap-2",children:[e.label,N===e.value&&(0,a.jsx)("span",{className:"ms-auto text-xs text-primary",children:(0,a.jsx)(d.Srz,{size:16,className:"text-primary"})})]},"CREATOR_OPTIONS"+e.value.toString()))]}),(0,a.jsx)(e_.mB,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-secondary ms-3 my-2",children:s("files-filter-by-type","File Type")}),z.map(e=>{let t=e.icon;return(0,a.jsxs)(e_._2,{onSelect:()=>S(e.value),className:"flex items-center gap-2",children:[(0,a.jsx)(t,{size:16,className:"text-fg-secondary"}),e.label,C===e.value&&(0,a.jsx)("span",{className:"ms-auto text-xs text-primary",children:(0,a.jsx)(d.Srz,{size:16,className:"text-primary"})})]},e.value||"all")})]})]}),(c||C||N)&&(0,a.jsx)(eL.$n,{variant:"secondary",size:"md",shape:"rectangle",onClick:b,className:"w-full mt-4 rounded-xl",children:s("files-filter-reset","Reset filters")})]})]}),(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(eL.$n,{variant:"secondary",size:"sm",shape:"pill",className:" flex-shrink-0",children:[(0,a.jsx)(d.ufo,{size:15,className:"text-fg-secondary"}),(0,a.jsx)("span",{className:"sr-only",children:s("files-sort-show-menu","Show sorting menu")}),(0,a.jsx)("span",{className:"hidden @[160px]:inline-block",children:s("files-sort-show-menu","Sort")})]})}),(0,a.jsx)(e_.SQ,{side:"bottom",align:"start",sideOffset:6,className:"min-w-36",children:eM.map(e=>(0,a.jsxs)(e_._2,{onSelect:()=>k(e.value),className:"flex items-center gap-2",children:[e.label,w===e.value&&(0,a.jsx)("span",{className:"ms-auto text-xs text-primary",children:(0,a.jsx)(d.Srz,{size:16,className:"text-primary"})})]},e.value))})]}),(0,a.jsx)(eW,{})]})]})}let eW=(0,F.memo)(function(){let e=(0,eS.R)(e=>"loading"===e.listStatus);return(0,a.jsx)(x.N,{children:e&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"flex-1 flex justify-end items-center",children:(0,a.jsx)(H.y,{size:"xs",className:"border-b-secondary"})})})});var eK=s(83638),eV=s(48429),e$=s(51182);function eH(e){let{onRetry:t}=e,{t:s}=(0,p.Bd)("files");return(0,a.jsxs)("div",{className:"border border-l1 bg-surface-l1 rounded-2xl p-4 flex flex-col items-center justify-center text-center",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold mb-2",children:s("files-list-loading-error.title","Could not load files")}),(0,a.jsx)("p",{className:"text-xs text-fg-secondary mb-4",children:s("files-list-loading-error.message","Something went wrong while loading your files")}),(0,a.jsxs)(m.$n,{variant:"outline",size:"md",onClick:t,children:[(0,a.jsx)(d.e9t,{className:"h-4 w-4 text-secondary"}),s("files-list-loading-error.retry","Retry")]})]})}function eY(e){let{onFiltersClear:t}=e,{t:s}=(0,p.Bd)("files");return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4 overflow-hidden",children:[(0,a.jsx)("p",{className:"text-muted-foreground truncate",children:s("files-no-results.label","No results")}),t&&(0,a.jsxs)(m.$n,{variant:"outline",size:"md",onClick:()=>{t()},children:[(0,a.jsx)(d.uv5,{size:16}),(0,a.jsx)("span",{className:"truncate",children:s("files-clear-filters.label","Clear filters")})]})]})}var eQ=s(93038);function eX(e){var t;let{asset:s,stack:l,className:n}=e,i=(0,F.useRef)(!l.length);return l.length?(0,a.jsx)("div",{className:(0,h.cn)("relative",n),children:(0,a.jsxs)(x.N,{initial:i.current,children:[(0,a.jsx)(f.P.div,{animate:{x:-2,y:2,rotate:-8},transition:{delay:.2,duration:1},children:(0,a.jsx)(ek.E,{metadata:(0,eN.B)(s),className:"rounded-md w-6 h-6 ms-0 me-0 [&>img]:h-full [&>img]:w-full bg-surface-l1 border border-white"})},s.assetId),(0,a.jsx)(f.P.div,{animate:{x:2,y:-2,rotate:8},transition:{duration:2},className:"absolute inset-0 -z-10",children:(0,a.jsx)(ek.E,{metadata:(0,eN.B)(l[0]),className:"rounded-md w-6 h-6 ms-0 me-0 [&>img]:h-full [&>img]:w-full bg-surface-l1 border border-white"})},null==(t=l[0])?void 0:t.assetId)]})}):(0,a.jsx)(ek.E,{metadata:(0,eN.B)(s),className:"rounded-md w-6 h-6 ms-0 me-0 [&>img]:h-full [&>img]:w-full bg-surface-l1 border border-white"})}function eJ(e){let{okLabel:t,onOk:s,cancelLabel:l,onCancel:n}=e;return(0,a.jsxs)("div",{className:(0,h.cn)("flex","items-center justify-end gap-0.5"),children:[(0,a.jsxs)(eL.gx,{variant:"tertiary",size:"sm",shape:"square",onClick:n,tooltipContent:l,tooltipContentProps:{hideWhenDetached:!0},children:[(0,a.jsx)(d.uv5,{size:16,className:"text-fg-primary"}),(0,a.jsx)("span",{className:"sr-only",children:l})]}),(0,a.jsxs)(eL.gx,{variant:"tertiary",size:"sm",shape:"square",onClick:s,tooltipContent:t,tooltipContentProps:{hideWhenDetached:!0},children:[(0,a.jsx)(d.Srz,{size:16,className:"text-fg-primary"}),(0,a.jsx)("span",{className:"sr-only",children:l})]})]})}var eZ=s(80354);let e0=(0,F.memo)(function(e){let{value:t,onSubmit:s,onCancel:l,state:n,suffix:i,className:r}=e,{t:o}=(0,p.Bd)("files"),[c,d]=(0,F.useState)(t),u=(0,F.useRef)(null);(0,F.useEffect)(()=>{d(t)},[t]),(0,F.useEffect)(()=>{"edit"===n&&u.current&&(u.current.focus(),u.current.setSelectionRange(0,u.current.value.lastIndexOf(".")))},[n]);let m=()=>{s(c.trim())},f=e=>{e.preventDefault(),e.stopPropagation(),m()};if("edit"===n)return(0,a.jsxs)("div",{className:"flex flex-1",onClick:eZ.Y,children:[(0,a.jsx)("input",{ref:u,className:"w-full bg-transparent focus-visible:outline-none",value:c,onKeyDown:e=>{"Enter"===e.key?m():"Escape"===e.key&&l()},onChange:e=>d(e.target.value),"aria-label":o("filename-edit-input.label","Edit file name")}),(0,a.jsx)(eJ,{onCancel:e=>{e.preventDefault(),e.stopPropagation(),l()},cancelLabel:o("Cancel","Cancel"),onOk:e=>{e.preventDefault(),e.stopPropagation(),f(e)},okLabel:o("Save","Save")})]});let x=(0,h.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden inline-block",r);return(0,a.jsxs)("span",{className:x,style:{maskImage:J.uU,WebkitMaskImage:J.uU},children:[t,i&&(0,a.jsx)("span",{className:"text-fg-tertiary",children:i})]})}),e1=e=>(0,a.jsx)("span",{className:"font-bold",children:e}),e2=e=>{let{text:t,pattern:s,renderMatch:l=e1}=e,n=(0,F.useMemo)(()=>{let e=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=RegExp("(".concat(e,")"),"gi");return t.split(a)},[t,s]);return(0,a.jsx)(a.Fragment,{children:n.map((e,t)=>e.toLowerCase()===s.toLowerCase()&&l?(0,a.jsx)(F.Fragment,{children:l(e)},t):(0,a.jsx)(F.Fragment,{children:e},t))})};function e5(e){let{assetId:t}=e,s=(0,eS.R)(e=>e.debouncedSearchQuery),l=(0,eS.R)(e=>{var a,l;return null!=(l=null==(a=e.searchHighlight[s])?void 0:a[t])?l:""});return l&&s?(0,a.jsx)("div",{className:"px-3 mb-2 text-xs text-fg-secondary text-start max-w-full text-wrap line-clamp-3 leading-normal max-h-[4.5em]",children:(0,a.jsx)(e2,{text:l,pattern:s,renderMatch:e4})}):null}let e4=e=>(0,a.jsx)("span",{className:"text-fg-primary font-semibold",children:e});var e3=s(93154);let e6=(0,F.memo)(function(e){var t,s,l,n,i,r,o;let{asset:c,stackedAssets:u,action:m,onActionChange:f,className:x,isActive:g=!1}=e,{push:v,route:j}=(0,L.wK)(),{t:b}=(0,p.Bd)("base"),k=(0,eS.R)((0,e$.k)(e=>e.assetsById)),N=(0,y._)(),[,I]=(0,e3.s)(null!=(s=c.name)?s:""),C=null!=(n=null!=I?I:(0,eQ.extension)(null!=(l=c.mimeType)?l:""))?n:"",S=(null==m?void 0:m.type)==="edit"&&(null==m?void 0:m.assetId)===c.assetId,E=(null==m?void 0:m.type)==="delete"&&(null==m?void 0:m.assetId)===c.assetId,_=(0,eS.R)(e=>e.renameAsset),z=(0,F.useMemo)(()=>u.map(e=>{var t;return null==(t=k[e])?void 0:t.data}).filter(Boolean).sort((e,t)=>new Date((null==e?void 0:e.createTime)||"").getTime()-new Date((null==t?void 0:t.createTime)||"").getTime())||[],[u,k]),P=(0,F.useCallback)(()=>{f(null)},[f]),A=(0,F.useCallback)(e=>{var t,s,a,l;let n=null==(s=k[c.rootAssetId||c.assetId])||null==(t=s.data)?void 0:t.sourceConversationId,i=null!=(l=null!=(a=c.rootAssetSourceConversationId)?a:n)?l:c.sourceConversationId;i&&(e.stopPropagation(),e.preventDefault(),v({page:"chat",conversationId:i,temporary:!1}))},[c.rootAssetSourceConversationId,c.rootAssetId,c.assetId,c.sourceConversationId,k,v]),M=(0,F.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),f({type:"delete",assetId:c.assetId})},[c.assetId,f]),D=(0,F.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),P()},[P]),T=(0,eS.R)(e=>e.deleteAsset),B=async e=>{var t;e.stopPropagation(),e.preventDefault(),f(null),await T(null!=(t=c.assetId)?t:""),N("files.delete",c.assetId,{location:"FileRow:handleDelete"}),(null==u?void 0:u.length)&&await Promise.all(u.map(e=>(N("files.delete",e,{location:"FileRow:handleDelete"}),T(e)))),"files"===j.page&&(j.fileId===c.rootAssetId||j.fileId===c.assetId)&&v({page:"files",fileId:null})},O=(0,h.cn)("flex py-0 gap-1 relat justify-start items-center w-full overflow-hidden group/file hover:bg-button-ghost-hover min-h-10 h-auto items-stretch",{"bg-button-ghost-active":g},x);return(0,a.jsx)(eL.$n,{variant:"tertiary",size:"sm",shape:"rectangle",className:O,asChild:!0,children:(0,a.jsxs)(L.N_,{route:{page:"files",fileId:null!=(r=null!=(i=c.rootAssetId)?i:c.assetId)?r:null},className:(0,h.cn)("group/file text-sm","w-full flex flex-col justify-center !gap-0 text-primary ps-0 pe-1"),children:[(0,a.jsxs)("div",{className:"w-full flex flex-row gap-2 text-primary ps-2 items-center min-h-10",children:[(null==(t=c.mimeType)?void 0:t.startsWith("image/"))?(0,a.jsx)(eX,{asset:c,stack:z,className:"w-fit h-fit"}):(0,a.jsx)(ek.E,{metadata:(0,eN.B)(c),className:"rounded-md w-6 h-6 ms-0 me-0 [&>img]:h-full [&>img]:w-full bg-transparent"}),(0,a.jsx)(e0,{value:null!=(o=c.name)?o:"",onCancel:P,onSubmit:e=>{var t;f(null),""!==e&&(_(null!=(t=c.assetId)?t:"",e).catch((0,w.HX)("FileRow")),N("files.rename",e,{location:"FileRow:save"}))},state:S?"edit":"view"}),S?null:E?(0,a.jsx)(eJ,{onCancel:D,cancelLabel:b("Cancel","Cancel"),onOk:B,okLabel:b("Delete","Delete")}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:(0,h.cn)("hidden group-hover/file:hidden group-focus-visible/file:hidden","text-fg-secondary"),children:C}),(0,a.jsxs)("div",{className:(0,h.cn)("flex items-center justify-end"),children:[(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(eL.gx,{tabIndex:-1,className:(0,h.cn)("text-fg-secondary",c.isRootAssetCreatedByModel?"w-8":"w-0","group-hover/file:w-8 group-focus-visible/file:w-8 group-hover/file:flex group-focus-visible/file:flex"),variant:"tertiary",size:"sm",shape:"square",style:{boxShadow:c.isRootAssetCreatedByModel?"none":void 0},tooltipContent:b("files-more-options.label","Options"),tooltipContentProps:{hideWhenDetached:!0,side:"bottom"},children:[c.isRootAssetCreatedByModel?(0,a.jsx)(R.$r,{className:(0,h.cn)("opacity-20 group-hover/file:hidden group-focus-visible/file:hidden size-4")}):null,(0,a.jsx)(d.YbC,{size:16,className:"hidden group-hover/file:block group-focus-visible/file:block"}),(0,a.jsx)("span",{className:"sr-only",children:b("files-more-options.label","Options")})]})}),(0,a.jsxs)(e_.SQ,{side:"bottom",align:"end",className:"min-w-36",children:[(0,a.jsxs)(e_._2,{onSelect:e=>{e.preventDefault(),f({type:"edit",assetId:c.assetId})},className:"flex items-center gap-2",children:[(0,a.jsx)(d.rZj,{size:16,className:"text-fg-secondary"}),b("files.rename","Rename")]}),c.isRootAssetCreatedByModel&&(0,a.jsxs)(e_._2,{onSelect:e=>{A(e)},className:"flex items-center gap-2",children:[(0,a.jsx)(d.PBN,{size:16,className:"text-fg-secondary"}),b("files.open-conversation","Open Conversation")]})]})]}),(0,a.jsxs)(eL.gx,{tabIndex:-1,className:(0,h.cn)("text-fg-secondary","hidden group-hover/file:flex group-focus-visible/file:flex"),onClick:M,variant:"tertiary",size:"sm",shape:"square",tooltipContent:b("files-list-delete.tooltip","Delete file"),tooltipContentProps:{hideWhenDetached:!0},children:[(0,a.jsx)(d.TBR,{size:16}),(0,a.jsx)("span",{className:"sr-only",children:b("files-list-delete","Delete file")})]})]})]})]}),(0,a.jsx)(e5,{assetId:c.assetId})]})})});var e8=s(69358),e9=s(80226);function e7(){return(0,a.jsx)(e8.P,{delayMs:300,children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-3","aria-busy":"true",children:[(0,a.jsx)(te,{className:"w-1/5"}),(0,a.jsx)(te,{className:"w-3/5"}),(0,a.jsx)(te,{className:"w-2/5"}),(0,a.jsx)(te,{className:"w-1/5"}),(0,a.jsx)(te,{className:"w-2/3"})]})})}let te=e=>{let{className:t}=e;return(0,a.jsxs)("div",{className:"flex w-full gap-3 items-center",children:[(0,a.jsx)(e9.E,{className:"w-6 h-6 rounded-md"}),(0,a.jsx)(e9.E,{className:(0,h.cn)("w-full rounded-xl h-4",t)})]})};function tt(){let{t:e}=(0,p.Bd)("files");return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("h2",{className:"text-md font-semibold text-center text-fg-primary truncate",children:e("files-empty.title","No Files")}),(0,a.jsx)("p",{className:"text-center text-fg-secondary truncate text-sm",children:e("files-empty.subtitle","Upload files or ask Grok to create one.")})]}),(0,a.jsx)(eO,{children:(0,a.jsxs)(m.$n,{className:"flex-shrink-0",size:"md",variant:"filledSecondary",children:[(0,a.jsx)(d.FWt,{className:"size-4"}),e("files-empty.add-button","Add File")]})})]})}let ts=(0,F.memo)(e=>{let{className:t}=e,{t:s}=(0,p.Bd)("files"),l=(0,L.wK)(),n=l.push,i="files"===l.route.page?l.route:(0,ej.Z)("Files list only for /files"),[r,o]=(0,F.useState)(null),d=(0,eS.R)(e=>e.loadFirstPage),u=(0,eS.R)(e=>e.loadNextPage),m=(0,eS.R)(e=>e.listPageToken),g=(0,y._)(),{search:v,sort:j,fileType:b,createdBy:w}=i,k=(0,F.useCallback)(()=>{d({search:v,sort:j,fileType:b,createdBy:w}),v&&g("files.search","",{location:"files-list:reloadFilesList"}),j&&"used"!==j&&g("files.sort",j,{location:"files-list:reloadFilesList"}),(b||w)&&g("files.filter","",{location:"files-list:reloadFilesList"})},[d,v,j,b,w,g]);(0,F.useEffect)(()=>k(),[k]);let N=(0,eS.R)(e=>!!(e.debouncedSearchQuery||e.searchFileType||e.source!==eV.eK.SourceAny)),I=(0,eS.R)((0,e$.k)(e=>e.list)),C=(0,eS.R)((0,e$.k)(e=>e.listStatus)),S=(0,eS.R)((0,e$.k)(e=>e.assetsById)),E=(0,eS.R)((0,e$.k)(e=>e.currentVersion)),_=(0,F.useMemo)(()=>I.map(e=>{var t;return null==(t=S[e])?void 0:t.data}).filter(ej.O),[I,S]),z=(0,F.useMemo)(()=>{let e=_.reduce((e,t)=>{var s,a;return(null==(s=t.mimeType)?void 0:s.startsWith("image/"))&&t.sourceConversationId&&(e[t.sourceConversationId]||(e[t.sourceConversationId]=[]),null==(a=e[t.sourceConversationId])||a.push(t.assetId)),e},{});return _.map(t=>{var s;let a=[];if((null==(s=t.mimeType)?void 0:s.startsWith("image/"))&&t.currentConversationId){let s=e[t.currentConversationId];s&&a.push(...s)}return{rootAsset:t,children:a}})},[_]),P=(0,F.useMemo)(()=>{let e=new Set(z.flatMap(e=>e.children.filter(t=>t!==e.rootAsset.assetId)));return I.filter(t=>!e.has(t))},[I,z]),A=(0,eS.R)(e=>e.creationRequests),M=(0,F.useCallback)(()=>{m&&"loading"!==C&&u()},[C,u,m]),D=(0,eK.B)(M),R=null;if("loading"===C&&!m&&0===I.length)return(0,a.jsx)(e7,{});"ready"===C?0===I.length?R=N?(0,a.jsx)(eY,{onFiltersClear:()=>{n({...i,sort:void 0,createdBy:void 0,fileType:void 0,search:""})}}):(0,a.jsx)(tt,{}):m&&(R=(0,a.jsx)("div",{ref:D,className:"text-center mt-8 text-sm text-fg-secondary",children:s("files-scrollto.label","Scroll to load more")})):"loading"===C?m&&(R=(0,a.jsx)(e7,{})):"error"===C&&(R=(0,a.jsx)(eH,{onRetry:d}));let T=(0,h.cn)("gap-0 py-1.5",t);return(0,a.jsxs)(c.D,{className:T,fadeSize:"md","aria-busy":"loading"===C,children:[(0,a.jsx)("ol",{children:A.filter(e=>!e.assetId||!S[e.assetId]).map(e=>(0,a.jsx)(f.P.li,{initial:{height:0,scaleY:0,opacity:0},animate:{height:"auto",scaleY:1,opacity:1},transition:{duration:.15},children:(0,a.jsx)(ta,{request:e})},e.name))}),(0,a.jsx)("ol",{children:(0,a.jsx)(x.N,{children:P.map(e=>{var t,s;let l=E[e];if(!l)return null;let n=null==(t=S[l])?void 0:t.data;return n?(0,a.jsx)(f.P.li,{initial:{height:"auto",scaleY:1,opacity:1},exit:{height:0,scaleY:0,opacity:0},transition:{duration:.15},children:(0,a.jsx)(e6,{asset:n,stackedAssets:(null==(s=z.find(t=>t.rootAsset.assetId===e))?void 0:s.children)||[],action:r,onActionChange:o,isActive:i.fileId===e||A.some(t=>t.assetId===e)})},e):null})})}),R]})});function ta(e){var t;let{request:s}=e,[l,n]=(0,e3.s)(null!=(t=s.name)?t:"");return(0,a.jsxs)("div",{className:"h-[42px] rounded-xl px-3.5 text-sm p-4 flex items-center bg-button-ghost-active",children:[(0,a.jsx)(H.y,{size:"xs",className:"me-[11px]"}),(0,a.jsx)("span",{children:l}),n&&(0,a.jsxs)("span",{className:"text-fg-secondary",children:[".",n]})]})}function tl(e){let{className:t}=e;return(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col",t),children:[(0,a.jsx)(eq,{}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:[(0,a.jsx)(ts,{className:"h-full px-2"}),(0,a.jsx)(eT,{className:"m-2"})]})]})}var tn=s(5663),ti=s(33231),tr=s(48175),to=s(5828);function tc(e){let{className:t,buttonText:s,multiple:l=!0}=e,{t:n}=(0,p.Bd)("files"),i=(0,F.useRef)(null),r=(0,h.cn)("flex items-center @xs:flex-col @xs:items-start @xs:justify-between h-auto p-3 rounded-2xl min-w-32 bg-surface-l1 border-border-l1",t),o=(0,eS.R)(e=>e.uploadAsset),{push:c}=(0,L.wK)(),u=(0,F.useCallback)(e=>c({page:"files",fileId:e}),[c]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.$n,{variant:"outline",className:r,onClick:()=>{i.current&&i.current.click()},disabled:!1,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.sjq,{className:"w-6 h-6 stroke-[1.5] text-secondary"}),(0,a.jsx)("span",{children:s||n("file-upload-button.label","Upload Files")})]})}),(0,a.jsx)("input",{type:"file",ref:i,style:{display:"none"},onChange:e=>{e.target.files&&(Array.from(e.target.files).forEach(e=>{o(e,u)}),e.target.value="")},multiple:l})]})}let td="w-6 h-6 text-secondary stroke-[1.5]",tu=(0,F.memo)(e=>{let{className:t}=e,{ENABLE_IMAGE_EDITOR_IN_FILES:s,ENABLE_XLSX_EDITING:l}=(0,Q.h)(),{t:n}=(0,p.Bd)("files"),{push:i}=(0,L.wK)(),r=(0,eF.KR)(),o=(0,y._)(),c=(0,eS.R)(e=>e.createAsset),u=(0,F.useCallback)((e,t)=>{c(e,t),o("files.create-file",e,{location:"Empty:handleCreate"})},[c,o]),m=e=>i({page:"files",fileId:e});return(0,a.jsxs)("div",{className:"h-full relative",children:[(0,a.jsx)(to.e,{className:"absolute top-3 left-3 z-10",variant:"tertiary",size:"sm",shape:"square"}),(0,a.jsxs)(f.P.div,{initial:{opacity:0},animate:{opacity:1},className:(0,h.cn)("flex flex-col items-center justify-center h-full p-4 @container",t),children:[(0,a.jsx)(R.$r,{className:"w-20 h-20 text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-md text-muted-foreground text-center",children:n("empty.create-something-new","Create something new")}),(0,a.jsxs)("div",{className:"w-full max-w-xl gap-3 mt-6 overflow-wrap items-stretch flex flex-col @xs:items-center @xs:flex-row flex-wrap justify-center ",children:[(0,a.jsx)(tm,{icon:(0,a.jsx)(d.pyG,{className:td}),text:n("empty.document","Document"),onClick:()=>void u(r.markdown.newFileName,m)}),l&&(0,a.jsx)(tm,{icon:(0,F.createElement)(r.spreadsheet.Icon,{className:td}),text:n("empty.spreadsheet","Spreadsheet"),onClick:()=>void u(r.spreadsheet.newFileName,m)}),(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsx)(tm,{icon:(0,a.jsx)(d.loI,{className:td}),text:n("empty.code","Code")})}),(0,a.jsx)(e_.SQ,{className:"min-w-36",side:"right",sideOffset:12,children:eF.cC.map(e=>(0,a.jsx)(th,{fileTypeId:e,disableIcons:!0,onSelect:e=>void u(e,m)},e))})]}),s&&(0,a.jsx)(tm,{icon:(0,a.jsx)(d.XGR,{className:td}),text:n("empty.image","Image"),onClick:()=>{i({page:"files",fileId:null,emptyView:"image"})}}),(0,a.jsx)(tc,{})]}),(0,a.jsx)(eT,{className:"m-4"})]})]})});function tm(e){let{icon:t,text:s,...l}=e;return(0,a.jsxs)(m.$n,{variant:"outline",className:"flex @xs:flex-col items-center justify-center @xs:items-start @xs:justify-between h-auto p-3 rounded-2xl min-w-32 @xs:bg-surface-l1 border-0  @xs:border-border-l1 @xs:border transition-none @xs:transition-colors",...l,children:[t,(0,a.jsx)("span",{children:s})]})}function th(e){let{fileTypeId:t,onSelect:s,disableIcons:l}=e,{Icon:n,name:i,newFileName:r}=(0,eF.KR)()[t];return(0,a.jsxs)(e_._2,{onSelect:()=>s(r),children:[l?null:(0,a.jsx)(n,{size:16,className:"me-2"}),i]})}var tf=s(15041),tx=s(4878),tp=s(1189),tg=s(44347),tv=s(91631),tj=s(39489),ty=s(82591),tb=s(69643),tw=s(28951),tk=s(93220);let tN=e=>{let{selectedImage:t,isPeekingParent:s,isFinalImageLoaded:l,setIsFinalImageLoaded:n,isParentImageLoaded:i,setIsParentImageLoaded:r}=e,[o,c]=(0,F.useState)([]),[d,u]=(0,F.useState)(!0),m=(0,F.useMemo)(()=>"streaming"===t.state,[t.state]),p=(0,F.useMemo)(()=>!!(t.generatedImageHeight&&t.generatedImageWidth),[t.generatedImageHeight,t.generatedImageWidth]),g=(0,F.useMemo)(()=>t.generatedImageHeight&&t.generatedImageWidth?t.generatedImageWidth/t.generatedImageHeight:4/3,[t.generatedImageHeight,t.generatedImageWidth]);return(0,F.useEffect)(()=>{(m||!d)&&(null==t?void 0:t.progressMap)?c(t.progressMap):!m&&(null==t?void 0:t.url)?c(e=>[...e,{progress:1,imageUrl:t.url||""}]):c([])},[m,null==t?void 0:t.url,null==t?void 0:t.progressMap,d]),(0,F.useEffect)(()=>{m&&d&&u(!1),m||!l||d||u(!0)},[m,l,d]),(0,a.jsx)("figure",{className:(0,h.cn)("relative group/image w-full max-w-5xl 2xl:max-w-6xl overflow-hidden rounded-lg"),children:(0,a.jsx)(x.N,{mode:"wait",children:m||!d?p?(0,a.jsx)(f.P.div,{initial:{opacity:0,filter:"blur(4px)"},animate:{opacity:1,filter:"blur(0px)"},exit:{opacity:1,filter:"blur(0px)",transition:{delay:1.5}},transition:{ease:"easeInOut"},className:"h-full mx-auto",style:{aspectRatio:g,maxHeight:t.generatedImageHeight},children:(0,a.jsx)(tw.L,{status:"streaming",intermediateResults:o,isModerated:t.isModerated,aspectRatio:g})},"streaming-image"):(0,a.jsx)(tk.$,{}):(0,a.jsxs)("div",{className:"flex relative items-center justify-center w-full h-full",children:[t.url&&(0,a.jsxs)(a.Fragment,{children:[!l&&(0,a.jsx)(tk.$,{className:"absolute z-20 inset-0"}),(0,a.jsx)(f.P.img,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},exit:"hidden",animate:t&&s||!l?"hidden":"visible",transition:{ease:"easeInOut"},src:t.url,alt:"active-image",className:"max-h-full aspect-auto rounded-lg",onLoad:()=>n(!0)},"finished-image")]}),(0,a.jsx)(x.N,{children:!m&&t&&s&&(0,a.jsxs)(f.P.div,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},initial:"hidden",exit:"hidden",animate:"visible",transition:{ease:"easeInOut"},className:"absolute z-10 w-full h-full flex items-center overflow-hidden",children:[!i&&(0,a.jsx)(tk.$,{className:"absolute z-20 inset-0"}),(0,a.jsx)(f.P.img,{variants:{hidden:{opacity:0,filter:"blur(4px)"},visible:{opacity:1,filter:"blur(0px)"}},animate:i?"visible":"hidden",src:t.parentImageUrl,alt:"parent-image",className:"max-h-full aspect-auto mx-auto rounded-lg",onLoad:()=>r(!0)},"parent-image")]},"parent-image-container")})]})})})};var tI=s(70888),tC=s(59996);let tS=e=>{let{children:t,onUploadImage:s}=e,{t:l}=(0,p.Bd)("base"),i=(0,tI.x)(C.A("fetchUploadFile")),r=(0,tI.x)(C.A("removeByConversationId")),o=(0,n.aP)(C.A("conversationId")),c=(0,b.K)(),u=(0,F.useRef)(null),[h,g]=(0,F.useState)(!1),[v,j]=(0,F.useState)(!1),[y,w]=(0,F.useState)(!1),k=(0,F.useCallback)(()=>{var e;null==(e=u.current)||e.click()},[]),N=(0,F.useCallback)(async(e,t)=>{let a;if(1!==e.length||!e[0])return void S.oR.error(l("image-editor.one-upload-allowed","Only a single image file is allowed"));if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e[0].type))return void S.oR.error(l("image-editor.images-only-allowed","Only image files are allowed"));j(!0);try{let t=i(e[0],o||"no_conversation_id");a=await t.metadataPromise}catch(e){c("image-editor-upload:uploadFile",e)}a instanceof Error&&c("image-editor-upload:uploadFile",a,l("image-editor.failed-to-upload","Failed to upload file")),j(!1),r(o||"no_conversation_id"),!a||a instanceof Error||s({image:a,type:t})},[l,i,o,s,r,c]),I=(0,F.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),v||g(!0)},[v]),E=(0,F.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),g(!1)},[]),_=(0,F.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),g(!1),!v)return N(Array.from(e.dataTransfer.files),"upload")},[N,v]),z=(0,F.useCallback)(e=>{if(e.target.files)return N(Array.from(e.target.files),"upload").finally(()=>{u.current&&(u.current.value="")})},[N]),P=(0,F.useCallback)(async e=>N([e],"draw").finally(()=>{w(!1)}),[N]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},onDragOver:I,onDragLeave:E,onDrop:_,className:"border resize transition-colors w-full h-full flex justify-center items-center border-border-l1 rounded-2xl p-8 mb-3 text-center ".concat(h&&!v&&"bg-surface-l1 border-border-l1"),children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 w-full",children:[(0,a.jsx)("div",{className:"p-4 rounded-full text-fg-secondary transition-colors bg-surface-l1",children:(0,a.jsx)(x.N,{mode:"popLayout",children:h&&!v?(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(d.sv7,{className:"size-6"})},"files"):(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(d.XGR,{className:"size-6"})},"image-plus")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-primary",children:l("image-editor.empty.title","Ask Grok to create an image")}),(0,a.jsx)(x.N,{mode:"popLayout",children:v?(0,a.jsx)(f.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary whitespace-nowrap",children:l("image-editor.empty.uploading-image","Uploading image")},"uploading"):h?(0,a.jsx)(f.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary whitespace-nowrap",children:l("image-editor.empty.drop-image","Drop image here")},"dragging"):(0,a.jsx)(f.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-sm text-fg-secondary whitespace-nowrap",children:l("image-editor.empty.description","You can also upload an image or draw instead.")},"not-dragging")})]}),t,(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(m.$n,{variant:"outline",className:"text-fg-primary hover:bg-button-ghost-hover rounded-2xl transition-all py-2.5 px-4 h-auto *:hover:text-fg-primary *:hover:transition-colors",disabled:v,onClick:k,children:[v?(0,a.jsx)(H.y,{size:"xxs"}):(0,a.jsx)(d._OO,{className:"size-4 text-fg-secondary"}),l("image-editor.empty.upload","Upload")]}),(0,a.jsxs)(m.$n,{variant:"outline",className:"text-fg-primary hover:bg-button-ghost-hover rounded-2xl transition-all py-2.5 px-4 h-auto *:hover:text-fg-primary *:hover:transition-colors",disabled:v,onClick:()=>{w(!0)},children:[(0,a.jsx)(d.qHZ,{className:"size-4 text-fg-secondary"}),l("image-editor.empty.draw","Draw")]})]}),(0,a.jsx)("input",{ref:u,className:"hidden",type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:z,multiple:!1,"data-testid":"file-input"})]})}),(0,a.jsx)(tC.A,{open:y,setOpen:w,onAttach:P})]})};var tE=s(52244),t_=s(12220),tz=s(47127);let tP=e=>{let{selectedImage:t,title:s,isSending:l=!1,onRegenerate:i,onClose:r}=e,{t:o}=(0,p.Bd)("base"),[c,u]=(0,F.useState)(!1),h=(0,n.aP)(e=>e.conversationId),g=(0,n.aP)(e=>e.lastMessageId),v=(0,F.useCallback)(()=>{var e;!c&&(null==t?void 0:t.url)&&(u(!0),(0,t_.G)(t.url,null==(e=t.url)?void 0:e.split("/").pop()).catch((0,w.HX)("image-editor:handleDownload")).finally(()=>u(!1)))},[c,t]);return(0,a.jsx)("header",{className:"flex justify-between w-full items-start h-10 gap-3  relative z-30 flex-shrink-0",children:(0,a.jsxs)(x.N,{mode:"popLayout",children:[s&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:"w-full overflow-hidden min-w-0 hidden sm:block",children:s},JSON.stringify(s)),(0,a.jsxs)("div",{className:"flex gap-2 ml-auto shrink-0",children:[(null==t?void 0:t.state)&&["streaming","error","completed"].includes(t.state)&&(null==t?void 0:t.regenResponseId)&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,a.jsx)(m.gx,{size:"iconMd",variant:"ghost",rounded:!0,"aria-label":o("image-editor.regenerate","Regenerate Image"),tooltipContent:o("image-editor.regenerate","Regenerate Image"),tooltipContentProps:{side:"bottom"},asChild:!0,disabled:"streaming"===t.state||l,onClick:i,children:(0,a.jsx)(f.P.button,{whileTap:(null==t?void 0:t.state)==="streaming"||l?void 0:{scale:.9},children:(0,a.jsx)(d.V$7,{className:"size-5"})})})},"regenerate"),t&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,a.jsx)(m.gx,{variant:"ghost",size:"iconMd",rounded:!0,"aria-label":o("image-editor.download-image","Download Image"),tooltipContent:o("image-editor.download-image","Download Image"),tooltipContentProps:{side:"bottom"},disabled:"streaming"===t.state||!t.url||c,onClick:v,children:(0,a.jsx)(tz.p,{children:c?(0,a.jsx)(H.y,{size:"xs"}):(0,a.jsx)(d.KXi,{className:"size-5"})},c?"is-downloading":"download-icon")})},"download"),h&&g&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,a.jsx)(tE.w,{variant:"ghost",size:"iconMd",rounded:!0,conversationId:h,responseId:g,iconProps:{size:20}})},"share"),r&&(0,a.jsx)(m.$n,{"aria-label":o("iamge-editor.close","Close Image Editor"),variant:"ghostSecondary",size:"iconMd",rounded:!0,onClick:r,children:(0,a.jsx)(d.uv5,{size:20})})]})]})})},tA=e=>{let{images:t,selectedImageId:s,onSelect:l}=e,n=(0,F.useRef)(null),i=(0,F.useRef)(null),r=(0,F.useRef)(0),o=(e,t)=>{let s={left:t.scrollLeft,top:t.scrollTop,right:t.scrollLeft+t.clientWidth,bottom:t.scrollTop+t.clientHeight},a={left:e.offsetLeft,top:e.offsetTop,right:e.offsetLeft+e.offsetWidth,bottom:e.offsetTop+e.offsetHeight};return a.left>=s.left&&a.right<=s.right&&a.top>=s.top&&a.bottom<=s.bottom};return(0,F.useEffect)(()=>{if(t.length>0&&n.current&&s){let e=n.current,t=e.querySelector('[data-image-id="'.concat(s,'"]'));t&&!o(t,e)&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},[t.length,s,t]),(0,F.useEffect)(()=>{let e=e=>{if(0===t.length||!s||document.activeElement&&("INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName||"DIV"===document.activeElement.tagName))return;let a=t.findIndex(e=>e.id===s);if(-1===a)return;let n=a;switch(e.key){case"ArrowLeft":case"ArrowUp":e.preventDefault(),n=a>0?a-1:t.length-1;break;case"ArrowRight":case"ArrowDown":e.preventDefault(),n=a<t.length-1?a+1:0;break;default:return}let o=Date.now();if(o-r.current>=150){r.current=o;let e=t[n];e&&l(e)}else i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{r.current=Date.now();let e=t[n];e&&l(e)},150-(o-r.current))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e),i.current&&clearTimeout(i.current)}},[t,s,l]),(0,a.jsx)(f.P.aside,{ref:n,className:"flex @lg:flex-col @lg:max-h-full @lg:w-auto w-fit max-w-full h-auto overflow-auto items-center justify-start gap-2 z-30 px-4 py-1 @lg:px-1 @lg:py-4",variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",children:(0,a.jsx)(x.N,{mode:"popLayout",children:t.map(e=>(0,a.jsx)(f.P.button,{"data-image-id":e.id,className:(0,h.cn)("size-20 shrink-0 relative rounded-xl border bg-background p-1 pointer-events-auto",{"ring-primary ring-2":e.id===s}),onClick:()=>l(e),whileTap:e.id!==s?{scale:.95}:{},variants:{visible:{opacity:1},hidden:{opacity:0},selected:{scale:1.05,opacity:1,transition:{duration:.15}}},initial:"hidden",animate:e.id===s?"selected":"visible",exit:"hidden",children:(0,a.jsx)("div",{className:"relative h-full w-full overflow-hidden rounded-lg",children:(0,a.jsx)("figure",{className:"absolute -translate-x-1/2 left-1/2 h-full aspect-[4/3] pointer-events-none",children:(0,a.jsx)(tw.L,{isModerated:e.isModerated,status:"streaming"===e.state?"streaming":"finished",iconSize:24,intermediateResults:"streaming"===e.state?e.progressMap:[{progress:1,imageUrl:e.url}]})})})},e.id))})},"image-editor-option-nav")};var tM=s(30693),tD=s(4423),tR=s(43035),tT=s(34500);let tB=e=>{let{selectedImage:t,isSending:s,isStreaming:l,onSend:n}=e,{editImagePresets:i}=(0,tM.F)(),r=(0,X.Di)(),[o,c]=(0,F.useState)(null),[d,u]=(0,F.useState)(null),h=(0,F.useMemo)(()=>!t||l||s,[l,s,t]),x=(0,F.useCallback)(e=>{c(t=>t===e?null:e)},[c]),p=(0,F.useCallback)(e=>{if(t&&!l&&!s)return c(null),n(e.prompt,e.presetId)},[l,t,s,n]),g=(0,F.useCallback)(e=>{let t=document.querySelector('[data-preset-id="'.concat(e,'"]'));if(!t)return{};let s=t.getBoundingClientRect();return s.right+12+200>window.innerWidth?{left:s.left-200-12,top:s.top+(s.height-150)/2}:{left:s.right+12,top:s.top+(s.height-150)/2}},[]);return(0,F.useEffect)(()=>{if(!o||r)return void u(null);let e=()=>{let e=document.body.querySelector("[data-highlighted][data-preset-id]"),t=(null==e?void 0:e.getAttribute("data-preset-id"))||null;t&&u(t)};e();let t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,attributeFilter:["data-highlighted"],subtree:!0}),()=>{t.disconnect()}},[o,r]),(0,a.jsx)("div",{className:"flex w-full xs:justify-center justify-start items-center overflow-x-auto xs:overflow-visible gap-2 xs:gap-3 relative z-30 no-scrollbar",children:i.map((e,t)=>(0,a.jsx)(f.P.div,{variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},initial:"hidden",animate:"visible",transition:{duration:.15,ease:"easeInOut",delay:.06*t},className:"bg-surface-base rounded-full",children:r?(0,a.jsxs)(tT._s,{open:e.category===o,onOpenChange:t=>{t?c(e.category):c(null)},children:[(0,a.jsx)(tT.Uz,{disabled:h,asChild:!0,children:(0,a.jsx)(tL,{category:e,disabled:h})}),(0,a.jsxs)(tT.zj,{className:"max-h-[90dvh]",children:[(0,a.jsx)(tT.BE,{children:(0,a.jsxs)(tT.gk,{className:"flex items-center justify-center gap-2",children:[e.icon&&F.createElement(e.icon,{size:20,className:"text-secondary flex-shrink-0"}),e.label]})}),(0,a.jsx)("div",{className:"p-2 space-y-2 overflow-auto",children:e.presets.map(e=>(0,a.jsxs)(m.$n,{variant:"ghost",size:"lg",className:"w-full flex items-center justify-start gap-3 h-auto py-3",onClick:()=>p(e),children:[e.icon&&F.createElement(e.icon,{size:18,className:"text-secondary flex-shrink-0"}),(0,a.jsx)("span",{children:e.label})]},e.presetId))})]})]}):(0,a.jsxs)(e_.rI,{open:e.category===o,onOpenChange:()=>x(e.category),children:[(0,a.jsx)(e_.ty,{disabled:h,asChild:!0,children:(0,a.jsx)(tL,{category:e,disabled:h})}),(0,a.jsx)(e_.SQ,{hideWhenDetached:!0,side:"top",sideOffset:8,className:"min-w-60 space-y-0.5",onMouseLeave:()=>{u(null)},onWheel:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:e.presets.map(t=>(0,a.jsxs)(e_._2,{"data-preset-id":t.presetId,className:"flex items-center gap-2",onSelect:()=>p(t),children:[t.icon&&F.createElement(t.icon,{size:16,className:"text-secondary flex-shrink-0"}),t.label,d===t.presetId&&(0,tR.createPortal)((0,a.jsxs)(f.P.div,{layoutId:"preset-preview",className:"fixed w-[200px] h-[150px] bg-surface-l4 border border-border-l1 rounded-2xl shadow-lg z-50 pointer-events-none flex items-center justify-center p-1.5",style:g(t.presetId),children:[(0,a.jsx)(tk.$,{className:"absolute inset-0"}),t.previewUrl&&(0,a.jsx)(tD.default,{src:t.previewUrl,alt:t.presetId,width:200,height:150,priority:!r&&o===e.category,className:"w-full h-full object-cover rounded-xl relative z-10"})]}),document.body)]},t.presetId))})]})},e.category))})},tL=F.forwardRef((e,t)=>{let{category:s,disabled:l,...n}=e;return(0,a.jsxs)(m.$n,{ref:t,size:"md",variant:"filledSecondary",rounded:!0,className:(0,h.cn)(!l&&"*:hover:text-primary transition-all"),disabled:l,...n,children:[s.icon&&F.createElement(s.icon,{size:16,className:"flex-shrink-0 text-secondary transition-colors"}),(0,a.jsx)("span",{children:s.label})]})});var tF=s(63174),tO=s(30388);let tG=e=>{let{selectedImage:t,isSending:s,isStreaming:l,isWaitingForResponse:n,isAborting:i,inputValue:r,onInputValueChange:o,onSend:c,onAbort:u}=e,{t:m}=(0,p.Bd)("base"),g=(0,F.useRef)(null),v=(0,F.useRef)(null),j=(0,F.useMemo)(()=>l||s||n,[l,s,n]),y=(0,F.useMemo)(()=>!s&&!n&&!l&&!!r.trim(),[s,r,l,n]);(0,F.useEffect)(()=>{if(!j&&v.current){let e=setTimeout(()=>{var e;null==(e=v.current)||e.focus()},50);return()=>clearTimeout(e)}},[j]);let b=(0,F.useCallback)(e=>{var t;e.preventDefault(),!j&&r.trim()&&(c(r),null==(t=v.current)||t.focus())},[c,j,r]),w=(0,F.useCallback)(e=>{if(e.stopPropagation(),"Enter"===e.key&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey&&!e.nativeEvent.isComposing){var t;e.preventDefault(),null==(t=g.current)||t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}},[]);return(0,a.jsxs)("form",{className:(0,h.cn)("w-full rounded-[32px] p-3 bg-surface-l2 shadow shadow-input-border/10 flex gap-2 pl-5 items-end ring-1 ring-input-border ring-inset"),onSubmit:b,ref:g,children:[(0,a.jsx)(x.N,{children:j&&(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1,transition:{duration:.1}},className:"pb-1.5 -ml-0.5",children:(0,a.jsx)(tO.d,{})},"loading-indicator")}),(0,a.jsx)(tF.A,{ref:v,className:(0,h.cn)("w-full @[480px]/input:px-3 bg-transparent focus:outline-none text-primary align-bottom resize-none pb-1.5 transition-all outline-transparent",j&&"animate-pulse"),onChange:e=>o(e.target.value),value:j?"":r,placeholder:j?m("image-editor.generating","Generating"):t?m("image-editor.describe-edits","Describe your edits"):m("image-editor.describe-image","Describe the image you want"),minRows:1,onKeyDown:w,disabled:j,name:"query",maxRows:5}),(0,a.jsx)("div",{className:(0,h.cn)("ml-auto flex flex-row items-end gap-1"),children:j?(0,a.jsx)(f.P.button,{whileTap:{scale:.95},initial:{scale:.95,opacity:1},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:.5,transition:{duration:.2}},className:(0,h.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),disabled:i,onClick:e=>{e.preventDefault(),u()},children:(0,a.jsx)("div",{className:(0,h.cn)("h-9","aspect-square flex flex-col items-center justify-center rounded-full","rounded-full ring-1 ring-inset","bg-primary text-background ring-button-outline-border"),children:(0,a.jsx)(d.M6A,{size:20})})}):(0,a.jsx)(f.P.button,{initial:{opacity:.5},animate:{opacity:1,transition:{duration:.1}},whileHover:t?{scale:1.1}:void 0,whileTap:t?{scale:.95}:void 0,className:(0,h.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),type:"submit","aria-label":m("image-editor.submit","Submit"),disabled:!y,children:(0,a.jsx)("div",{className:(0,h.cn)("h-9 relative","aspect-square flex flex-col items-center justify-center","rounded-full ring-1 ring-inset duration-100","before:absolute before:inset-0 before:rounded-full before:bg-primary before:ring-0 before:transition-all duration-500",y?"bg-primary text-background ring-transparent before: before:[clip-path:circle(50%_at_50%_50%)]":"bg-button-secondary text-secondary before:[clip-path:circle(0%_at_50%_50%)] ring-0"),children:(0,a.jsx)(d.Kpk,{size:20,className:"relative"})})})})]})},tU=e=>{let{images:t,selectedImage:s,title:l,inputValue:n,queryBarPosition:i="bottom",onInputValueChange:r,hideHeader:o=!1,hideQueryBar:c=!1,isAborting:d=!1,isSending:u=!1,isStreaming:m=!1,isWaitingForResponse:f=!1,onImageSelect:x,onSendQuery:g,onRegenerate:v,onAbort:j,onImageUpload:y,onClose:b}=e,{t:w}=(0,p.Bd)("base"),[k,N]=(0,tb.M)("image-editor-first-open",!0),[I,C]=(0,F.useState)(!1),[E,_]=(0,F.useState)(!1),[z,P]=(0,F.useState)(!1),A=(0,F.useMemo)(()=>(0,a.jsx)(tN,{selectedImage:s,isPeekingParent:I,setIsPeekingParent:C,isParentImageLoaded:E,isFinalImageLoaded:z,setIsFinalImageLoaded:P,setIsParentImageLoaded:_}),[s,I,E,z]),M=(0,F.useMemo)(()=>"center"===i&&!m&&!s&&!f&&!c,[i,m,s,f,c]);return(0,F.useEffect)(()=>{if(null==s?void 0:s.url){P(!1);let e=new Image;e.onload=()=>P(!0),e.src=s.url}},[null==s?void 0:s.url]),(0,F.useEffect)(()=>{if(null==s?void 0:s.parentImageUrl){_(!1);let e=new Image;e.onload=()=>_(!0),e.src=null==s?void 0:s.parentImageUrl}},[null==s?void 0:s.parentImageUrl]),(0,F.useEffect)(()=>{k&&(N(!1),S.oR.message((0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-fg-primary font-bold",children:w("image-editor-welcome.title","Welcome to Image Editor")}),(0,a.jsx)("p",{className:"text-fg-secondary",children:w("image-editor-welcome.description","A focused space for you to transform images with Grok to anything you can imagine.")})]}),{duration:7e3}))},[k,N,w]),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-between w-full h-full relative @container",children:[(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col gap-8 w-full mb-6 sm:mb-10",{"sm:mb-0":o&&!s}),children:[!o&&(0,a.jsx)(tP,{selectedImage:s,title:l,isSending:u,onRegenerate:v||(()=>{}),onClose:b}),s&&t.length>1&&(0,a.jsxs)("div",{className:"w-full h-[88px] @lg:h-auto relative @lg:absolute @lg:w-auto @lg:right-0 @lg:bottom-0 @lg:top-14 grid place-items-center @lg:mx-0",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 -right-3 bg-gradient-to-l w-8 @lg:bottom-auto @lg:right-0 @lg:left-0 @lg:w-full @lg:-top-3 @lg:h-8 @lg:bg-gradient-to-b from-surface-l1 via-surface-l1 dark:from-surface-inset dark:via-surface-inset to-transparent z-40"}),(0,a.jsx)("div",{className:"absolute inset-y-0 -left-3 bg-gradient-to-r w-8 @lg:top-auto  @lg:right-0 @lg:left-0 @lg:w-full @lg:-bottom-3 @lg:h-8 @lg:bg-gradient-to-t from-surface-l1 via-surface-l1 dark:from-surface-inset dark:via-surface-inset to-transparent z-40"}),t.length>1&&(0,a.jsx)(tA,{images:t,selectedImageId:s.id,onSelect:x||(()=>{})})]})]}),f||m&&!s?(0,a.jsx)(tk.$,{}):s?A:(0,a.jsx)("div",{className:"w-full h-full max-w-7xl",children:(0,a.jsx)(tS,{onUploadImage:y||(()=>{}),children:M&&(0,a.jsx)("div",{className:"w-full max-w-xl",children:(0,a.jsx)(tG,{selectedImage:s,isWaitingForResponse:f,isStreaming:m,isSending:u,isAborting:d,inputValue:n||"",onInputValueChange:r||(()=>{}),onSend:g||(()=>{}),onAbort:j||(()=>{})})})})}),!M&&(0,a.jsx)("footer",{className:"relative w-full max-w-2xl h-16 flex-shrink-0 mt-12 sm:mt-20",children:(0,a.jsxs)("div",{className:"absolute bottom-0 inset-x-0 flex flex-col gap-4",children:[!!s&&(0,a.jsx)(tB,{isStreaming:m,isSending:u,selectedImage:s,onSend:g||(()=>{})}),!c&&(0,a.jsx)(tG,{selectedImage:s,isWaitingForResponse:f,isSending:u,isStreaming:m,isAborting:d,inputValue:n||"",onInputValueChange:r||(()=>{}),onSend:g||(()=>{}),onAbort:j||(()=>{})})]})})]})};var tq=s(35501);let tW=()=>{let{push:e}=(0,L.wK)(),{t}=(0,p.Bd)("base"),{ASSET_SERVER_URL:s}=(0,tj.v)(),l=(0,Q.h)(),i=(0,y._)(),r=(0,eS.R)(e=>e.loadRecent),o=(0,n.aP)(C.A("streamedMessageId")),c=(0,n.aP)(C.A("setConversationId")),u=(0,n.aP)(C.A("setStreamedMessageId")),m=(0,tp.A3)(C.A("byId")),h=(0,tp.A3)(e=>e.byId[null!=o?o:""]),[f,x]=(0,F.useState)(!1),[g,v]=(0,F.useState)(!1),[j,b]=(0,F.useState)(""),[w,k]=(0,F.useState)([]),[N,I]=(0,F.useState)(null),[E,_]=(0,F.useState)(!1),[z,P]=(0,F.useState)(!1),[A,M]=(0,F.useState)(!1),D=(0,F.useMemo)(()=>w.find(e=>e.id===N)||null,[w,N]),R=(0,F.useCallback)(e=>{let a=tp.A3.getState().byId[e.parentResponseId||""],l="streaming"===e.state;return Object.entries(e.streamingImageById||{}).map(n=>{let[i,r]=n,o=Object.keys(r).map(Number),c=r[Math.max(...o)];return{id:i,url:(0,tx.sU)(s,null==c?void 0:c.imageUrl),state:l?"streaming":"completed",isModerated:!1,title:(null==a?void 0:a.imageEditUri)?t("image-editor.edited-image","Edited image"):t("image-editor.generated-image","Generated image"),description:null==a?void 0:a.message,regenResponseId:null==a?void 0:a.responseId,progressMap:l?o.map(e=>{var t;return{progress:e/100,imageUrl:(0,tx.sU)(s,null==(t=r[e])?void 0:t.imageUrl)}}):void 0,generatedImageWidth:l?e.generatedImageWidth:void 0,generatedImageHeight:l?e.generatedImageHeight:void 0}})},[s,t]),T=(0,F.useCallback)(e=>{e.length&&k(t=>{if(t.find(e=>e.id.includes("optimistic-streaming-image"))){let a=t.filter(e=>!e.id.includes("optimistic-streaming-image")).concat(e);if(!a.some(e=>e.id===N)){var s;I((null==(s=a[a.length-1])?void 0:s.id)||null)}return a}{let s=t.map(t=>e.find(e=>e.id===t.id)||t),a=e.filter(e=>!s.some(t=>t.id===e.id));return[...s,...a]}})},[k,N]),B=(0,F.useCallback)(t=>{var s;let{image:a,type:l}=t;return"upload"===l?i("image_editor_upload",void 0,{location:"empty-image-workbench"}):"draw"===l&&i("image_editor_draw",void 0,{location:"empty-image-workbench"}),e({page:"files",fileId:null!=(s=a.fileMetadataId)?s:null,emptyView:"default"}),r()},[e,r,i]),O=(0,F.useCallback)(()=>{e({page:"files",fileId:null,emptyView:"default"})},[e]),G=(0,F.useCallback)(e=>{let t=tg.C$.getState(),s=n.aP.getState();"none"!==s.reasoningMode&&s.setReasoningMode("none");let a={message:e,toolOverrides:{imageGen:!0},enableRetries:l.ENABLE_AUTO_STREAM_RETRY};return i("image_editor_generate",void 0,{location:"empty-image-workbench",message:e,messageLength:String(e.length)}),x(!0),P(!1),M(!0),b(""),s.establishNewConversation({...a,temporary:t.isIncognito,disableToolComposer:!0,toolOverrides:{imageGen:!0},ff:l})},[l,b,i]),U=(0,F.useCallback)(async e=>(v(!0),e().then(()=>{c(void 0),u(void 0),x(!1),k([]),I(null),_(!1)}).finally(()=>{v(!1)})),[c,u]),q=(0,tf.m)("empty-image-workbench:handleAbort",U),W=(0,F.useCallback)(()=>{A&&(M(!1),S.oR.error(t("image-editor.failed-to-generate","Failed to generate image"))),c(void 0),x(!1),v(!1),k([]),I(null),_(!1)},[t,c,A]);return(0,F.useEffect)(()=>{if(!z)if(h&&"streaming"===h.state){let e=R(h);if(!h.imageAttachmentCount||e.length||E)(null==e?void 0:e.length)&&(T(e),x(!1));else{let e=Array.from({length:h.imageAttachmentCount}).map((e,s)=>({id:"optimistic-streaming-image-".concat(s),url:"",state:"streaming",isModerated:!1,title:t("image-editor.generated-image","Generated image"),description:h.message,progressMap:[],generatedImageWidth:h.generatedImageWidth,generatedImageHeight:h.generatedImageHeight}));k(t=>[...t,...e]),e[0]&&I(e[0].id),_(!0)}}else if(h&&("error"===h.state||h.error))W();else{_(!1);let t=[];if(h&&"closed"===h.state){var s,a,l,n,i;t=R(h);let o=null==(n=h.streamingImageById)||null==(a=n[null!=(i=null==(l=Object.keys(h.streamingImageById||{}))?void 0:l[0])?i:""])||null==(s=a[100])?void 0:s.assetId;t.length>0&&!z&&o&&(P(!0),r().then(()=>(c(void 0),u(void 0),e({page:"files",fileId:o}))).catch(W))}T(t)}},[h,R,T,k,t,f,E,N,m,z,W,e,r,c,u]),(0,a.jsx)(tv.YZ,{direction:"horizontal",autoSaveId:"workbench",className:"bg-surface-l1 dark:bg-surface-inset",children:(0,a.jsx)(tv.Zk,{order:1,minSize:50,defaultSize:100,className:"flex flex-col max-h-[100vh] h-[100vh]",children:(0,a.jsxs)("div",{className:"flex flex-col h-full max-h-full",children:[(0,a.jsx)("div",{className:"h-12 min-h-12 flex items-center justify-end px-4",children:(0,a.jsx)(eL.$n,{"aria-label":t("image-editor.close","Close Image Editor"),shape:"square",variant:"tertiary",size:"sm",onClick:O,children:(0,a.jsx)(d.uv5,{className:"size-5"})})}),(0,a.jsx)("div",{className:"flex-1 relative overflow-hidden",children:(0,a.jsx)("div",{className:"w-full max-w-full relative h-full max-h-full",children:(0,a.jsx)(ty.t,{fallbackRender:()=>(0,a.jsx)(tq.f,{}),children:(0,a.jsx)("div",{className:"flex flex-col h-full max-h-full p-2 lg:p-6 pt-8 w-full bg-surface-l1 dark:bg-surface-inset",children:(0,a.jsx)(tU,{queryBarPosition:"center",isStreaming:!!h&&"streaming"===h.state,selectedImage:D,images:w,isWaitingForResponse:f,isAborting:g,inputValue:j,hideHeader:!0,onImageSelect:e=>I(e.id),onInputValueChange:b,onSendQuery:G,onImageUpload:B,onAbort:q,onClose:O})})})})})]})})})};var tK=s(15665),tV=s(77204),t$=s(97225),tH=s(1729),tY=s(52542),tQ=s(56),tX=s(61079),tJ=s(26676),tZ=s(7658),t0=s(3683);function t1(e){let{asset:t,size:s="sm"}=e,{t:l}=(0,p.Bd)("files"),n=(0,t0.M)(e=>e.listStatus),i=(0,t0.M)(e=>e.loadFirstPage);(0,F.useEffect)(()=>{"ready"!==n&&i()},[n,i]);let r=(0,t0._)(),{add:o}=(0,tX.O)(),c=(0,F.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o().catch((0,w.HX)("add-to-workspace-button:create-workspace"))},[o]);return(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsx)(eL.gx,{variant:"tertiary",shape:"square",size:s,tooltipContent:l("add-to-project-button.tooltip","Add to Project"),children:(0,a.jsx)(d.XRf,{size:18})})}),(0,a.jsxs)(e_.SQ,{className:"w-[250px] p-2 rounded-3xl flex flex-col gap-0.5",sideOffset:0,children:[!(null==r?void 0:r.length)&&(0,a.jsx)(tQ.C,{content:l("No projects yet","No projects yet"),ctaText:l("Create Project","Create Project"),onClickCta:c},"no-workspaces"),r.length&&(0,a.jsx)("div",{className:(0,h.cn)("py-1 pl-2 text-sm text-secondary font-semibold sticky top-0"),children:l("add-to-project-menu-item","Add to Project")}),r.map(e=>(0,a.jsx)(t2,{workspaceId:e.workspaceId,asset:t},e.workspaceId))]})]},"add-to-workspace-button")}function t2(e){var t;let{workspaceId:s,asset:l}=e,n=(0,y._)(),i=(0,t0.M)(e=>{var t;return null==(t=e.byId[s])?void 0:t.data}),{mutate:r,error:o}=(0,tZ.mT)(s);(0,b.Y)("attach-dropdown:attachAsset",o);let{data:c}=(0,tZ.UL)(s),d=null==c||null==(t=c.assets)?void 0:t.some(e=>e.assetId===l.assetId),u=(0,F.useCallback)(e=>{l.assetId&&(r({assetId:l.assetId}),n("add_to_workspace",void 0,{location:"add-to-workspace-button",workspaceId:s,assetId:l.assetId}))},[r,l,n,s]);return(0,a.jsxs)(eL.$n,{className:(0,h.cn)(t$.mI,"rounded-2xl"),variant:"tertiary",size:"md",shape:"rectangle",onClick:u,disabled:d,children:[(0,a.jsx)(tJ.n,{icon:null==i?void 0:i.icon,sizeClass:"size-4",rounded:!0,buttonSize:"iconXs",disabled:!0}),(0,a.jsx)("span",{className:(0,h.cn)("flex-1 select-none text-nowrap max-w-full overflow-hidden text-left"),style:{maskImage:J.uU,WebkitMaskImage:J.uU},children:null==i?void 0:i.name})]})}var t5=s(50672),t4=s(42143),t3=s(48756),t6=s(93875),t8=s(62454),t9=s(30964),t7=s(87549),se=s(52371);function st(e){let{mode:t,setMode:s}=e,{t:l}=(0,p.Bd)("chat");return(0,a.jsx)(se.tU,{className:"flex-1 flex-row justify-start flex no-a11y-check",defaultValue:"code",value:t,onValueChange:e=>s(e),children:(0,a.jsxs)(se.j7,{children:[(0,a.jsxs)(se.Xi,{className:"gap-1",value:"code","aria-label":l("Code","Code"),children:[(0,a.jsx)(d.CyN,{className:"size-4"}),(0,a.jsx)("span",{className:"hidden md:inline",children:l("Code","Code")})]}),(0,a.jsx)(se.Xi,{className:"gap-1",value:"preview","aria-label":l("Preview","Preview"),children:(0,a.jsx)("span",{className:"hidden md:inline",children:l("Preview","Preview")})})]})})}var ss=s(69580);let sa=e=>{let{mimetype:t,content:s}=e;if("text/html"===t)return(0,a.jsx)(ss.Z,{srcDoc:s,autofocus:!0})};var sl=s(8800);let sn=e=>{let{code:t,mimetype:s,consoleRef:a}=e,l=(0,F.useRef)([]),{t:n}=(0,p.Bd)(["chat"]),i=n("code-execution.done","Done"),r=(0,tH.I5)(s),{runCode:o,loading:c,result:d,codeExecutionAvailable:u}=(0,sl.P)(t,r);(0,F.useEffect)(()=>{var e;null==(e=a.current)||e.reset()},[a,t]);let m=(0,F.useCallback)(()=>{var e;null==(e=a.current)||e.reset(),l.current=[],o()},[a,o]);return(0,F.useEffect)(()=>{var e,t,s,n,r,o,c,u;if(!d)return;let{stdout:m,stderr:h,outputFiles:f,success:x}=d;m&&!l.current.includes(m)&&(null==(e=a.current)||e.open(),l.current.push(m),null==(t=a.current)||t.addMessage({type:"log",message:m})),h&&!l.current.includes(h)&&(null==(s=a.current)||s.open(),l.current.push(h),null==(n=a.current)||n.addMessage({type:"error",message:h,disableFixButton:!0}));let p=Object.values(f).join(",");f&&Object.values(f).length>0&&!l.current.includes(p)&&(null==(r=a.current)||r.open(),l.current.push(p),null==(o=a.current)||o.addMessage({type:"log",files:f})),x&&!l.current.includes(i)&&0===l.current.length&&(null==(c=a.current)||c.open(),l.current.push(i),null==(u=a.current)||u.addMessage({type:"system",message:i}))},[a,d,i]),{runCode:m,isCodeRunning:c,codeExecutionResult:d,isCodeExecutionAvailable:u()}},si=e=>{let{mimetype:t,isCodeExecutionAvailable:s}=e;return s?"run":["text/html"].includes(t)?"preview":"none"},sr={size:18,strokeWidth:2};var so=s(87853),sc=s(21578),sd=s(66408),su=s(14990);function sm(e){return null!=e}var sh=s(4357),sf=s(57137),sx=s(48085);let sp={size:18,strokeWidth:2};var sg=s(1451);s(23332);var sv=s(58192),sj=s(36889),sy=s(52265);let sb=e=>{let{file:t,content:s}=e,a=(0,y._)(),{ASSET_SERVER_URL:l}=(0,tj.v)(),n=(0,tx.sU)(l,t.fileUri);return{handleDownload:(0,F.useCallback)(()=>{if(n||s)if(a("file_content_download_click","",{location:"spreadsheet-workbench:useFileActions:handleDownload",contentType:t.fileMimeType}),s){let e=new Blob([s],{type:t.fileMimeType});(0,sy.W)(e,t.fileName)}else n&&(0,sy.z)(n,t.fileName)},[a,n,s,t.fileName,t.fileMimeType])}},sw={size:18,strokeWidth:2};var sk=s(61884),sN=s(47934);function sI(e){let{asset:t}=e,s=(0,eN.B)(t),{t:l}=(0,p.Bd)("files"),{ASSET_SERVER_URL:n}=(0,tj.v)(),i=(0,y._)(),r=(0,F.useCallback)(()=>{var e,s,a,l,r;i("file_content_download_click",void 0,{location:"unknown-workbench",contentType:null!=(s=t.mimeType)?s:"unknown",assetId:null!=(a=t.assetId)?a:"",assetName:null!=(l=t.name)?l:"",assetSize:null!=(r=null==(e=t.sizeBytes)?void 0:e.toString())?r:""});let o=(0,tx.sU)(n,t.key);if(!o)return;let c=document.createElement("a");c.href=o,c.download="file",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)},[i,n,t]),o=l("read-only-indicator-tooltip","Grok can't edit this type of file but can still answer questions about it");return(0,a.jsx)(t9.U,{editor:(0,a.jsx)(sc.H,{hideEdit:!0,fileMetadata:s,onClose:()=>{},className:"border-none shadow-none max-w-none"}),assetId:t.assetId,conversationId:t.currentConversationId,editorHeader:(0,a.jsx)(t4.F,{asset:t}),headerButtons:[(0,a.jsx)(m.gx,{tooltipContent:l("Download to file","Download to file"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:r,rounded:!0,variant:"ghost",size:"iconSm","aria-label":l("Download to file","Download to file"),children:(0,a.jsx)(d.s3U,{strokeWidth:2,size:18})},"download-button")],chat:(0,a.jsx)(sN.s,{asset:t}),chatHeader:(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("div",{className:"text-secondary",children:l("files-tab-conversation-header","File Chat")}),(0,a.jsxs)(sk.m_,{children:[(0,a.jsx)(sk.k$,{asChild:!0,children:(0,a.jsx)("span",{"aria-label":o,children:(0,a.jsx)(d.hED,{className:"w-4 h-4"})})}),(0,a.jsx)(sk.ZI,{children:o})]})]})})}let sC={markdown:function(e){var t;let{asset:s}=e,l=(0,Q.h)(),{t:n}=(0,p.Bd)("files"),[i,r]=(0,F.useState)(!1),{content:o,setContent:c,error:u,isEditing:m,refetch:f}=(0,t5.W)(s,i),{handleCopy:x,copyPressed:g,handleDownload:v,shareLoading:j,handleShare:y,sharePressed:b}=(0,t6.H)({assetId:s.assetId,content:null!=o?o:"",filename:null!=(t=s.name)?t:"file"}),{activeArtifact:w,isEditing:k,onSetActiveArtifact:N}=(0,t8.a)({content:null!=o?o:void 0});(0,F.useEffect)(()=>{r(k)},[k]);let I=(0,sf.l)({content:o,isEditable:!0,onUpdate:c});return null==o?(0,a.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,a.jsx)(e9.E,{className:"w-[30%] h-6"}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)(e9.E,{className:"w-24 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4 w-full h-full justify-center items-center py-[10%]",children:(0,a.jsxs)("div",{className:"flex flex-col h-full w-full max-w-3xl gap-2",children:[(0,a.jsx)(e9.E,{className:"w-full max-w-xl mb-2 h-8"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-6"}),(0,a.jsx)(e9.E,{className:"w-full max-w-sm h-6"})]})})]}):u?(0,a.jsx)(tq.f,{onRetryRequested:f}):(0,a.jsx)(t9.U,{editor:(0,a.jsxs)("div",{className:(0,h.cn)("no-a11y-check h-full overflow-auto max-w-full relative prose bg-surface-l1 dark:bg-surface-inset","\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:text-primary/20\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:text-3xl\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:font-bold\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:content-[attr(data-placeholder)]\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:float-left\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:h-0\n  [&_.tiptap_h1.is-editor-empty:first-child::before]:pointer-events-none\n"),children:[I&&null!==o?(0,a.jsx)(sh.n,{editor:I,content:o,editable:!m,className:"max-w-3xl h-full justify-self-center"}):null,m?(0,a.jsx)("div",{className:"sticky overflow-visible bottom-4 start-0 w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-primary bg-surface-l1 px-4 py-2 rounded-full h-10 border border-border",children:[(0,a.jsx)(H.y,{size:"sm"}),(0,a.jsx)("span",{children:n("files.editing-by-model","Editing...")})]})}):null]}),assetId:s.assetId,conversationId:s.currentConversationId,editorHeader:(0,a.jsx)(t4.F,{asset:s}),editorSubheader:I?(0,a.jsx)(sx.n,{editable:!0,editor:I}):null,headerButtons:[(0,a.jsx)(eL.gx,{tooltipContent:n("Copy Contents","Copy Contents"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:x,shape:"square",variant:"tertiary",size:"sm","aria-label":n("Copy Contents","Copy Contents"),children:(0,a.jsx)(tz.p,{children:g?(0,a.jsx)(d.Srz,{size:18}):(0,a.jsx)(d.TdU,{size:18})},g?"copied":"copy")},"copy-button"),(0,a.jsx)(eL.gx,{tooltipContent:n("Download to file","Download to file"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:v,shape:"square",variant:"tertiary",size:"sm","aria-label":n("Download to file","Download to file"),children:(0,a.jsx)(d.KXi,{...sp,size:18})},"download-button"),l.ENABLE_FILE_SHARING?(0,a.jsx)(eL.gx,{tooltipContent:n("Share file","Share file"),onClick:y,tooltipContentProps:{className:"text-xs"},shape:"square",variant:"tertiary",size:"sm","aria-label":n("Share file","Share file"),children:(0,a.jsx)(tz.p,{children:j?(0,a.jsx)(H.y,{size:"xs"}):b?(0,a.jsx)(d.Srz,{size:18}):(0,a.jsx)(d.liv,{...sp,size:18})},j?"share-loading":b?"shared":"share")},"share-button"):null],chat:(0,a.jsx)(t3.s,{asset:s,activeArtifact:w,onArtifactSelected:N})})},csv:so.s1,spreadsheet:function(e){var t;let{asset:s}=e,{t:l}=(0,p.Bd)("files"),n=(0,Q.h)(),i=(0,eN.B)(s),{ASSET_SERVER_URL:r}=(0,tj.v)(),o=(0,eS.R)(e=>e.setAssetContent),c=(0,eS.fh)(null!=(t=s.assetId)?t:"","binary"),u=(0,eS.R)(e=>e.fetchBinaryContent);(0,F.useEffect)(()=>{null==c&&s.assetId&&u(s.assetId,r)},[r,s.assetId,c,u]);let m=(0,F.useCallback)(e=>{var t;o(null!=(t=s.assetId)?t:"",e)},[s.assetId,o]),{handleDownload:h}=sb({file:i,content:c});if(!s.assetId)return(0,a.jsx)(tq.f,{});let f=s.rootAssetId||s.assetId;return(0,a.jsx)(t9.U,{editor:(0,a.jsx)("div",{className:"flex flex-col h-full overflow-hidden",children:(0,a.jsx)(sj.bs,{id:f,initialState:{name:s.name||"Workbook"},content:c,readOnly:!n.ENABLE_XLSX_EDITING,children:void 0!==c?(0,a.jsx)(sg.y,{readOnly:!n.ENABLE_XLSX_EDITING,onContentUpdate:m,className:"border-t border-border-l1",autoFocus:!0}):null},f)}),assetId:s.assetId,conversationId:s.currentConversationId,editorHeader:(0,a.jsx)(t4.F,{asset:s}),headerButtons:[(0,a.jsx)(eL.gx,{tooltipContent:l("Download to file","Download to file"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:h,shape:"square",variant:"tertiary",size:"sm","aria-label":l("Download to file","Download to file"),disabled:!c,children:(0,a.jsx)(d.s3U,{...sw,size:18})},"download-button")],chat:(0,a.jsx)(t3.s,{asset:s,restrictedModel:sv.E8})})},image:function(e){let{asset:t}=e,{t:s}=(0,p.Bd)("base"),{ASSET_SERVER_URL:l}=(0,tj.v)(),i=(0,Q.h)(),[r]=(0,tb.M)("files-tab-is-chat-open",!0),o=(0,y._)(),{handleEditorOpen:c,consumeEditorTimeMs:u}=(0,sd.Q)(),{editImagePresets:m}=(0,tM.F)(),h=(0,eS.R)(e=>e.loadRecent),g=(0,eS.R)((0,e$.k)(e=>e.assetsById)),v=(0,eS.R)((0,e$.k)(e=>e.listStatus)),j=(0,tp.A3)(C.A("byId")),b=(0,n.aP)(C.A("conversationId")),k=(0,n.aP)(C.A("streamedMessageId")),N=(0,n.aP)(C.A("queryByConversationId")),I=(0,n.aP)(C.A("idsetQueryByConversationId")),[S,E]=(0,F.useState)(!1),[_,z]=(0,F.useState)(!1),[P,A]=(0,F.useState)(!1),[M,D]=(0,F.useState)(!1),[R,T]=(0,F.useState)(null),[B,L]=(0,F.useState)(null),[O,G]=(0,F.useState)([]),[U,q]=(0,F.useState)(null),[W,K]=(0,F.useState)(null),V=(0,F.useRef)(null),$=(0,F.useMemo)(()=>(0,eN.B)(t),[t]),Y=(0,F.useMemo)(()=>{if(!t.currentConversationId)return[];let e=[];return Object.values(g).map(e=>null==e?void 0:e.data).filter(sm).forEach(s=>{var a;(null==(a=s.mimeType)?void 0:a.startsWith("image/"))&&s.sourceConversationId===t.currentConversationId&&e.push(s)}),e.sort((e,t)=>new Date(e.createTime||"").getTime()-new Date(t.createTime||"").getTime())},[t,g]),X=b||"no_conversation_id",J=N[X],Z=(0,F.useCallback)(e=>I(e,X),[X,I]),ee=(0,F.useMemo)(()=>O.find(e=>e.id===B)||null,[O,B]),et=(0,F.useMemo)(()=>{let e=Y.find(e=>e.assetId===R);return e||t},[t,R,Y]),es=(0,tp.A3)(e=>e.byId[null!=k?k:""]),ea=(0,F.useCallback)(e=>{let t="streaming"===e.state;return Object.entries(e.streamingImageById||{}).map(s=>{let[a,n]=s,i=Object.keys(n).map(Number),r=n[Math.max(...i)];return{id:a,url:(0,tx.sU)(l,null==r?void 0:r.imageUrl),state:t?"streaming":"completed",isModerated:!1,responseId:e.responseId,progressMap:t?i.map(e=>{var t;return{progress:e/100,imageUrl:(0,tx.sU)(l,null==(t=n[e])?void 0:t.imageUrl)}}):void 0,generatedImageWidth:t?e.generatedImageWidth:void 0,generatedImageHeight:t?e.generatedImageHeight:void 0}})},[l]),el=(0,F.useCallback)(e=>{e.length&&G(t=>{if(t.find(e=>e.id.includes("optimistic-streaming-image"))){let a=t.filter(e=>!e.id.includes("optimistic-streaming-image")).concat(e);if(!a.some(e=>e.id===B)){var s;L((null==(s=a[a.length-1])?void 0:s.id)||null)}return a}{let s=t.map(t=>e.find(e=>e.id===t.id)||t),a=e.filter(e=>!s.some(t=>t.id===e.id));return[...s,...a]}})},[G,B]),en=(0,F.useCallback)(e=>{if(!ee)return;let t=tp.A3.getState(),s=tg.C$.getState(),a=n.aP.getState(),l=a.lastMessageId?t.byId[a.lastMessageId]:void 0;if(a.lastMessageId&&!l)throw Error("Last message is missing");"none"!==a.reasoningMode&&a.setReasoningMode("none");let r={message:e,toolOverrides:{imageGen:!0},imageEditUri:ee.url?ee.url.replace(/^https?:\/\/[^/]+\/?/,""):void 0,enableRetries:i.ENABLE_AUTO_STREAM_RETRY};if(ee.url){let t=m.flatMap(e=>e.presets).find(t=>t.prompt===e);o("edit_image_start",(0,sd.r)(ee.url),{queryType:t?"preset":"manual",location:"image-workbench",presetId:(null==t?void 0:t.presetId)||"",message:e,messageLength:String(e.length)})}return z(!0),Z(""),a.conversationId?a.sendResponse({...r,parentResponseId:a.lastMessageId,conversationId:a.conversationId,webpageUrls:[],setOpimisticUserResponse:!0,setUserResponse:!0,disableToolComposer:!0,isFromGrokFiles:!0,fileAttachmentIds:[et.assetId],ff:i}):a.establishNewConversation({...r,temporary:s.isIncognito,disableToolComposer:!0,isFromGrokFiles:!0,fileAttachmentIds:[et.assetId],ff:i})},[ee,i,Z,et.assetId,o,m]),ei=(0,F.useCallback)(async e=>(A(!0),e().finally(()=>{A(!1)})),[]),er=(0,tf.m)("image-workbench:handleAbort",ei),eo=(0,F.useCallback)(()=>{var e;!S&&(null==ee?void 0:ee.url)&&(E(!0),(0,t_.G)(ee.url,null==(e=ee.url)?void 0:e.split("/").pop()).catch((0,w.HX)("image-editor:handleDownload")).finally(()=>E(!1)))},[S,ee]),ec=(0,F.useCallback)(()=>{V.current&&i.ENABLE_IMAGE_EDITOR_IN_FILES&&(o("image_editor_close",void 0,{timeInEditorMs:String(u()),location:"image-workbench"}),V.current=null)},[u,o,i.ENABLE_IMAGE_EDITOR_IN_FILES]);(0,F.useEffect)(()=>{if(es&&"streaming"===es.state&&es.conversationId===b){let e=ea(es);if(!es.imageAttachmentCount||e.length||M)(null==e?void 0:e.length)&&(el(e),z(!1));else{let e=Array.from({length:es.imageAttachmentCount}).map((e,t)=>({id:"optimistic-streaming-image-".concat(t),url:"",state:"streaming",isModerated:!1,responseId:es.responseId,progressMap:[],generatedImageWidth:es.generatedImageWidth,generatedImageHeight:es.generatedImageHeight}));G(t=>[...t,...e]),e[0]&&L(e[0].id),D(!0)}}else{z(!1),D(!1);let e=[];es&&"closed"===es.state&&!es.error&&es.conversationId===b&&(e=ea(es),U!==es.responseId&&(q(es.responseId),h().catch((0,w.HX)("image-editor:loadRecent")))),es&&("error"===es.state||es.error)||!es?G(e=>{if(!e.find(e=>e.id.includes("optimistic-streaming-image")))return e;{let s=e.filter(e=>!e.id.includes("optimistic-streaming-image"));if(!s.some(e=>e.id===B)){var t;L((null==(t=s[s.length-1])?void 0:t.id)||null)}return s}}):el(e)}},[es,ea,el,G,s,_,M,j,B,h,U,t.assetId,Y,b]);let ed=(0,F.useCallback)(async()=>{let e=tp.A3.getState();if(t.currentConversationId){let s=[null==t?void 0:t.responseId,...Y.map(e=>null==e?void 0:e.responseId)].filter(su.A(String)),a=await e.loadResponses(t.currentConversationId,s),n=a.find(e=>(null==e?void 0:e.responseId)===(null==t?void 0:t.responseId)),i=n?e.byId[n.parentResponseId||""]:void 0,r=(0,eN.B)(t);return[{id:t.assetId||"",state:"completed",isModerated:!1,url:(0,tx.sU)(l,r.fileUri||""),responseId:t.responseId,parentImageUrl:(null==i?void 0:i.imageEditUri)?(0,tx.sU)(l,i.imageEditUri):void 0},...Y.sort((e,t)=>new Date(e.createTime||"").getTime()-new Date(t.createTime||"").getTime()).map(e=>{let t=(0,eN.B)(e),s=a.find(t=>(null==t?void 0:t.responseId)===(null==e?void 0:e.responseId)),n=s?a.find(e=>(null==e?void 0:e.responseId)===(null==s?void 0:s.parentResponseId)):void 0;return{id:e.assetId||"",state:"completed",isModerated:!1,url:(0,tx.sU)(l,t.fileUri||""),responseId:e.responseId,parentImageUrl:(null==n?void 0:n.imageEditUri)?(0,tx.sU)(l,n.imageEditUri):void 0}})]}if(t.sourceConversationId){let s=[null==t?void 0:t.responseId].filter(su.A(String)),a=await e.loadResponses(t.sourceConversationId,s),n=(0,eN.B)(t),i=a.find(e=>(null==e?void 0:e.responseId)===(null==t?void 0:t.responseId)),r=i?a.find(e=>(null==e?void 0:e.responseId)===(null==i?void 0:i.parentResponseId)):void 0;return[{id:t.assetId||"",state:"completed",isModerated:!1,url:(0,tx.sU)(l,n.fileUri||""),responseId:t.responseId,parentImageUrl:(null==r?void 0:r.imageEditUri)?(0,tx.sU)(l,r.imageEditUri):void 0}]}{let e=(0,eN.B)(t);return[{id:t.assetId||"",state:"completed",isModerated:!1,url:(0,tx.sU)(l,e.fileUri||""),responseId:t.responseId}]}},[l,t,Y]),eu=(0,F.useCallback)(e=>{var t;if(O.some(t=>t.id===B&&t.responseId===e))return;let s=null==(t=O.find(t=>t.responseId===e))?void 0:t.id;s&&L(s)},[O,B]);return(0,F.useEffect)(()=>{t.assetId&&t.assetId!==W&&"ready"===v&&(V.current&&V.current!==t.assetId&&ec(),K(t.assetId),ed().then(e=>{G(e),L(t.assetId),q(null),D(!1),z(!1),A(!1),V.current=t.assetId,c(),i.ENABLE_IMAGE_EDITOR_IN_FILES&&o("image_editor_open",t.assetId,{location:"image-workbench"})}).catch((0,w.HX)("image-editor:getInitialImages")))},[t.assetId,v,W,ed,c,ec,o,i.ENABLE_IMAGE_EDITOR_IN_FILES]),(0,F.useEffect)(()=>{if(B&&B!==R){if(B===t.assetId||Y.some(e=>e.assetId===B))T(B);else if(null==ee?void 0:ee.responseId){var e,s,a;let t=j[(null==ee?void 0:ee.responseId)||""],l=null==t||null==(a=t.streamingImageById)||null==(s=a[B])||null==(e=s[100])?void 0:e.assetId;l&&T(l)}}},[B,R,t.assetId,Y,j,ee]),(0,F.useEffect)(()=>()=>{ec()},[ec]),i.ENABLE_IMAGE_EDITOR_IN_FILES?(0,a.jsx)(t9.U,{editor:(0,a.jsx)("div",{className:"flex flex-col h-full max-h-full p-2 lg:p-6 pt-8 w-full",children:(0,a.jsx)(tU,{hideHeader:!0,hideQueryBar:r,isStreaming:es&&"streaming"===es.state,selectedImage:ee,images:O,isWaitingForResponse:_||!ee,isAborting:P,inputValue:J,onInputValueChange:Z,onImageSelect:e=>L(e.id),onSendQuery:en,onAbort:er})}),assetId:t.assetId,disableClear:!0,conversationId:t.currentConversationId,editorHeader:(0,a.jsx)(x.N,{mode:"popLayout",children:(null==ee?void 0:ee.state)==="streaming"?(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:"text-lg font-semibold text-primary animate-pulse",children:s("image-editor.generating","Generating")},"streaming-title"):(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:"flex-grow",children:(0,a.jsx)(t4.F,{asset:et,className:"text-lg font-semibold text-primary truncate min-w-0 overflow-hidden"})},es&&"streaming"===es.state?B:et.assetId)}),headerButtons:[ee&&(0,a.jsx)(eL.gx,{shape:"square",variant:"tertiary",size:"sm","aria-label":s("image-editor.download-image","Download Image"),tooltipContent:s("image-editor.download-image","Download Image"),tooltipContentProps:{side:"bottom"},disabled:"streaming"===ee.state||!ee.url||S,onClick:eo,children:(0,a.jsx)(tz.p,{children:S?(0,a.jsx)(H.y,{size:"xs"}):(0,a.jsx)(d.KXi,{className:"size-5"})},S?"is-downloading":"download-icon")})],chat:(0,a.jsx)(t3.s,{asset:t,viewedAssetId:R||void 0,onResponseImagesOpen:eu,responseImagesView:"status-card"},t.assetId)}):(0,a.jsx)("div",{className:"flex flex-col max-h-[100vh] h-[100vh]",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-full bg-surface-base",children:(0,a.jsx)(sc.H,{hideEdit:!0,fileMetadata:$,onClose:()=>{},className:"border-none shadow-none max-w-none"})})})},code:function(e){var t,s,l;let{asset:n}=e,i=(0,Q.h)(),{t:r}=(0,p.Bd)("files"),o=(0,y._)(),[c,u]=(0,F.useState)(!1),{content:m,setContent:h,error:f,isEditing:x,refetch:g}=(0,t5.W)(n,c),v=(0,F.useRef)(null),j=(0,eN.B)(n),{activeArtifact:b,isEditing:w,onSetActiveArtifact:k}=(0,t8.a)({content:null!=m?m:void 0});(0,F.useEffect)(()=>{u(w)},[w]);let{runCode:N,isCodeRunning:I,isCodeExecutionAvailable:C}=sn({code:null!=m?m:"",mimetype:null!=(t=j.fileMimeType)?t:"",consoleRef:v}),S=(0,F.useCallback)(()=>{N(),o("files.workbench.run-code","",{location:"code-workbench:onRunCode"})},[N,o]),E=(0,F.useCallback)(e=>{h(null!=e?e:"")},[h]),_=si({content:null!=m?m:"",mimetype:j.fileMimeType,isCodeExecutionAvailable:C}),{handleCopy:z,copyPressed:P,handleDownload:A,handleShare:M,sharePressed:D,shareLoading:R}=(0,t6.H)({assetId:n.assetId,content:null!=m?m:"",filename:null!=(s=n.name)?s:"file"}),T=(0,tH.I5)(j.fileMimeType),[B,L]=(0,F.useState)("code"),O=(0,F.useCallback)(e=>{L(e),o("files.workbench.set-mode",e,{location:"code-workbench:onSetMode"})},[o]);return((0,F.useEffect)(()=>{L("code")},[n.assetId]),null==m)?(0,a.jsxs)("div",{className:"flex flex-col w-full h-full p-4",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,a.jsx)(e9.E,{className:"w-[30%] h-6"}),(0,a.jsxs)("div",{className:"flex gap-6 me-4",children:[(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"}),(0,a.jsx)(e9.E,{className:"w-6 h-6"})]})]}),(0,a.jsxs)("div",{className:"flex mt-6 flex-col h-full w-full max-w-3xl gap-3",children:[(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-2xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-3xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-xl h-5"}),(0,a.jsx)(e9.E,{className:"w-full max-w-sm h-5"})]})]}):f?(0,a.jsx)(tq.f,{onRetryRequested:g}):(0,a.jsx)(t9.U,{editor:"code"===B?(0,a.jsxs)("div",{className:"flex flex-col h-full overflow-hidden bg-surface-inset",children:[(0,a.jsx)("div",{className:"relative flex-1 h-full overflow-hidden",children:(0,a.jsx)(t7.B,{editable:!0,onContentUpdate:E,isStreaming:x,value:null!=m?m:"",syntax:T})}),(0,a.jsx)(tY.C,{ref:v}),x?(0,a.jsx)("div",{className:"sticky overflow-visible bottom-4 start-0 w-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-primary bg-surface-l1 px-4 py-2 rounded-full h-10 border border-border",children:[(0,a.jsx)(H.y,{size:"sm"}),(0,a.jsx)("span",{children:r("files.editing-by-model","Editing...")})]})}):null]}):(0,a.jsx)(sa,{mimetype:null!=(l=n.mimeType)?l:"unknown",content:null!=m?m:""}),chat:(0,a.jsx)(t3.s,{asset:n,activeArtifact:b,onArtifactSelected:k}),editorHeader:(0,a.jsx)(t4.F,{asset:n}),assetId:n.assetId,conversationId:n.currentConversationId,headerButtons:["preview"===_?(0,a.jsx)(st,{mode:B,setMode:O}):null,"run"===_?(0,a.jsx)("div",{className:"py-1",children:(0,a.jsxs)(eL.$n,{variant:"secondary",shape:"rectangle",size:"sm",onClick:S,disabled:I,children:[I?(0,a.jsx)(H.y,{size:"xs"}):(0,a.jsx)(d.udU,{...sr,size:18}),r("code-execution.run","Run")]})}):null,(0,a.jsx)(t1,{asset:n},"add-to-workspace-button"),(0,a.jsx)(eL.gx,{tooltipContent:r("Copy Contents","Copy Contents"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:z,variant:"tertiary",shape:"square",size:"sm","aria-label":r("Copy Contents","Copy Contents"),children:(0,a.jsx)(tz.p,{children:P?(0,a.jsx)(d.Srz,{size:18}):(0,a.jsx)(d.TdU,{size:18})},P?"copied":"copy")},"copy-button"),(0,a.jsx)(eL.gx,{tooltipContent:r("Download to file","Download to file"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:A,variant:"tertiary",shape:"square",size:"sm","aria-label":r("Download to file","Download to file"),children:(0,a.jsx)(d.KXi,{...sr,size:18})},"download-button"),i.ENABLE_FILE_SHARING?(0,a.jsx)(eL.gx,{tooltipContent:r("Share file","Share file"),onClick:M,tooltipContentProps:{className:"text-xs"},variant:"tertiary",shape:"square",size:"sm","aria-label":r("Share file","Share file"),children:(0,a.jsx)(tz.p,{children:R?(0,a.jsx)(H.y,{size:"xs"}):D?(0,a.jsx)(d.Srz,{size:16}):(0,a.jsx)(d.liv,{...sr,size:18})},R?"share-loading":D?"shared":"share")},"share-button"):null]})},unknown:sI},sS=e=>null===e.selection?{activeSheetId:e.activeSheet}:{selection:{type:"sheet",sheetId:e.activeSheet,range:(0,tV.Hj)(e.selection).text}};function sE(e){var t;let{rootAssetId:s}=e,{t:l}=(0,p.Bd)("files"),{setOpen:i}=(0,t$.cL)(),r=(0,eS.R)((0,e$.k)(e=>e.fetchVersions)),o=(0,eS.R)(e=>{var t;return null==(t=e.assetsById[s])?void 0:t.status}),c=(0,eS.F7)(s),d=(0,tK.F$)();(0,F.useEffect)(function(){return d.updateState(e=>({...e,activeId:s})),()=>{d.updateState(e=>({...e,activeId:null}))}},[s,d]);let u=(0,n.aP)(C.A("setMetadata")),m=d.useState(e=>e.nodes[s]);if((0,F.useEffect)(function(){m&&"sheet"===m.type&&u(sS(m))},[m,u]),(0,F.useEffect)(()=>{r(s)},[s,r]),(0,F.useEffect)(()=>{i(!1)},[]),!c&&"success"===o)return(0,a.jsx)(tq.f,{title:l("file-not-found.title","File not found"),message:l("file-not-found.message","We couldn't find the document. Please verify the link you entered and try again. You can also browse for your files in the Files panel.")});if(!c&&"error"===o)return(0,a.jsx)(tq.f,{});if(!c)return(0,a.jsx)(e8.P,{delayMs:500,children:(0,a.jsx)("div",{className:"flex w-full h-full justify-center items-center",children:(0,a.jsx)(H.y,{})})});let h=null!=(t=sC[(0,eF.qW)(c)])?t:sI;return(0,a.jsx)(h,{asset:c})}function s_(){var e;let t=(0,y._)(),{t:s}=(0,p.Bd)("files"),{ENABLE_IMAGE_EDITOR_IN_FILES:l}=(0,Q.h)(),{route:n,push:i}=(0,L.wK)(),o=(0,X.Di)(),{user:c}=(0,V.wV)(),d="files"===n.page&&null!=(e=n.fileId)?e:void 0,u=(0,eS.R)(e=>{var t,s;return d&&e.currentVersion[d]?null==(s=e.assetsById[e.currentVersion[d]])||null==(t=s.data)?void 0:t.name:""}),m=(0,eS.R)(e=>e.isFileExplorerCollapsed),h=(0,eS.R)(e=>e.setIsFileExplorerCollapsed);if((0,F.useEffect)(()=>{t("files.open",d,{location:"files-page-content:useEffect"})},[d,t]),(0,Y.r)(u||s("files-page-title","Files")),(0,ti.v)(tn.Ib,e=>{e.preventDefault(),e.stopPropagation(),i({page:"main"}),t("pressed_cmd_j",void 0,{location:"files-page-content:useHotkeys"})},[t,i]),!c||"files"!==n.page)return(0,a.jsx)(D.default,{});if(o)return(0,a.jsx)(eD,{});let{fileId:f,emptyView:x}=n;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tr.K,{collapsed:m,onCollapsedChange:h,sideContent:(0,a.jsx)(tl,{className:"h-full"}),autoSaveId:"files-page-layout",style:{height:"100vh"},direction:"horizontal",className:"w-full h-[100vh] overflow-hidden",tagName:"main",children:f?(0,a.jsx)(sE,{rootAssetId:f}):"image"===x&&l?(0,a.jsx)(tW,{}):(0,a.jsx)(tu,{})}),(0,a.jsx)(r.CommandMenu,{})]})}var sz=s(58939),sP=s(90210);let sA=e=>{let t=(0,Q.h)(),[s,a]=(0,F.useState)([]),l=(0,F.useMemo)(()=>null==e?void 0:e.filter(e=>!s.includes(e.ticker)&&e.ticker.length<=5),[e,s]);return(0,I.IT)({retry:!1,queryKey:["ticker_mini_summary",null==l?void 0:l.map(e=>{var t;return e.ticker.toLowerCase()+(null==(t=e.originalSuggestion)?void 0:t.label)})],queryFn:async()=>null==l||0===l.length||l.every(e=>""==e.ticker.trim())?null:await Promise.allSettled(l.map(async e=>[e.originalSuggestion,await k.rA.financeGetStockMiniSummary({ticker:e.ticker.trim()})])).then(e=>{let t=e.filter(e=>"fulfilled"===e.status).map(e=>e.value).filter(e=>null!=e).map(e=>({suggestion:e[0],data:e[1]})),s=l.map(e=>e.ticker.toLowerCase()).filter(e=>!t.map(e=>{var t;return null==(t=e.data.ticker)?void 0:t.toLowerCase()}).includes(e));return a(e=>[...e,...s]),t}),enabled:t.SHOW_FINANCE_SUGGESTIONS&&!!e&&e.every(e=>""!=e.ticker.trim())})};var sM=s(10463);let sD=e=>{let{className:t}=e;return(0,a.jsx)("div",{className:(0,h.cn)("bg-muted-foreground/10 relative overflow-hidden",t),children:(0,a.jsx)("div",{className:(0,h.cn)("shimmer-effect")})})};var sR=s(4868);let sT=()=>{var e,t,s,l,n;let{t:i}=(0,p.Bd)("finance"),{route:r}=(0,L.wK)(),o="finance"===r.page?r.ticker:"",{data:c,isLoading:u}=sA([{ticker:o}]),m=null==(e=(null!=c?c:[])[0])?void 0:e.data,{isChatOpen:h,setIsChatOpen:g}=(0,sR.a)();if(u)return(0,a.jsx)("div",{className:"flex justify-center items-center h-header-height",children:(0,a.jsx)(sD,{className:"w-full h-full rounded-md"})});let v=o in sM.s?sM.s[o]:null;return(0,a.jsx)("div",{className:"flex grow-0 shrink-0",children:(0,a.jsx)("header",{className:"px-4 flex-row items-center h-header-height flex justify-between w-full gap-2 relative z-30 flex-shrink-0",children:(0,a.jsxs)(x.N,{mode:"popLayout",children:[(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},className:"w-full overflow-hidden min-w-0 hidden sm:block",children:(0,a.jsxs)("div",{className:"text-lg flex flex-row items-center gap-2",children:[v&&(0,a.jsx)("img",{src:v,alt:o,className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium overflow-hidden text-ellipsis whitespace-nowrap",children:null!=(l=null==m||null==(t=m.stockOverview)?void 0:t.name)?l:o}),"\xb7",(0,a.jsx)("span",{className:"font-medium",children:null!=(n=null==m||null==(s=m.stockOverview)?void 0:s.exchange)?n:""})]})},o),!h&&(0,a.jsx)(eL.gx,{tooltipContent:i("Open Chat","Open Chat"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},onClick:()=>g(!0),shape:"square",variant:"tertiary",size:"sm","aria-label":i("Open Chat","Open Chat"),children:(0,a.jsx)(d.PBN,{size:18})},"open-chat-button"),(0,a.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeInOut"},children:(0,a.jsx)(tE.w,{variant:"ghost",size:"iconMd",rounded:!0,conversationId:"",responseId:"a",iconProps:{size:20}})},"share")]})})})};var sB=s(20143);let sL=e=>{let{itemKey:t,label:s,isSelected:l}=e,n=(0,sR.a)(C.A("setFinanceItem")),{route:i}=(0,L.wK)(),r="finance"===i.page?i.ticker:"",{stockFinancialTimeframe:o}=(0,sR.a)(),c=(0,I.jE)(),d=e=>{n(e)},u=(0,F.useCallback)(()=>{r&&o&&sB.MF.forEach(async e=>{await c.prefetchQuery({queryKey:[sB.fL,null==r?void 0:r.toLowerCase(),e],queryFn:()=>k.rA.financeGetStockFinancials({ticker:r,timeframe:e})})})},[c,r,o]);return(0,a.jsx)("div",{className:(0,h.cn)("flex flex-grow-0 py-4 text-muted-foreground cursor-pointer hover:text-primary",l?"border-b-2 border-primary text-foreground-primary":""),onClick:()=>d(t),onMouseEnter:()=>{r&&o&&"financials"===t&&u()},children:s},t)},sF=()=>{let{t:e}=(0,p.Bd)("finance"),t=(0,sR.a)(C.A("financeItem")),s={overview:{title:e("finance-selector.overview","Overview")},financials:{title:e("finance-selector.financials","Financials")}};return(0,a.jsx)("div",{className:"flex flex-row w-full h-[50px] pl-4 gap-4 overflow-x-scroll",children:Object.entries(s).map(e=>{let[s,l]=e;return(0,a.jsx)(sL,{itemKey:s,label:l.title,isSelected:t===s},s)})})};var sO=s(75036);function sG(e){let t=new Date(e);if(isNaN(t.getTime()))throw Error("Invalid date format. Expected YYYY-MM-DD");let s=new Intl.DateTimeFormat("en-US",{month:"short"}),a=t.getFullYear().toString().slice(-2);return"".concat(s.format(t)," '").concat(a)}var sU=s(76393);let sq=e=>{let{financialReport:t}=e,{i18n:s}=(0,p.Bd)("finance"),l=(0,sO.h)(!0,s.language),n=(0,F.useMemo)(()=>Object.values(t).sort((e,t)=>e.endDate.localeCompare(t.endDate)),[t]),i=(0,F.useMemo)(()=>n.map(e=>(0,a.jsx)("span",{children:sG(e.endDate)},e.fiscalPeriod+e.fiscalYear)),[n]),r=Object.keys(n.at(0).report),o=(0,F.useMemo)(()=>r.map(e=>n.map(t=>t.report[e])),[r,n]);return(0,a.jsx)("div",{className:"grow-1 text-muted-foreground w-full",children:(0,a.jsxs)("table",{className:"table-auto w-full",children:[(0,a.jsx)("thead",{className:"table-header",children:(0,a.jsxs)("tr",{className:"w-full",children:[(0,a.jsx)("th",{className:"pb-2 text-left",children:""}),i.map((e,t)=>(0,a.jsx)("th",{className:"pb-2 px-2 font-semibold text-right text-nowrap",children:e},t))]},"headers")}),(0,a.jsx)("tbody",{className:"w-full",children:o.map((e,t)=>(0,a.jsxs)("tr",{className:(0,h.cn)("financial-table-row hover:bg-muted"),children:[(0,a.jsx)("td",{className:"table-cell py-2 pl-2 pr-4 ph-[30px] text-overflow-ellipsis",children:e.at(0).label}),e.map((e,s)=>{var n;return null==e?(0,a.jsx)("td",{className:"table-cell py-2px-2 text-center",children:"-"},"".concat(t,"-").concat(s)):(0,a.jsx)("td",{className:"table-cell py-2 px-2 text-right",children:(0,a.jsxs)("div",{className:"flex flex-col justify-end",children:[(0,a.jsx)("span",{className:"text-nowrap",children:l(e.value,(null==(n=e.unit)?void 0:n.length)<4?e.unit:void 0)}),(0,a.jsx)("span",{className:"text-nowrap text-fg-primary",children:null!=e.changePercent&&!Number.isNaN(e.changePercent)&&(0,a.jsx)(sU.p,{value:e.changePercent,formatter:e=>"".concat(e.toFixed(2),"%")})})]})},"".concat(t,"-").concat(s))})]},t))})]})})},sW=e=>{let{itemKey:t,label:s,isSelected:l}=e,n=(0,sR.a)(C.A("setStockFinancialItem")),i=e=>{n(e)};return(0,a.jsx)(eL.$n,{variant:"secondary",shape:"pill",size:"md",className:(0,h.cn)(l&&"bg-primary/10"),onClick:()=>i(t),children:s})},sK=()=>{let{t:e}=(0,p.Bd)("finance"),t=(0,sR.a)(C.A("stockFinancialItem")),s={incomeStatements:{label:e("finance-body-financials-selector.incomeStatements","Income Statement")},balanceSheets:{label:e("finance-body-financials-selector.balanceSheets","Balance Sheet")},cashFlows:{label:e("finance-body-financials-selector.cashFlows","Cash Flow")}};return(0,a.jsx)("div",{className:"flex flex-row h-[60px] w-full gap-2 pl-4 py-8 items-center overflow-hidden",children:Object.entries(s).map(e=>{let[s,l]=e;return(0,a.jsx)(sW,{itemKey:s,label:l.label,isSelected:t===s},s)})})};var sV=s(35632),s$=s(88997),sH=s(18614),sY=s(45669),sQ=s(10490),sX=s(99e3),sJ=s(35832),sZ=s(52427),s0=s(80607);function s1(e){var t;let{active:s,payload:l}=e,{i18n:n}=(0,p.Bd)(),i=(0,sO.h)(!0,n.language);if(!s||!l||0===l.length)return null;let r=l.map(e=>{var t;return{name:e.name,value:null!=(t=e.payload[e.dataKey])?t:void 0,formatter:e=>i(e)}}),o=null==(t=l.at(0))?void 0:t.payload.name,c=[...r].sort((e,t)=>{var s,a;return(null!=(s=t.value)?s:0)-(null!=(a=e.value)?a:0)});return(0,a.jsxs)("div",{className:"z-50 text-xs bg-surface-l3 border border-border-l1 shadow-sm rounded-lg px-2 py-1 flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-secondary font-semibold",children:o}),c.map(e=>{var t,s;return(0,a.jsxs)("div",{className:"flex-1 flex-row items-center space-between text-muted-foreground w-full",children:[(0,a.jsx)("span",{className:"font-semibold pr-2",children:e.name}),(0,a.jsx)("span",{className:"text-right self-end",children:null==(t=e.formatter)?void 0:t.call(e,null!=(s=e.value)?s:0)})]},e.name)})]})}let s2=["#9F9E9D","#3B3A39","#646362","#868584","#9F9E9D"],s5=e=>{let{data:t,labels:s}=e,{i18n:l}=(0,p.Bd)(),n=(0,sO.h)(!0,l.language);return(0,a.jsx)("div",{className:"flex-1 py-6 h-[300px]",children:(0,a.jsx)(sV.u,{height:"100%",width:"100%",minWidth:50,minHeight:100,children:(0,a.jsxs)(s$.E,{data:t,margin:{top:5,right:20,left:20,bottom:10},children:[(0,a.jsx)(sH.d,{strokeDasharray:"1 0",vertical:!1,className:"stroke-black/10 dark:stroke-white/10"}),(0,a.jsx)(sY.W,{dataKey:"name",tickLine:!1,axisLine:!1}),(0,a.jsx)(sQ.h,{orientation:"right",className:"stroke-black/20 dark:stroke-white/20",tickFormatter:e=>n(e),tickLine:!1,axisLine:!1}),(0,a.jsx)(sX.m,{content:(0,a.jsx)(s1,{}),cursor:!1,isAnimationActive:!1}),(0,a.jsx)(sJ.s,{align:"left"}),(0,a.jsx)(sZ.e,{y:0,strokeWidth:1,className:"stroke-black/10 dark:stroke-white/10"}),Object.entries(s).map((e,t)=>{let[s,l]=e;return(0,a.jsx)(s0.y,{dataKey:s,name:null!=l?l:"",fill:s2[t],barSize:25,activeBar:!1,animationDuration:50},s)})]},"financial-bar-chart")})})},s4=e=>{let{itemKey:t,label:s,isSelected:l}=e,n=(0,sR.a)(C.A("setStockFinancialTimeframe"));return(0,a.jsx)(eL.$n,{variant:"secondary",shape:"pill",size:"md",className:(0,h.cn)(l&&"bg-primary/10"),onClick:()=>n(t),children:s})},s3=()=>{let{t:e}=(0,p.Bd)("finance"),t=(0,sR.a)(C.A("stockFinancialTimeframe")),s={quarterly:{label:e("finance-financials-timeframe-selector.quarterly","Quarterly")},annual:{label:e("finance-financials-timeframe-selector.annual","Annual")}};return(0,a.jsx)("div",{className:"flex flex-row h-[60px] w-full gap-2 pl-4 py-8 items-center overflow-hidden",children:Object.entries(s).map(e=>{let[s,l]=e;return(0,a.jsx)(s4,{itemKey:s,label:l.label,isSelected:t===s},s)})})},s6=(e,t)=>"incomeStatements"===t?{data:Object.values(e).sort((e,t)=>e.endDate.localeCompare(t.endDate)).map(e=>{var t,s,a,l;return{name:sG(e.endDate),revenues:null!=(a=null==(t=e.report.revenues)?void 0:t.value)?a:0,net_income_loss:null!=(l=null==(s=e.report.net_income_loss)?void 0:s.value)?l:0}}),labels:{revenues:"Revenues",net_income_loss:"Net Income/Loss"}}:"balanceSheets"===t?{data:Object.values(e).sort((e,t)=>e.endDate.localeCompare(t.endDate)).map(e=>{var t,s,a,l;return{name:sG(e.endDate),assets:null!=(a=null==(t=e.report.assets)?void 0:t.value)?a:0,liabilities:null!=(l=null==(s=e.report.liabilities)?void 0:s.value)?l:0}}),labels:{assets:"Assets",liabilities:"Liabilities"}}:"cashFlows"===t?{data:Object.values(e).sort((e,t)=>e.endDate.localeCompare(t.endDate)).map(e=>{var t,s,a,l,n,i;return{name:sG(e.endDate),net_cash_flow_from_financing_activities:null!=(l=null==(t=e.report.net_cash_flow_from_financing_activities)?void 0:t.value)?l:0,net_cash_flow_from_investing_activities:null!=(n=null==(s=e.report.net_cash_flow_from_investing_activities)?void 0:s.value)?n:0,net_cash_flow_from_operating_activities:null!=(i=null==(a=e.report.net_cash_flow_from_operating_activities)?void 0:a.value)?i:0}}),labels:{net_cash_flow_from_financing_activities:"Financing",net_cash_flow_from_investing_activities:"Investing",net_cash_flow_from_operating_activities:"Operating"}}:void 0,s8=()=>{let{t:e}=(0,p.Bd)("finance"),t=(0,sR.a)(C.A("stockFinancialItem")),s=(0,sR.a)(C.A("stockFinancialTimeframe")),{route:l}=(0,L.wK)(),n="finance"===l.page?l.ticker:null,{data:i,isLoading:r}=(0,I.IT)({queryKey:[sB.fL,null==n?void 0:n.toLowerCase(),s],queryFn:()=>n?k.rA.financeGetStockFinancials({ticker:n,timeframe:s}):null,enabled:null!=n});if(r)return(0,a.jsx)(sD,{className:"w-full h-full rounded-md p-4"});if(!n)return null;let o={incomeStatements:e("finance-body-financials-selector.incomeStatements","Income Statement"),balanceSheets:e("finance-body-financials-selector.balanceSheets","Balance Sheet"),cashFlows:e("finance-body-financials-selector.cashFlows","Cash Flow")},c=(null==i?void 0:i[t])!=null?null==i?void 0:i[t]:null;if(null==c)return null;let d=s6(c,t);return(0,a.jsxs)("div",{className:"flex flex-col grow-1 min-w-full h-full overflow-y-hidden",children:[(0,a.jsx)(sK,{}),(0,a.jsx)("div",{className:"flex flex-col items-center grow-1 p-4 min-w-full overflow-y-scroll",children:(0,a.jsxs)("div",{className:"flex-1 flex-col h-full min-w-full items-center",children:[(0,a.jsxs)("h1",{className:"flex flex-row text-muted-foreground pb-4 w-full justify-between items-center",children:[(0,a.jsx)("span",{className:"text-nowrap text-2xl font-bold ",children:o[t]}),(0,a.jsx)("div",{className:"self-end",children:(0,a.jsx)(s3,{})})]}),d&&(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(s5,{data:null==d?void 0:d.data,labels:null==d?void 0:d.labels})}),(0,a.jsx)("div",{className:"flex w-full",children:(0,a.jsx)(sq,{financialReport:c})})]})})]})};var s9=s(36828),s7=s(81210),ae=s(46295),at=s(38541),as=s.n(at);let aa=(e,t,s)=>["1D","5D","1M"].includes(e)?new Date(t).toLocaleTimeString(s.language,{day:"numeric",month:"short",year:"2-digit",hour12:!0,hour:"2-digit",minute:"2-digit"}):new Date(t).toLocaleDateString(s.language,{day:"numeric",month:"short",year:"2-digit"});function al(e){var t,s;let{active:l,payload:n}=e,{t:i,i18n:r}=(0,p.Bd)("finance"),{stockTimeSpan:o}=(0,sR.a)(),c=(0,sO.h)(!0,r.language);if(!l||!n||0===n.length)return null;let d=null==(t=n.at(0))?void 0:t.payload;if(!d)return null;let u=aa(o,d.time,r),m=c(null!=(s=d.price)?s:0,d.unit),h=c(d.volume);return(0,a.jsxs)("div",{className:"z-50 text-xs bg-surface-l3 border border-border-l1 shadow-sm rounded-lg px-2 py-1 flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-secondary font-semibold",children:u}),(0,a.jsxs)("span",{className:"text-secondary font-semibold",children:[i("chart.price","Price"),": ",m]}),(0,a.jsxs)("span",{className:"text-secondary font-semibold",children:[i("chart.volume","Volume"),": ",h]})]})}function an(e){if(0===e)return 0;let t=Math.pow(10,2-Math.floor(Math.log10(Math.abs(e))));return Math.floor(e*t)/t}function ai(e,t){let s=60*new Date().getTimezoneOffset()*1e3,a=(e+s)/36e5;return 1e3*(t?12*Math.ceil(a/12):12*Math.floor(a/12))*3600-s}let ar=(e,t,s)=>{if("1D"===t){let t=new Date(e),s=t.getHours(),a=String(s%12),l=String(t.getMinutes()).padStart(2,"0");return"".concat(a,":").concat(l," ").concat(s>12?"PM":"AM")}if("5D"!==t)return new Date(e).toLocaleDateString(s.language,{day:"numeric",month:"numeric",year:"2-digit"});{let t=new Date(e),a=t.toLocaleDateString(s.language,{day:"numeric",month:"numeric",year:"2-digit"}),l=t.getHours(),n=String(l%12);return"".concat(a," ").concat(n," ").concat(l>12?"PM":"AM")}},ao=(e,t)=>{let s=e.map(e=>e.time),a=Math.min(...s),l=Math.max(...s);if("1D"===t){let e=function(e){let t=new Date(e),s=9-parseInt(t.toLocaleString("en-US",{timeZone:"America/New_York",hour:"numeric",hour12:!1}),10);return Math.floor(t.setHours(t.getHours()+s,30,0,0))}(a),t=Math.min(Math.ceil(e+414e5),l),s=36e5*Math.ceil(t/36e5),n=Math.min(t,l),i=as().range(e+18e5,t,72e5);return{domain:[e,s],ticks:[...i,s],perc:ac(e,n)}}if("5D"===t){let e=Math.min(...s),t=ai(e,!0),a=Math.max(...s),l=ai(a,!1);return{domain:[e,a],ticks:[...as().range(t,l,432e5),l],perc:100}}{let e=Math.min(...s)-36e5,t=Math.max(...s)+36e5,a=as().range(e,t,(t-e)/5);return{domain:[e,t],ticks:[...a,t],perc:100}}},ac=(e,t)=>{let s=new Date(e);return(s.setHours(s.getHours()+7,0,0,0)-e)/(t-e)*100},ad=(e,t,s)=>{let a=e.filter(e=>e.time>=t[0]&&e.time<=t[1]).map(e=>e[s]);return function(e,t){let s=t-e,a=an(e-.05*s),l=function(e){if(0===e)return 0;let t=Math.pow(10,2-Math.floor(Math.log10(Math.abs(e))));return Math.ceil(e*t)/t}(t+.05*s),n=as().range(a,l,(l-a)/5).map(e=>an(e));return{domain:[a,l],ticks:[...n,l]}}(Math.min(...a),Math.max(...a))},au=(e,t)=>{var s,a;return t-(null!=(a=null==e||null==(s=e[0])?void 0:s.price)?a:0)>0?1:-1},am=()=>null,ah=()=>{var e,t,s,l;let{route:n}=(0,L.wK)(),i="finance"===n.page?n.ticker:"",{stockTimeSpan:r}=(0,sR.a)(),{i18n:o}=(0,p.Bd)(),c=(0,sO.h)(!0,o.language),[d,u]=(0,F.useState)(null),[m,h]=(0,F.useState)(!0),{data:f,isLoading:x}=sA([{ticker:i}]),g=null==(e=(null!=f?f:[])[0])?void 0:e.data,{data:v,isLoading:j}=(0,I.IT)({queryKey:[sB.p8,i,r],queryFn:()=>k.rA.financeGetStockChartData({ticker:i,timespan:r}),enabled:!!i});if(j||x)return(0,a.jsx)("div",{className:"flex-1 items-center justify-center h-full",children:(0,a.jsx)(sD,{className:"w-full h-[416px] rounded-lg"})});let y=Object.values(null!=(s=null==v?void 0:v.chartData)?s:{}).map(e=>{var t;return{time:Number(e.timestamp),price:Number(e.average),volume:Number(e.volume),unit:null!=(t=null==v?void 0:v.unit)?t:""}}).filter(e=>e.price&&e.time&&e.volume),b=1===au(y,null!=(l=null==g||null==(t=g.financeValue)?void 0:t.value)?l:0)?"#41b2b2":"#f5a5a7",{domain:w,ticks:N,perc:C}=ao(y,r),{domain:S,ticks:E}=ad(y,w,"price"),_=y.filter(e=>e.time>=w[0]&&e.time<=w[1]);return(0,a.jsxs)("div",{className:"flex-1 flex-col items-center justify-center w-full py-2",children:[(0,a.jsx)("div",{className:"flex-1 self-stretch self-bottom relative top-[25px]",children:(0,a.jsx)(sV.u,{width:"100%",minWidth:50,minHeight:300,children:(0,a.jsxs)(s9.b,{width:500,height:300,data:_,margin:{top:5,right:0,left:20,bottom:0},syncId:"chart",onMouseMove:e=>{if(e.isTooltipActive){var t;u(null!=(t=e.activeTooltipIndex)?t:null),h(!1)}else u(null),h(!0)},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"100%",y2:"0",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:b}),(0,a.jsx)("stop",{offset:"".concat(C,"%"),stopColor:b}),(0,a.jsx)("stop",{offset:"".concat(C,"%"),stopColor:"#646362"}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#646362"})]})}),(0,a.jsx)(sH.d,{horizontalValues:E,strokeDasharray:"1 0",vertical:!1,className:"stroke-black/10 dark:stroke-white/10"}),(0,a.jsx)(sY.W,{dataKey:"time",domain:w,name:"Time",tick:!1,ticks:N,tickLine:!1,axisLine:!1,type:"1D"===r?"number":"category"}),(0,a.jsx)(sQ.h,{dataKey:"price",name:"Price",domain:S,tickFormatter:e=>c(e),ticks:E,tickLine:!1,axisLine:!1,type:"number",allowDataOverflow:!0,orientation:"right"}),(0,a.jsx)(s7.N,{type:"linear",dataKey:"price",stroke:"url(#colorUv)",activeDot:!1,dot:!1,strokeWidth:2,connectNulls:!0,animationDuration:50}),(0,a.jsx)(sX.m,{content:(0,a.jsx)(al,{}),cursorStyle:{stroke:1},isAnimationActive:!1})]})})}),(0,a.jsx)("div",{children:(0,a.jsx)(sV.u,{width:"100%",height:100,children:(0,a.jsxs)(s$.E,{data:_,margin:{top:0,right:0,left:20,bottom:5},syncId:"chart",onMouseMove:e=>{var t;u(null!=(t=e.activeTooltipIndex)?t:null),h(!1)},onMouseLeave:()=>{u(null),h(!0)},children:[(0,a.jsx)(sY.W,{dataKey:"time",tickLine:!1,axisLine:!1,ticks:N,tickFormatter:e=>ar(e,r,o),domain:w,allowDataOverflow:!0,type:"1D"===r?"number":"category"}),(0,a.jsx)(sQ.h,{dataKey:"volume",tickLine:!1,axisLine:!1,domain:["auto","auto"],tick:!1,type:"number",allowDataOverflow:!0,orientation:"right"}),(0,a.jsx)(s0.y,{dataKey:"volume",fill:b,animationDuration:50,children:_.map((e,t)=>(0,a.jsx)(ae.f,{fill:d===t||m?"rgba(100, 99, 98, 1.0)":"rgba(100, 99, 98, 0.5)"},"cell-".concat(t)))}),(0,a.jsx)(sX.m,{content:(0,a.jsx)(am,{}),cursorStyle:{stroke:1},cursor:!1})]})})})]})},af=()=>{var e,t,s,l,n;let{route:i}=(0,L.wK)(),r="finance"===i.page?i.ticker:"",{data:o,isLoading:c}=sA([{ticker:r}]),{i18n:d,t:u}=(0,p.Bd)("finance"),m=(0,sO.h)(!0,d.language),{stockTimeSpan:h}=(0,sR.a)(),f=null==(e=(null!=o?o:[])[0])?void 0:e.data,x=null!=(l=null==f||null==(t=f.financeValue)?void 0:t.value)?l:0,g=null!=(n=null==f||null==(s=f.financeValue)?void 0:s.unit)?n:"$",{data:v,isLoading:j}=(0,I.IT)({queryKey:[sB.p8,r,h],queryFn:()=>k.rA.financeGetStockChartData({ticker:r,timespan:h})});if(!f||!o)return null;let{change:y,changePercent:b}=function(e,t,s){var a,l,n,i,r,o,c,d,u,m,h,f;if("1D"===e)return{change:null!=(n=null==t||null==(a=t.financeValue)?void 0:a.change)?n:0,changePercent:null!=(i=null==t||null==(l=t.financeValue)?void 0:l.changePercent)?i:0};{let e=Math.min(...Object.keys(null!=(u=null==s?void 0:s.chartData)?u:[]).map(e=>parseInt(e,10))),a=null!=(m=null==s||null==(o=s.chartData)||null==(r=o[e.toString()])?void 0:r.close)?m:0;return{change:(null!=(h=null==t||null==(c=t.financeValue)?void 0:c.value)?h:0)-a,changePercent:0===a?null:((null!=(f=null==t||null==(d=t.financeValue)?void 0:d.value)?f:0)-a)/a*100}}}(h,f,v),w=f.timestamp?new Date(parseInt(f.timestamp.toString(),10)/1e6).toLocaleString(d.language,{day:"numeric",month:"short",year:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}):null,N=m(x,g);return(0,a.jsx)("div",{className:"flex",children:c?(0,a.jsx)(sD,{className:"w-full h-[40px] rounded-md"}):(0,a.jsxs)("div",{className:"flex flex-row gap-2 px-2 pt-2 items-baseline",children:[(0,a.jsx)("span",{className:"text-2xl font-medium",children:N}),"1D"!==h&&j?(0,a.jsx)(sD,{className:"w-full h-[40px] rounded-md"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sU.p,{value:y,formatter:e=>m(e,g),className:"text-lg"}),b&&(0,a.jsx)(sU.p,{value:b,formatter:e=>"".concat(e.toFixed(2),"%"),className:"text-lg"}),w&&(0,a.jsx)("span",{className:"text-[10px] text-fg-secondary",children:u("price.updatedTimeIndicator","as of {{time}}",{time:w})})]})]})})},ax=()=>{var e,t,s,l,n,i,r,o,c,d,u,m,f,x,g,v,j,y,b,w,N,C,S,E,_,z;let{t:P,i18n:A}=(0,p.Bd)("finance"),{route:M}=(0,L.wK)(),D="finance"===M.page?M.ticker:"",{data:R,isLoading:T}=(0,I.IT)({queryKey:[sB.hu,D],queryFn:()=>k.rA.financeGetStockSummary({ticker:D})}),{data:B}=sA([{ticker:D}]),F=null==(e=(null!=B?B:[])[0])?void 0:e.data,O=(0,sO.h)(!0,A.language);if(T)return(0,a.jsx)(sD,{className:"w-full h-[100px] rounded-md"});if(null==R)return null;let G=null==F||null==(t=F.financeValue)?void 0:t.unit,U=[{label:P("overview.prevClose","Previous close"),value:(null==(s=R.prevDay)?void 0:s.close)!=null?O(null==(l=R.prevDay)?void 0:l.close,G):"-"},{label:P("overview.open","Open"),value:(null==(n=R.currentDay)?void 0:n.open)!=null?O(null==(i=R.currentDay)?void 0:i.open,G):"-"},{label:P("overview.dayRange","Day's range"),value:"".concat(O(null!=(w=null==(r=R.currentDay)?void 0:r.low)?w:0,G)," - ").concat(O(null!=(N=null==(o=R.currentDay)?void 0:o.high)?N:0,G))},{label:P("overview.prevRange","Previous day's range"),value:"".concat(O(null!=(C=null==(c=R.prevDay)?void 0:c.low)?C:0,G)," - ").concat(O(null!=(S=null==(d=R.prevDay)?void 0:d.high)?S:0,G))},{label:P("overview.52WeekRange","52 Week's range"),value:"".concat(O(null!=(E=null==(u=R.oneYear)?void 0:u.low)?E:0,G)," - ").concat(O(null!=(_=null==(m=R.oneYear)?void 0:m.high)?_:0,G))},{label:P("overview.marketCap","Market cap"),value:null!=R.marketCap?O(R.marketCap,G):"-"},{label:P("overview.exDividendDate","Ex-Dividend Date"),value:(null==(f=R.dividend)?void 0:f.exDividendDate)!=null?new Date(null==(x=R.dividend)?void 0:x.exDividendDate).toLocaleDateString(A.language,{month:"short",day:"numeric",year:"2-digit"}):"-"},{label:P("overview.forwardDividend","Forward Dividend"),value:(null==(g=R.dividend)?void 0:g.cashAmount)!=null?O((null==(v=R.dividend)?void 0:v.cashAmount)*parseInt(null!=(z=null==(j=R.dividend)?void 0:j.frequency)?z:"1",10),G):"-"},{label:P("overview.dividendYield","Dividend Yield"),value:(null==(y=R.dividend)?void 0:y.dividendYield)!=null?"".concat(null==(b=R.dividend)?void 0:b.dividendYield.toFixed(3),"%"):"-"}];return(0,a.jsx)("div",{className:(0,h.cn)("grid grid-cols-[repeat(auto-fill,minmax(350px,2fr))] gap-y-1 gap-x-4 ps-2 pe-4","items-center text-sm text-fg-secondary"),children:U.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,a.jsx)("span",{className:"block text-wrap",children:e.label}),(0,a.jsx)("span",{className:"block text-right",children:e.value})]},t))})},ap=()=>{let{stockTimeSpan:e,setStockTimeSpan:t}=(0,sR.a)();return(0,a.jsx)("div",{className:(0,h.cn)("flex grow-0 flex-row items-center text-muted-foreground w-fit","h-[40px] rounded-[20px] bg-muted"),children:sB.G5.map(s=>(0,a.jsx)("div",{className:(0,h.cn)("font-medium cursor-pointer","rounded-[20px] bg-muted px-4 py-2","hover:bg-muted-foreground/10",e===s&&"bg-muted-foreground/10 text-primary"),onClick:()=>t(s),children:s},s))})},ag=()=>{let{route:e}=(0,L.wK)(),t="finance"===e.page?e.ticker:"",s=(0,I.jE)();return(0,F.useEffect)(()=>{sB.G5.forEach(async e=>{await s.prefetchQuery({queryKey:[sB.p8,t,e],queryFn:()=>k.rA.financeGetStockChartData({ticker:t,timespan:e})})})},[s,t]),(0,a.jsxs)("div",{className:"flex flex-col gap-2 py-2",children:[(0,a.jsx)(ap,{}),(0,a.jsx)(af,{}),(0,a.jsx)(ah,{}),(0,a.jsx)(ax,{})]})},av=e=>{var t,s,l,n,i,r,o,c,d,u,m,f;let{tickerOverview:x}=e,{i18n:g}=(0,p.Bd)("finance"),v=(0,sO.h)(!0,g.language),j=null!=(o=null==(t=x.ticker)?void 0:t.toUpperCase())?o:"",y=j in sM.s?sM.s[j]:null,{push:b}=(0,L.wK)(),w=null!=(c=null==(s=x.financeValue)?void 0:s.change)?c:0,k=null!=(d=null==(l=x.financeValue)?void 0:l.changePercent)?d:0;return(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col rounded-[16px] px-3 py-3 h-[90px] w-full text-sm text-fg-secondary","border hover:bg-muted/50 gap-1 cursor-pointer"),onClick:()=>{b({page:"finance",ticker:j})},children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 self-start w-full",children:[(0,a.jsx)("div",{className:"flex",children:y&&(0,a.jsx)("img",{src:y,alt:j,className:"w-10 h-10 rounded-md"})}),(0,a.jsxs)("div",{className:"flex-1 flex-col gap-1 overflow-hidden",children:[(0,a.jsx)("span",{className:"flex text-primary",children:x.ticker}),(0,a.jsx)("span",{className:"sm:block w-full text-ellipsis whitespace-nowrap overflow-hidden",children:null!=(u=null==(n=x.stockOverview)?void 0:n.name)?u:""})]})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)("span",{className:"text-primary",children:v(null!=(m=null==(i=x.financeValue)?void 0:i.value)?m:0,null!=(f=null==(r=x.financeValue)?void 0:r.unit)?f:"$")}),(0,a.jsx)(sU.p,{value:w,formatter:e=>{var t,s;return v(e,null!=(s=null==(t=x.financeValue)?void 0:t.unit)?s:"$")}}),(0,a.jsx)(sU.p,{value:k,formatter:e=>"".concat(e.toFixed(2),"%"),prefix:"(",suffix:")"})]})]})},aj=()=>{var e;let{route:t}=(0,L.wK)(),s="finance"===t.page?t.ticker:"",{t:l}=(0,p.Bd)("finance"),{data:n,isLoading:i}=(0,I.IT)({queryKey:[sB.YK,s],queryFn:()=>k.rA.financeGetRelatedTickers({ticker:s}),enabled:!!s});return(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-2",children:[(0,a.jsx)("h1",{children:l("title.relatedStocks","Related Stocks")}),(0,a.jsx)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(220px,1fr))] gap-4",children:i?(0,a.jsx)(sD,{className:"w-full h-[200px] rounded-md"}):Object.entries(null!=(e=null==n?void 0:n.relatedTickers)?e:{}).map(e=>{let[t,s]=e;return(0,a.jsx)(av,{tickerOverview:s},t)})})]})},ay=()=>(0,a.jsx)("div",{className:"flex flex-grow-1 flex-col h-full p-2 overflow-y-hidden gap-2",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2 min-w-full overflow-y-scroll",children:[(0,a.jsx)(ag,{}),(0,a.jsx)(aj,{})]})}),ab=()=>{let e=(0,sR.a)(C.A("financeItem"));return(0,a.jsxs)("div",{className:"flex flex-col grow-1 h-full w-full overflow-hidden ",children:[(0,a.jsx)(sF,{}),"overview"===e&&(0,a.jsx)(ay,{}),"financials"===e&&(0,a.jsx)(s8,{})]})},aw=()=>(0,a.jsxs)("div",{className:"flex flex-col h-full min-h-full",children:[(0,a.jsx)(sT,{}),(0,a.jsx)(ab,{})]});var ak=s(80242),aN=s(88261),aI=s(44465),aC=s(62519),aS=s(35181),aE=s(48992),a_=s(20337);let az=(0,F.memo)(function(e){let{activeArtifact:t,onArtifactSelected:s,restrictedModel:l=!1}=e,{t:i}=(0,p.Bd)("finance"),r=(0,n.aP)(C.A("setShowStreamingIndicator")),o=(0,n.aP)(C.A("conversationId")),c=(0,n.aP)(C.A("setConversationId")),{route:d,push:u}=(0,L.wK)(),m="finance"===d.page?d.ticker:void 0,h="finance"===d.page?d.conversationId:void 0,f="finance"===d.page?d.query:void 0,x=null!=h?h:o,g=(0,N.w1)(C.A("fetchGetConversation")),{data:v,isLoading:j,error:y}=(0,aS.v)(x?g(x):void 0);(0,F.useEffect)(()=>{c(null!=x?x:void 0),u({page:"finance",ticker:null!=m?m:"",conversationId:null!=x?x:void 0})},[x,u,m,c]),(0,F.useEffect)(()=>{let e=tp.A3.getState();(null==v?void 0:v.conversationId)&&e.loadInitialResponses(null==v?void 0:v.conversationId).then(e=>{var t;let s=n.aP.getState();if(s.conversationId===(null==(t=e[0])?void 0:t.conversationId)){let t=(0,aE.Mb)(e);if(!t)return void s.setLastMessageId(void 0);if("streaming"===t.state||"reconnecting"===t.state){s.setLastMessageId(t.parentResponseId),s.setStreamedMessageId(t.responseId);return}if("optimistic"===t.state){s.setLastMessageId(t.parentResponseId),s.setOptimisticMessageId(t.responseId);return}s.setLastMessageId(t.responseId)}})},[v]);let b=function(){let{client:e}=(0,a_.useStatsigClient)(),t=(0,n.aP)(C.A("establishNewConversation")),s=(0,tg.C$)(C.A("isIncognito")),a=(0,Q.h)(),{route:l}=(0,L.wK)(),i="finance"===l.page?l.ticker:void 0,r=i?"You are a finance expert. User is looking at finance page for stock ticker for ".concat(i,", containing price, stock chart data and financial data. If user question is ambiguous, assume that their question is about the ").concat(i,"."):void 0;return(0,F.useCallback)(async l=>{let{query:n,webpageUrls:i,toolOverrides:o,isPreset:c,persona:d,disableMemory:u}=l;return!!n&&(e.logEvent("finance.start-convo"),!!await t({message:n,webpageUrls:i,toolOverrides:o,temporary:s,isPreset:c,persona:d,enableRetries:a.ENABLE_AUTO_STREAM_RETRY,responseMetadata:void 0,isFromGrokFiles:!1,ff:a,disableMemory:u,customInstructions:r}).catch(e=>{(0,w.vV)("workspace:establishNewConversation",e)}))},[t,s,a,e,r])}();return((0,F.useEffect)(()=>(r(!0),()=>r(!1)),[r]),x||v)?x&&!v?null:(0,a.jsx)(aN.uI,{artifact:{onOpen:null!=s?s:()=>{},onClear:()=>{},active:t,isShowInlineOption:!1,isSidebar:!1},isShowFileAttachments:!1,lastMessageScrollPadding:100,children:(0,a.jsx)("div",{className:"relative h-full",children:(0,a.jsx)(ak.T,{conversationId:null!=x?x:"",conversation:v,isOptimisticConversation:!1,conversationIsLoading:j,conversationError:y,noTopBar:!0,hideFollowUps:!0,restrictedModel:l})})}):(0,a.jsx)("div",{className:"relative h-full",children:(0,a.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,a.jsx)("div",{className:"flex-1 flex flex-col justify-center items-center",children:(0,a.jsx)(aP,{onQuery:b})}),(0,a.jsx)("div",{className:"flex flex-col justify-end  pb-4 px-5",children:(0,a.jsx)(aC.s,{className:"",textAreaClassName:"min-h-14 pt-5 my-0 mb-5",placeholder:i("finance-query-placeholder","Start a conversation about {{ticker}}",{ticker:m}),initialValue:null!=f?f:void 0,onQuery:b,isIncognito:!1,onFrontPage:!1,expandable:!1,restrictedModel:l},"query-bar")})]})})}),aP=e=>{let{onQuery:t}=e,{t:s}=(0,p.Bd)("finance"),l=(0,F.useRef)([]);return((0,F.useEffect)(()=>{let e=[];e=[s("finance-query-placeholder-ask-about-stock","Tell me about the stock"),s("finance-query-placeholder-ask-about-company","Tell me about the company"),s("finance-query-placeholder-ask-about-industry","Tell me about the industry"),s("finance-query-placeholder-ask-about-market","Tell me about the market"),s("finance-query-placeholder-ask-about-economy","Tell me about the economy")],l.current=(0,aI.N)(e,Math.random()).slice(0,3)},[s]),0===l.current.length)?null:(0,a.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center",children:[(0,a.jsx)("span",{className:"text-sm text-secondary mb-1",children:s("workspace-query-try-placeholders","Try these")}),l.current.map(e=>(0,a.jsx)(m.$n,{variant:"outline",onClick:()=>t({query:e}),rounded:!0,children:e},e))]})};function aA(e){let{onRetryRequested:t,title:s,message:l}=e,{t:n}=(0,p.Bd)("finance");return(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col items-center justify-center h-full w-full p-4"),children:[(0,a.jsx)(d.hcu,{className:"mb-4",size:24}),(0,a.jsx)("h2",{className:"text-md font-semibold mb-2",children:s||n("finance-open-error.title","Could not load page")}),(0,a.jsx)("p",{className:"text-sm text-fg-secondary mb-4 text-center max-w-sm",children:l||n("finance-open-error.message","Something went wrong while trying to load the page.")}),t&&(0,a.jsxs)(m.$n,{variant:"outline",size:"md",onClick:t,className:"flex items-center gap-2",children:[(0,a.jsx)(d.e9t,{size:16,className:"text-fg-secondary"}),(0,a.jsx)("span",{className:"text-fg-primary font-semibold",children:n("file-open-error.retry","Retry")})]})]})}function aM(){let{t:e}=(0,p.Bd)("finance"),{isChatOpen:t,setIsChatOpen:s}=(0,sR.a)(),l=(0,n.aP)(e=>e.setConversationId),{push:i,route:r}=(0,L.wK)(),o=(0,y._)(),c="finance"===r.page?r.ticker:void 0,u="finance"===r.page&&!r.conversationId;return(0,ti.v)(tn.Ib,e=>{e.preventDefault(),e.stopPropagation(),i({page:"finance",ticker:null!=c?c:""}),o("pressed_cmd_j",void 0,{location:"finance-page:useHotkeys"})},[o,i]),(0,a.jsxs)(tv.YZ,{direction:"horizontal",autoSaveId:"finance-workbench",className:"bg-surface-l1 dark:bg-surface-inset",children:[(0,a.jsx)(tv.Zk,{order:1,minSize:50,defaultSize:100,className:"flex flex-col max-h-[100vh] h-[100vh]",children:(0,a.jsx)("div",{className:"flex flex-col h-full max-h-full",children:(0,a.jsx)("div",{className:"flex-1 relative overflow-hidden",children:(0,a.jsx)("div",{className:"w-full max-w-full relative h-full max-h-full",children:(0,a.jsx)(ty.t,{fallbackRender:()=>(0,a.jsx)(aA,{}),children:(0,a.jsx)(aw,{})})})})})}),(0,a.jsx)(sP.X,{className:"my-10 border-transparent"}),(0,a.jsxs)(aD,{isOpen:t,minSize:36,defaultSize:36,children:[(0,a.jsxs)("header",{className:"px-4 flex items-center justify-between gap-2 h-header-height h-full",children:[(0,a.jsx)("div",{className:"font-semibold select-none px-1",children:e("finance-tab-conversation-header","Finance Chat")}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(m.gx,{tooltipContent:e("New Chat","New Chat"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},variant:"ghost",size:"iconSm",disabled:u,className:"rounded-full no-a11y-check text-secondary",onClick:()=>{i({page:"finance",ticker:null!=c?c:"",conversationId:null}),l(void 0)},children:(0,a.jsx)(d.cJ,{size:18})}),(0,a.jsx)(m.gx,{tooltipContent:e("Close Chat","Close Chat"),tooltipContentProps:{className:"text-xs"},tooltipProps:{delayDuration:300},variant:"ghost",size:"iconSm",className:"rounded-full no-a11y-check text-secondary",onClick:()=>s(!1),children:(0,a.jsx)(d.uv5,{size:18})})]})]}),(0,a.jsx)("section",{className:"flex-1 overflow-hidden [&_.chat-input-backdrop]:bg-background dark:[&_.chat-input-backdrop]:bg-surface-l1",children:(0,a.jsx)(az,{})})]})]})}let aD=e=>{let{isOpen:t,minSize:s,defaultSize:l,children:n}=e,i=(0,F.useRef)(!1);return(0,F.useEffect)(()=>{let e=setTimeout(()=>{i.current=!0},1e3);return()=>clearTimeout(e)},[]),(0,a.jsx)(tv.Zk,{order:2,minSize:s,defaultSize:l,className:(0,h.cn)("h-[100vh] right-0",i.current?"transition-all duration-300":void 0,t?"max-w-full w-full opacity-100":"w-0 max-w-0 opacity-0 py-0 pr-0"),children:(0,a.jsx)("div",{className:"dark:bg-surface-l1 bg-background h-full flex flex-col justify-between overflow-hidden border-l border-border-l1 flex-1",children:n})})};function aR(){let{t:e}=(0,p.Bd)("finance"),{user:t}=(0,u.useSession)();return t?(0,a.jsx)("main",{className:(0,h.cn)("w-full relative flex flex-col items-center h-full w-full"),children:(0,a.jsx)(aM,{})}):(0,a.jsx)("main",{className:(0,h.cn)("w-screen h-dvh relative"),children:(0,a.jsx)(o.J,{title:e("Error","Error"),description:e("finance-page.error.anonymous-user","You must be logged in to access this page"),cta:e("finance-page-error.cta","Return home")})})}var aT=s(73459),aB=s(14609);let aL=e=>{let{items:t,selectedId:s,setSelectedId:a,onSelect:l,getId:n,enabled:i=!0,containerRef:r,scrollIntoViewOptions:o={behavior:"smooth",block:"nearest"}}=e;(0,F.useEffect)(()=>{if(i&&0!==t.length)return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)};function e(e){"ArrowDown"===e.key||"ArrowUp"===e.key?(e.preventDefault(),a(s=>{let a=s?t.findIndex(e=>n(e)===s):-1;if("ArrowDown"===e.key){if(e.metaKey||e.ctrlKey){let e=t[t.length-1];return t.length>0&&void 0!==e?n(e):null}let s=-1===a?0:(a+1)%t.length,l=t[s];return void 0!==l?n(l):null}{if(e.metaKey||e.ctrlKey){let e=t[0];return t.length>0&&void 0!==e?n(e):null}let s=-1===a?t.length-1:(a-1+t.length)%t.length,l=t[s];return void 0!==l?n(l):null}})):"Enter"===e.key&&s?(e.preventDefault(),l(s)):"Escape"===e.key&&(e.preventDefault(),a(null))}},[t,l,s,i,n,a]),(0,F.useEffect)(()=>{s&&t.length>0?t.some(e=>n(e)===s)||a(null):s&&0===t.length&&a(null)},[t,s,n,a]),(0,F.useEffect)(()=>{if(!s||!(null==r?void 0:r.current))return;let e=r.current.querySelector("[data-selected=true]");e&&e.scrollIntoView(o)},[s,r,o])},aF=()=>{let{t:e}=(0,p.Bd)("base"),[t,s]=(0,F.useState)(""),[l,n]=(0,F.useState)(null),[i,r]=(0,F.useState)(null),[o,c]=(0,F.useState)(""),[u,m]=(0,F.useState)(null),{routeToConversation:g}=(0,v.o)(),j=(0,y._)(),w=(0,b.K)(),k=(0,X.Di)(),I=(0,F.useMemo)(()=>{var e;return null!=(e=null==t?void 0:t.trim())?e:""},[t]),{results:C,refetch:S,loadMoreRef:E,historyContainerRef:_,isLoading:z,isFetching:P,isError:A}=(0,aB.Y)({query:I}),M=(0,F.useCallback)(e=>{if(l||i)return;g(e,!1,!0);let t=N.w1.getState().byId[e];j("select_conversation",e,{conversationCreateTime:(null==t?void 0:t.createTime)||"",location:"command-menu"})},[l,i,g,j]),D=(0,F.useCallback)(e=>{l||i||m(e)},[l,i]),R=(0,F.useCallback)(e=>{var t;let s=C.find(t=>t.conversation.conversationId===e);c((null==s||null==(t=s.conversation)?void 0:t.title)||""),n(e)},[C]),T=(0,F.useCallback)(async e=>{var t;if(l!==e)return;let s=o.trim();if(""===s)return;let a=C.find(t=>t.conversation.conversationId===e);j("update_conversation",e,{location:"search-dialog"}),n(null);let{fetchUpdateConversation:i}=N.w1.getState();await i(e,{title:s,starred:null==a||null==(t=a.conversation)?void 0:t.starred}).catch(e=>{w("command-menu:handleEditSave",e)}),await S()},[C,w,l,o,S,j]),B=(0,F.useCallback)(async e=>{if(i!==e)return;j("delete_conversation",e,{location:"search-dialog"}),r(null);let{fetchSoftDeleteConversation:t}=N.w1.getState();await t(e).catch(e=>{w("command-menu:handleDeleteConfirm",e)}),await S()},[i,j,S,w]),L=(0,F.useCallback)(()=>{n(null),r(null),c("")},[]),O=(0,F.useCallback)(async e=>{var t;let s=C.find(t=>t.conversation.conversationId===e);j("favorite_conversation",e,{value:(null==s?void 0:s.conversation.starred)?"true":"false",location:"search-dialog"});let{fetchUpdateConversation:a}=N.w1.getState();await a(e,{starred:!(null==s||null==(t=s.conversation)?void 0:t.starred)}).catch(e=>{w("command-menu:handleToggleFavorite",e)}),await S()},[C,w,S,j]);return aL({items:C,selectedId:u,setSelectedId:m,onSelect:M,getId:e=>e.conversation.conversationId,enabled:!l&&!i,containerRef:_}),(0,a.jsxs)("div",{className:"flex flex-col h-full relative",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-3.5",children:[(0,a.jsx)("span",{className:"text-sm text-fg-secondary",children:e("history.conversation-title","Conversation")}),!k&&(0,a.jsx)("span",{className:"text-sm text-fg-secondary",children:e("history.conversation-last-edited","Last edited")})]}),(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-6 bg-gradient-to-t from-background to-transparent"}),(0,a.jsxs)("div",{ref:_,style:{scrollPaddingBlock:"1rem"},className:(0,h.cn)("flex flex-col gap-1 h-full overflow-auto pb-4"),children:[(0,a.jsx)(x.N,{mode:"wait",initial:!1,children:z||P&&!C.length?(0,a.jsx)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"flex flex-col gap-1",children:Array.from({length:3}).map((e,t)=>(0,a.jsx)(e9.E,{className:"h-[48px] w-full rounded-2xl"},t))},"skeletons"):A?(0,a.jsxs)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"text-fg-secondary py-12 px-3 flex justify-center items-center gap-3",children:[(0,a.jsx)(d.lW3,{}),(0,a.jsx)("span",{children:e("history.failed-to-load-history","Failed to load history")})]},"error"):C.length?null==C?void 0:C.map(e=>{let{conversation:t,matchedWords:s,matchType:n,highlight:d}=e;return(0,a.jsx)("div",{"data-selected":u===t.conversationId,onMouseEnter:()=>D(t.conversationId),children:(0,a.jsx)(aO,{conversation:t,matchedWords:s,matchType:n,highlight:d,isSelected:u===t.conversationId,isEditing:l===t.conversationId,isDeleting:i===t.conversationId,newTitle:o,onNewTitleChange:c,onSelect:M,onEditStart:R,onDeleteStart:r,onToggleFavorite:O,onEditSave:T,onDeleteConfirm:B,onCancel:L})},t.conversationId)}):(0,a.jsx)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"py-12 px-3 flex justify-center items-center",children:(0,a.jsx)("span",{className:"text-fg-secondary",children:e("history.empty-history","History is empty")})},"no-results")}),(0,a.jsx)("div",{ref:E,className:"h-[1px] flex justify-center !m-0 !p-0"})]})]})},aO=(0,F.memo)(e=>(0,a.jsx)("div",{className:(0,h.cn)("h-[48px] rounded-2xl grid grid-cols-1 grid-rows-1 flex-shrink-0",e.isSelected&&"bg-button-ghost-hover"),children:(0,a.jsx)(aT.w,{...e,isSelected:e.isSelected,isHovered:e.isSelected,isCurrent:!1})}));var aG=s(19841),aU=s(625),aq=s(20014);let aW=()=>{let{t:e}=(0,p.Bd)("base"),{routeToConversation:t}=(0,v.o)(),s=(0,b.K)(),l=(0,X.Di)(),[n,i]=(0,F.useState)(null),[r,o]=(0,F.useState)(null),{results:c,isLoading:u,isFetching:m,isError:g,containerRef:j,loadMoreRef:y,isLoadingTeamMembers:N}=function(){let e=(0,V.wV)().user,t=(0,b.K)(),{currentTeam:s}=(0,aU.hd)(),{data:a,isLoading:l}=(0,I.IT)({queryKey:["team-members",null==s?void 0:s.teamId],enabled:!!(null==s?void 0:s.teamId),queryFn:async()=>k.wM.authManagementListUsers({teamId:s.teamId}).then(t=>{var s;return(null==(s=t.members)?void 0:s.filter(t=>{var s;return(null==(s=t.user)?void 0:s.userId)!==(null==e?void 0:e.userId)}))||[]}).catch(e=>((0,w.vV)("share-dialog:fetch-team-members",e),[]))}),n=(0,F.useMemo)(()=>{let e=new Map;return null==a||a.forEach(t=>{var s,a,l,n,i;e.set((null==(s=t.user)?void 0:s.userId)||"","".concat((null==(a=t.user)?void 0:a.givenName)||"").concat((null==(l=t.user)?void 0:l.givenName)&&(null==(n=t.user)?void 0:n.familyName)?" ":"").concat((null==(i=t.user)?void 0:i.familyName)||""))}),e},[a]),i=(0,F.useRef)(null),r=(0,F.useRef)(null),[o,c]=(0,F.useState)(!1),[d,u]=(0,F.useState)(!1),m=(0,F.useCallback)(async s=>{let{pageParam:a}=s;if(!e)return{shareLinkResults:[],nextPageToken:void 0};try{let{shareLinks:e,nextPageToken:t}=await k.chatApi.chatListShareLinks({sharedWithMe:!0,pageToken:"string"==typeof a?a:void 0,pageSize:"60"});return{shareLinkResults:(null==e?void 0:e.map(e=>{var t;let{sharedLink:s,...a}=e;return{...a,conversation:(null==s?void 0:s.conversation)||null,response:(null==s||null==(t=s.responses)?void 0:t.find(t=>t.responseId===e.responseId))||null}}))||[],nextPageToken:t}}catch(e){throw t("use-search-conversations",e),e}},[e,t]),{data:h,fetchNextPage:f,hasNextPage:x,isFetchingNextPage:p,isFetching:g,isError:v,isLoading:j,refetch:y}=(0,I.qu)({queryKey:["share-links",null==e?void 0:e.userId],queryFn:m,initialPageParam:void 0,getNextPageParam:e=>e.nextPageToken,enabled:!!e,staleTime:6e5,refetchOnWindowFocus:!0}),N=(0,F.useMemo)(()=>{var t;let s=((null==h||null==(t=h.pages.flatMap(e=>e.shareLinkResults))?void 0:t.filter(e=>!!e.shareLinkId))||[]).sort((e,t)=>new Date((null==t?void 0:t.modifyTime)||Date.now()).getTime()-new Date((null==e?void 0:e.modifyTime)||Date.now()).getTime());return aq.A(e=>null==e?void 0:e.shareLinkId,s).filter(t=>(null==t?void 0:t.xaiUserId)!==(null==e?void 0:e.userId)).map(e=>({...e,originalUserName:n.get((null==e?void 0:e.xaiUserId)||"")||""}))},[null==h?void 0:h.pages,null==e?void 0:e.userId,n]);return(0,F.useEffect)(()=>{if(!(null==i?void 0:i.current)||!(null==r?void 0:r.current))return;let e=new IntersectionObserver(e=>{let[t]=e;t&&c(t.isIntersecting)},{root:r.current,rootMargin:"300px 0px 300px 0px",threshold:.1}),t=i.current;if(t)return e.observe(t),()=>{e.unobserve(t)}},[null==i?void 0:i.current,null==r?void 0:r.current]),(0,F.useLayoutEffect)(()=>{o&&x&&!p&&e&&!d&&(u(!0),f().catch(e=>(0,w.vV)("intersection-load-more",e)))},[o,x,p,f,e,d]),(0,F.useEffect)(()=>{if(d){let e=setTimeout(()=>{u(!1)},300);return()=>clearTimeout(e)}},[d]),{results:N,refetch:y,loadMoreRef:i,containerRef:r,isLoading:j,isFetching:g,isError:v,isLoadingTeamMembers:l}}(),{mutate:C,isPending:S}=(0,I.n_)({mutationKey:["cloneConversation"],mutationFn:async e=>k.chatApi.chatCloneConversation({shareLinkId:e,body:{}}),onSuccess:e=>{e.conversation&&t(e.conversation.conversationId)},onError:e=>{s("history-shared-with-me:cloneConversation",e)},onSettled:()=>{o(null)}}),E=(0,F.useCallback)(async e=>{let t=c.find(t=>t.shareLinkId===e);if((null==t?void 0:t.shareLinkId)&&(null==t?void 0:t.publicId)&&!S)return o(t.shareLinkId),C(t.publicId)},[S,C,c]),_=(0,F.useCallback)(e=>{let t=c.find(t=>t.shareLinkId===e);return(null==t?void 0:t.publicId)?"/share/".concat(t.publicId):"/share/".concat(e)},[c]),z=(0,F.useCallback)(e=>{window.location.href=_(e)},[_]),P=(0,F.useCallback)(e=>{window.open(_(e),"_blank")},[_]);return aL({items:c,selectedId:n,setSelectedId:i,onSelect:z,containerRef:j,getId:e=>e.shareLinkId}),(0,a.jsxs)("div",{className:"flex flex-col h-full relative",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-3 py-3.5",children:[(0,a.jsx)("span",{className:"text-sm text-secondary",children:e("history.conversation-title","Conversation")}),!l&&(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm text-secondary",children:e("history.conversation-shared-by","Shared by")}),(0,a.jsx)("span",{className:"text-sm text-secondary w-".concat(28," text-right"),children:e("history.conversation-last-message","Last message")})]})]}),(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-6 bg-gradient-to-t from-background to-transparent"}),(0,a.jsxs)("div",{ref:j,style:{scrollPaddingBlock:"1rem"},className:(0,h.cn)("flex flex-col gap-1 h-full overflow-auto pb-4"),children:[(0,a.jsx)(x.N,{mode:"wait",initial:!1,children:u||m&&!c.length?(0,a.jsx)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"flex flex-col gap-1",children:Array.from({length:3}).map((e,t)=>(0,a.jsx)(e9.E,{className:"h-[48px] w-full rounded-2xl"},t))},"skeletons"):g?(0,a.jsxs)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"text-fg-secondary py-12 px-3 flex justify-center items-center gap-3",children:[(0,a.jsx)(d.lW3,{}),(0,a.jsx)("span",{children:e("history.failed-to-load-shared","Failed to load shared conversations")})]},"error"):c.length?null==c?void 0:c.map(e=>(0,a.jsx)("div",{"data-selected":n===e.shareLinkId,onMouseEnter:()=>e.shareLinkId&&i(e.shareLinkId),children:(0,a.jsx)(aK,{isSelected:n===e.shareLinkId,shareLink:e,shareLinkHref:_(e.shareLinkId),isLoading:r===e.shareLinkId,onStartNewConversation:E,onOpenInNewTab:P,isLoadingTeamMembers:N})},e.shareLinkId)):(0,a.jsx)(f.P.div,{variants:{visible:{opacity:1},hidden:{opacity:0}},initial:"hidden",animate:"visible",exit:"hidden",transition:{duration:.1},className:"py-12 px-3 flex justify-center items-center",children:(0,a.jsx)("span",{className:"text-fg-secondary",children:e("history.empty-share-list","No shared conversations found")})},"no-results")}),(0,a.jsx)("div",{ref:y,className:"h-[1px] flex justify-center !m-0 !p-0"})]})]})},aK=(0,F.memo)(e=>{var t,s;let{isSelected:l,shareLink:n,isLoading:i,isLoadingTeamMembers:r,shareLinkHref:o,onOpenInNewTab:c,onStartNewConversation:u}=e,m=(0,X.Di)(),{t:f}=(0,p.Bd)("base"),x=!m&&!l;return(0,a.jsx)(q(),{href:o,className:(0,h.cn)("h-[48px] rounded-2xl grid grid-cols-1 grid-rows-1 flex-shrink-0",l&&"bg-button-ghost-hover"),children:(0,a.jsxs)("div",{className:(0,h.cn)("flex cursor-pointer items-center px-3 col-start-1 col-end-2 row-start-1 row-end-2"),children:[(0,a.jsx)("div",{className:"flex-grow min-w-0",children:(0,a.jsx)("div",{className:"flex items-center w-full",children:(0,a.jsx)("div",{className:"truncate text-primary",children:(null==(t=n.conversation)?void 0:t.title)||"Untitled Conversation"})})}),i?(0,a.jsx)(H.y,{size:"xs",className:"mx-2"}):x?(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[r?(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(e9.E,{className:"w-[100px] h-[16px]"})}):(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-fg-secondary text-sm truncate",children:n.originalUserName})}),(0,a.jsx)("div",{className:"z-20 w-".concat(28," text-right"),children:(null==(s=n.response)?void 0:s.createTime)&&(0,a.jsx)(aG.D,{conversation:{createTime:n.response.createTime,modifyTime:n.response.createTime}})})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eL.gx,{tabIndex:-1,variant:"tertiary",size:"sm",shape:"square",onClick:e=>{e.stopPropagation(),e.preventDefault(),c(n.shareLinkId)},tooltipContent:f("New Tab","New Tab"),"aria-label":f("New Tab","New Tab"),children:(0,a.jsx)(d.k0t,{size:16,className:"text-primary"})}),(0,a.jsx)(eL.gx,{tabIndex:-1,variant:"tertiary",size:"sm",shape:"square",onClick:e=>{e.stopPropagation(),e.preventDefault(),u(n.shareLinkId)},tooltipContent:f("history.start-conversation","Start new converation"),"aria-label":f("history.start-conversation","Start new converation"),children:(0,a.jsx)(d.flY,{size:16,className:"text-primary"})})]})]})})});var aV=s(71865);function a$(){let{t:e}=(0,p.Bd)("base"),{currentTeam:t}=(0,aU.hd)(),{route:s}=(0,L.wK)(),l="history"===s.page&&s.tab||"conversations";return t||"shared-with-me"!==l||(l="conversations"),(0,a.jsxs)("main",{className:(0,h.cn)("h-dvh w-full relative flex flex-col items-center"),children:[(0,a.jsx)(i.hx,{hideIncognito:!0}),(0,a.jsx)(r.CommandMenu,{}),(0,a.jsx)("div",{className:"max-w-[50rem] px-6 @lg:px-2 pt-16 @sm:pt-18 mx-auto w-full flex flex-col h-full items-center pb-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 w-full flex-1 min-h-0",children:[(0,a.jsx)("span",{className:"text-2xl font-semibold px-2.5",children:e("history.title","History")}),(0,a.jsxs)(se.tU,{value:l,className:"flex flex-col flex-1 min-h-0",children:[(0,a.jsx)(aV.d,{requireSelectedTeam:!0,children:(0,a.jsxs)(se.j7,{className:"bg-transparent border-none relative w-full justify-start p-0 px-1 mt-4",children:[(0,a.jsx)(se.Xi,{value:"conversations",variant:"underline",className:"px-2",asChild:!0,children:(0,a.jsx)(L.N_,{route:{page:"history",tab:"conversations"},className:"font-semibold",children:e("history.my-conversations","My Conversations")})}),(0,a.jsx)(se.Xi,{value:"shared-with-me",variant:"underline",className:"px-2",asChild:!0,children:(0,a.jsx)(L.N_,{route:{page:"history",tab:"shared-with-me"},className:"font-semibold",children:e("history.shared-with-me","Shared with me")})}),(0,a.jsx)("div",{className:"absolute left-0 bottom-0 border-b border-border-l2 w-full mx-1"})]})}),(0,a.jsx)(se.av,{value:"conversations",className:"mt-4 flex-1 min-h-0 focus-visible:ring-0",children:(0,a.jsx)(aF,{})}),(0,a.jsx)(aV.d,{requireSelectedTeam:!0,children:(0,a.jsx)(se.av,{value:"shared-with-me",className:"mt-4 flex-1 min-h-0 focus-visible:ring-0",children:(0,a.jsx)(aW,{})})})]})]})})]})}var aH=s(27502),aY=s(81541),aQ=s(12635),aX=s(26144),aJ=s(3575),aZ=s(67169),a0=s(35169),a1=s(58271),a2=s(98585),a5=s(59886);function a4(e){let{post:t,index:s,numImages:l,sizePx:n,isHovered:i}=e,[r,o]=(0,F.useState)(!1);return(0,F.useEffect)(()=>{setTimeout(()=>{o(!0)},10)},[]),(0,a.jsx)("div",{className:(0,h.cn)("absolute top-0 left-0 w-[".concat(n,"px] h-[").concat(n,"px]"),"transition-transform duration-[".concat(i?200:300,"ms] ease-out")),style:{transform:"rotate(".concat(r?(-(3*l)+12*s)*(i?1.5:1):0,"deg) translateX(").concat(i?7*(s-1):3*(s-1),"px) scale(").concat(i?1.1:1,")")},children:(0,a.jsx)("img",{src:t.blobSrc||t.mediaUrl,alt:t.id,className:(0,h.cn)("w-full h-full object-cover rounded-xl",s===l-1&&"border-2  border-inner border-white")})})}function a3(e){let{sizePx:t=100}=e,s=(0,aZ.B)(e=>e.fetchListMediaPosts),l=(0,aZ.B)(e=>e.globalVideoProgress),n=(0,aZ.B)(e=>e.favoritesList).slice(0,3).reverse(),i=n.length,[r,o]=(0,F.useState)(!1);return(0,F.useEffect)(()=>{s({source:"MEDIA_POST_SOURCE_LIKED"}).catch((0,w.HX)("imagine-fav-pile"))},[s]),(0,a.jsxs)("div",{className:"relative w-[".concat(t,"px] h-[").concat(t,"px]"),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[n.map((e,s)=>(0,a.jsx)(a4,{post:e,index:s,numImages:i,sizePx:t,isHovered:r},e.id)),l.numberOfVideosInProgress>0&&l.progress<100&&(0,a.jsx)(a6,{sizePx:t,progress:l.progress,numInProgress:l.numberOfVideosInProgress})]})}function a6(e){let{sizePx:t=100,progress:s=0,numInProgress:l=0}=e,{resolvedTheme:n}=(0,es.D)(),i="dark"===n;return(0,a.jsxs)("div",{className:"absolute top-2 right-0",children:[(0,a.jsx)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2",children:(0,a.jsx)(a5.t,{progressPercentage:s,size:.55*t,trackClassName:(0,h.cn)(i?"stroke-white/20":"stroke-black/10"),progressClassName:(0,h.cn)(i?"stroke-white":"stroke-black/70"),thickness:3,offsetDegrees:0})}),(0,a.jsx)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2",children:(0,a.jsx)(a8,{sizePx:t,count:l})})]})}function a8(e){let{sizePx:t=100,count:s=0}=e;return(0,a.jsxs)("div",{className:"w-[${sizePx * 0.4}px] h-[${sizePx * 0.4}px]",children:[(0,a.jsx)("svg",{width:.4*t,height:.4*t,children:(0,a.jsx)("circle",{cx:.2*t,cy:.2*t,r:.2*t,fill:"#5D7BE2"})}),(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center absolute top-0 left-0 ",children:(0,a.jsx)("span",{className:"text-white text-sm font-semibold",children:s})})]})}var a9=s(86822),a7=s(82767);let le=(0,F.memo)(function(e){let{setQuery:t,showFavorites:s,navigateOnQuery:l=!0}=e,{t:n}=(0,p.Bd)("imagine"),{push:i}=(0,L.wK)(),r=(0,aZ.B)(e=>e.createMediaPostFromUrl),o=(0,aZ.B)(e=>e.like),c=(0,a9.d)(e=>e.fetchGetAsset),d=(0,tj.v)(),u=(0,aZ.B)(e=>e.generateVideoForImage),m=(0,F.useCallback)(async e=>{var s;if((null==(s=e.fileAttachmentIds)?void 0:s.length)&&"string"==typeof e.fileAttachmentIds[0]){let t=await c({assetId:e.fileAttachmentIds[0]}),s="".concat(d.ASSET_SERVER_URL,"/").concat(t.key),a=await r(s);o(a.id).catch(e=>{(0,w.vV)("imagine-query-bar:like",e)}),u(a.id,"normal").catch(e=>{(0,w.vV)("imagine-query-bar:generateVideoForImage",e)}),i({page:"imagine-post",postId:a.id})}else l&&i({page:"imagine"}),t(e.query||"");return!0},[l,t,c,r,o,u,i,d]);return(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 justify-center",children:[(0,a.jsx)(aC.s,{className:a7.Q,expandable:!1,onFrontPage:!1,restrictedModel:!0,placeholder:n("imagine-query-bar-placeholder","Type to imagine"),onQuery:m}),s&&(0,a.jsx)(eL.gx,{className:"h-full me-4",tooltipContent:n("imagine-favorites-button-label","Favorites"),variant:"none",size:"md",shape:"rectangle",onClick:()=>i({page:"imagine-favorites"}),children:(0,a.jsx)(a3,{sizePx:50})})]})});var lt=s(38362);function ls(e,t){(0,w.iu)(e,void 0,{location:"imagine-grid-card",...t})}function la(e){var t,s,l;let{data:n,width:i}=e,{t:r}=(0,p.Bd)("imagine"),{push:o,route:c}=(0,L.wK)(),{ASSET_SERVER_URL:u}=(0,tj.v)(),m=(0,F.useRef)(null),f=(0,aZ.B)(e=>e.byId[n.id||""]||e.favoritesById[n.id||""])||n,x=(0,aZ.B)(e=>e.setImageDimensions),g=(0,aZ.B)(e=>{var t;return(null!=(t=e.videoByMediaId[f.id])?t:[]).findLast(e=>(null==e?void 0:e.progress)===100)}),v=(null==(t=n.mimeType)?void 0:t.startsWith("video"))&&(null==(s=n.originalPost)?void 0:s.mediaUrl)||n.blobSrc||n.mediaUrl,j=i/(n.width||832),[y,b]=(0,F.useState)(v?[v]:[]),[w,k]=(0,F.useState)(null),[N,I]=(0,F.useState)({}),[C,S]=(0,F.useState)(!1),E=(null==g?void 0:g.videoUrl)||(null==g?void 0:g.mediaUrl),[_,z]=(0,F.useState)(!1),P=(0,F.useMemo)(()=>as().debounce(z,250),[]),A=(0,F.useMemo)(()=>E&&_?(0,tx.sU)(u,E):null,[E,_,u]),M=(0,F.useMemo)(()=>{var e;return C&&(!!A||!n.isGenerated||n.isGenerated&&(null!=(e=n.progress)?e:0)>=100)},[n.isGenerated,n.progress,A,C]);(0,F.useEffect)(()=>{let e=m.current;if(!e||!E)return;let t=new IntersectionObserver(e=>P(e.some(e=>e.isIntersecting)),{root:null,rootMargin:"0px",threshold:.1});return t.observe(e),()=>{e&&t.unobserve(e),t.disconnect(),P.cancel()}},[m,E]),(0,F.useEffect)(()=>{v&&b(e=>e.includes(v)?e:[...e,v])},[v]),(0,F.useEffect)(()=>{w&&b(e=>{let t=e.indexOf(w);return e.length>1&&-1!==t?e.slice(t):e})},[w,b]);let D=(0,aZ.B)(e=>e.smoothedVideoProgress[f.id]||e.smoothedVideoProgress[f.mediaPostId||""]),R=j*(n.height||1248);n.width&&n.height&&(R=i/(n.width/n.height));let T=(null==(l=f.userInteractionStatus)?void 0:l.likeStatus)===!0,B="number"==typeof D,O=B&&D<100,G=!!E||!!O,U=!!(B&&(O||!A)),q=!!(!C&&n.isGenerated);return(0,a.jsxs)("div",{ref:m,className:(0,h.cn)("relative group/media-post-masonry-card",C&&"hover:scale-[1.02] transition-transform duration-300 pointer-events-auto"),onClick:()=>{var e;if(!n.isGenerated||!((null!=(e=n.progress)?e:0)<100))ls("image_feed_image_selected",{source:{"imagine-feed":"feed","imagine-post":"rabbithole","imagine-favorites":"favorites"}[c.page]||"unknown"}),o({page:"imagine-post",postId:n.id})},children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,h.cn)(!C&&"hidden"),children:[y.map((e,t)=>(0,a.jsx)("img",{className:(0,h.cn)("opacity-".concat(N[e]||0," transition-opacity duration-500 ease-out rounded-2xl"),t>0&&"absolute top-0 left-0"),style:{width:i,height:R},onLoad:t=>{let s=t.target;x(n.id,s.width,s.height),S(!0),I(t=>({...t,[e]:1})),setTimeout(()=>{k(e)},500)},src:e,alt:"Generated image"},e)),U&&(0,a.jsxs)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-100 h-100",children:[(0,a.jsx)("svg",{className:"size-12 text-black/35 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:(0,a.jsx)("circle",{cx:"50%",cy:"50%",r:"50%",fill:"#5D7BE2",strokeWidth:"0"})}),(0,a.jsx)(a5.t,{progressPercentage:null!=D?D:0,size:60,thickness:7,trackClassName:"stroke-black/15",progressClassName:"stroke-white/90"}),(0,a.jsx)(d.jGG,{fill:"currentColor",strokeWidth:0,className:"animate-pulse size-6 text-white absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]},"progress"),C&&A&&(0,a.jsx)("video",{src:A,muted:!0,autoPlay:!0,controls:!1,loop:!0,poster:y[y.length-1]||void 0,style:{width:i,height:R},className:(0,h.cn)("absolute top-0 left-0 col-start-1 row-start-1  object-cover rounded-2xl","pointer-events-none"),children:r("video-unsupported.label","Your browser does not support the video tag.")})]}),(0,a.jsx)(e9.E,{pulse:q,className:(0,h.cn)("rounded-2xl",C&&"hidden"),style:{width:i,height:R}})]}),(0,a.jsx)("div",{className:M?"":"invisible",children:(0,a.jsx)(ll,{hasVideo:G,isLiked:T,postId:n.id})})]})}let ll=(0,F.memo)(e=>{let{hasVideo:t,isLiked:s,postId:l}=e,n=(0,aZ.B)(e=>e.like),i=(0,aZ.B)(e=>e.unlike),r=(0,aZ.B)(e=>e.generateVideoForImage),{t:o}=(0,p.Bd)("imagine");return(0,a.jsx)("div",{className:(0,h.cn)("absolute bottom-2 right-2","flex flex-row gap-2"),onClick:eZ.Y,children:t?(0,a.jsx)(eL.bJ,{tooltipContent:s?o("image-unlike-button.label","Unsave"):o("image-like-button.label","Save image"),className:(0,h.cn)("bg-black/25 hover:bg-white/10 border border-white/15 border-opacity-10","group-hover/media-post-masonry-card:opacity-100","opacity-0"),shape:"circle",size:"md",variant:"none",onClick:()=>s?i(l):n(l),children:(0,a.jsx)(d.C3E,{className:(0,h.cn)("size-4","text-white"),fill:s?"currentColor":"none",stroke:s?"none":"currentColor"})}):(0,a.jsx)(eL.bJ,{tooltipContent:o("image-make-video-button.label","Make video"),className:"bg-black/25 hover:bg-white/10 border border-white/15 border-opacity-10",shape:"circle",size:"md",variant:"none",onClick:()=>{ls("image_feed_video_generation_started",{location:"imagine-grid-card",mode:"normal",source:"feed_video_button"}),r(l,"normal").then(()=>ls("image_feed_video_generated",{location:"imagine-grid-card",mode:"normal"})).catch(e=>{ls("image_feed_video_generation_error",{location:"imagine-grid-card",mode:"normal"}),(0,w.vV)("imagine-grid-card",e)})},children:(0,a.jsx)(d.jGG,{fill:"currentColor",strokeWidth:0,className:"size-4 text-white"})})})});var ln=s(56078);let li=[];function lr(e){let{prompt:t,scrollContainerRef:s,postId:a,freezeLoading:l,width:n,height:i,isInitial:r,positionerConfig:o}=e,{masonryRender:c}=function(e){var t,s;let{prompt:a,scrollContainerRef:l,postId:n,freezeLoading:i,width:r,height:o,isInitial:c,positionerConfig:d}=e,u=(0,F.useRef)(0),m=(0,F.useRef)(null),{items:f,maybeLoadMore:x}=function(e){var t,s;let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,r=(0,aZ.B)(e=>e.switchContext),o=(0,aZ.B)(e=>e.fetchImageGen),c=(0,aZ.B)(e=>e.fetchImageGenMore),d=e+(l?"-".concat(l):""),u=(0,aZ.B)(e=>e.firstFetchStatus[d]),m=null!=(s=(0,aZ.B)(e=>e.byPrompt[d]))?s:li,h=(0,F.useRef)(!1),f=(0,F.useRef)(a);f.current=a;let x=m&&(null==(t=m[0])?void 0:t.blobSrc)?m[0]:null,p=(0,F.useMemo)(()=>{var t,s;return null!=(s=null!=(t=null==x?void 0:x.prompt)?t:e)?s:""},[x,e]),g=(0,F.useCallback)((e,t)=>f.current||!t,[f]),v=(0,F.useCallback)(async()=>{p&&a&&await c(p,d,g)},[c,p,a,d,g]),j=function(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=(0,F.useRef)(!1),l=(0,F.useRef)(!1),n=(0,F.useRef)(0),i=(0,F.useRef)(2),r=(0,F.useRef)(0),o=(0,F.useRef)(0);(0,F.useEffect)(()=>(l.current=!0,()=>{l.current=!1}),[]),r.current=Math.max(t,r.current);let c=(0,F.useCallback)(async(t,c)=>{if(c>-1&&(o.current=c),!a.current&&s){for(a.current=!0;l.current&&o.current+2>=r.current;){if(n.current>=i.current){await new Promise(e=>setTimeout(e,100));continue}r.current+=4,e().then(()=>{n.current--}).catch(e=>{n.current--,(0,w.vV)("useInfiniteImagineLoader:fetchMoreFn",e)}),n.current++}a.current=!1}},[e,s]);return(0,F.useEffect)(()=>{s&&l.current&&o.current+2>=r.current&&c(-1,-1).catch(e=>{(0,w.vV)("useInfiniteImagineLoader:fetcher",e)})},[s,c,l,o,r]),c}(v,m.length,"complete"===u);return(0,F.useEffect)(()=>{!h.current&&(h.current=!0,a&&("complete"===u?p&&r(p):e&&!u&&o(e,!!n,d,g).then(()=>{}).catch(e=>{(0,w.vV)("useImageGenQuery:fetchImageGen",e)})))},[e,a,l,d,n,g,u,p]),{items:(0,F.useMemo)(()=>{let e=m;if(a){e=m;let t=i?m.length%i:0,s=i;t&&i&&(s=i-t),e=[...m,...Array(s).fill(null).map((e,t)=>({id:"placeholder-".concat(t),progress:0,mediaUrl:""}))]}else if(e=m.filter(e=>100===e.progress),i){let t=e.length%i;e.length=e.length-t}return e},[m,a,i]),fetchMore:v,maybeLoadMore:j,fullPrompt:p}}(a,!i,n,c,u.current),p=(0,F.useRef)(1),{offset:g}=(0,ln.Y)(m,[Math.random()]),{scrollTop:v,isScrolling:j}=(0,a1.a)(l,{offset:g-100});j&&(p.current=2);let y=(0,F.useRef)(f.length),b=(0,aQ.i)({width:r,...lo,...d},[a,r,f.length<y.current]);y.current=f.length,u.current=b.columnCount;let k=(o||832)-Math.max(0,null!=(s=null==(t=m.current)?void 0:t.getBoundingClientRect().top)?s:0),N=(0,aX.w)(b);return{masonryRender:(0,aJ.P)({className:(0,h.cn)("max-w-[646px] mx-auto min-h-[90vh]",i?"min-h-10":"min-h-[100vh]"),positioner:b,resizeObserver:N,scrollTop:v,isScrolling:j,height:k,overscanBy:p.current,itemHeightEstimate:650,containerRef:m,items:f,render:la,onRender:i?void 0:x,role:"list"})}}({prompt:t,scrollContainerRef:s,postId:a,freezeLoading:l,width:n,height:i,isInitial:r,positionerConfig:o});return c}let lo={columnGutter:8,maxColumnCount:2};function lc(e){let{prompt:t,widthStyle:s="full"}=e,[l,n]=(0,F.useState)(!1);return t?(0,a.jsx)("div",{onClick:()=>n(!0),className:(0,h.cn)("border-border-l2 border bg-surface-l1 rounded-full px-4 py-2","fit"===s&&"w-fit",!l&&"truncate rounded-full",l&&"rounded-3xl"),children:null!=t?t:"Nothing"}):null}let ld=e=>{let t=0;do t+=e.offsetTop||0,e=e.offsetParent;while(e);return t},lu=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!t)return;let a=t.scrollTop,l=performance.now(),n=1/60,i=r=>{let o=(r-l)/1e3;l=r;let c=ld(e)-s,d=1-Math.pow(.9,o/n);t.scrollTop=a+=(c-a)*d,Math.abs(a-c)>2&&requestAnimationFrame(i)};requestAnimationFrame(i)},lm=(e,t)=>{(0,F.useEffect)(()=>{let s=e.current,a=()=>{var e;let a=null!=(e=null==s?void 0:s.scrollTop)?e:0;aZ._.setState(e=>({...e,scrollPositionByPageId:{...e.scrollPositionByPageId,[t]:a}}))};if(s){let e=aZ._.getState().getScrollPosition(t);e&&(s.scrollTop=e),s.addEventListener("scroll",a)}return()=>{s&&s.removeEventListener("scroll",a)}},[e,t])};function lh(e,t){(0,w.iu)(e,void 0,{location:"imagine-feed",...t})}function lf(e){let{variant:t="default"}=e,s=(0,Q.h)(),l=(0,aZ.B)(e=>e.homeGenPrompts),n=(0,aZ.B)(e=>e.pushHomeGenPrompt),i=(0,aZ.B)(e=>e.resetImageGen),r=(0,aZ.B)(e=>e.clearHomeGenPrompts),o="default"===t&&l.length>0,c=(0,F.useCallback)(e=>{n(e),o||i()},[o,n,i]),d=l.length>0&&"default"===t?"query":t;return((0,F.useEffect)(()=>{let e=e=>{"Escape"===e.key&&("favorites"===d&&window.history.back(),"query"===d&&(i(),r()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r,i,d]),(0,F.useEffect)(()=>{"favorites"===d?lh("image_feed_gallery_opened"):"default"===d&&lh("image_feed_opened")},[d]),s.SHOW_IMAGINE)?(0,a.jsx)(lx,{variant:d,querys:l,setQuery:c},d):(0,a.jsx)(aH.default,{})}function lx(e){let{variant:t,querys:s,setQuery:l}=e,{t:n}=(0,p.Bd)("base"),i=(0,F.useRef)(null),r=(0,F.useRef)(null),o=(0,J.tg)({ref:r}),{width:c,height:m}=(0,a0.X)(r),h=(0,aZ.B)(e=>e.clearHomeGenPrompts),f=Math.min(c,"query"===t?1070:2290);lm(r,"imagine-page"+t);let{user:x}=(0,u.useSession)(),g=(0,F.useMemo)(()=>{let e="";return"favorites"===t&&(e=n("imagine-favorites-title","Favorites")),e&&(e=" / "+e),e},[t,n]);return(0,a.jsxs)("div",{className:"px-3 w-full relative",ref:i,children:[(0,a.jsx)(lt.g,{conversationId:void 0,containerRef:i,user:x,imageAttachmentsOnly:!0}),(0,a.jsxs)("div",{className:"flex flex-col w-full h-screen overflow-scroll items-center",ref:e=>{r.current=e},style:{scrollbarWidth:"none",...o},children:[(0,a.jsxs)("div",{className:"py-3 flex items-center gap-3 h-[4rem] w-full top-0",children:["favorites"===t||"query"===t?(0,a.jsx)(eL.$n,{variant:"secondary",shape:"circle",size:"md","aria-label":n("imagine-back-button.label","Back"),onClick:"query"===t?h:()=>{window.history.back()},children:(0,a.jsx)(d.nkM,{className:"size-4"})}):null,(0,a.jsxs)("h1",{className:"text-lg font-semibold",children:[(0,a.jsx)("span",{className:"text-primary",children:n("imagine-title","Imagine")}),g&&(0,a.jsx)("span",{className:"text-secondary",children:g})]})]}),(0,a.jsx)("div",{style:{maxWidth:"".concat(f,"px")},className:"w-full",children:"query"===t?(0,a.jsx)(lv,{queries:s,scrollContainerRef:r,postId:"home-grid",width:f,height:m}):(0,a.jsx)(lg,{containerRef:r,variant:t,width:f,height:m})})]}),(0,a.jsx)("div",{className:"absolute bottom-0 w-full p-3",children:(0,a.jsx)(le,{setQuery:l,showFavorites:"favorites"!==t})})]})}function lp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{width:e,columnWidth:250,maxColumnWidth:t?350:450,columnGutter:10,maxColumnCount:t?3:5}}function lg(e){let{containerRef:t,variant:s,width:a,height:l}=e,n="favorites"===s?a2.ZW.MediaPostSourceLiked:a2.ZW.MediaPostSourcePublic,i=(0,aZ.B)(e=>e.fetchListMediaPosts),r=(0,aY.H)(()=>i({source:n}),{});(0,F.useEffect)(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100),o.length||i({source:n}).catch((0,w.HX)("imagine-page"))},[]);let o=(0,aZ.B)(e=>"favorites"===s?e.favoritesList:e.list),c=(0,F.useRef)(o.length),d=(0,aQ.i)(lp(a),[o.length<c.current,a,l]);c.current=o.length;let u=(0,aX.w)(d),{scrollTop:m,isScrolling:h}=(0,a1.a)(t);return(0,aJ.P)({positioner:d,resizeObserver:u,scrollTop:m,isScrolling:h,height:l||832,itemHeightEstimate:832,containerRef:t,items:o,render:la,onRender:r,overscanBy:"query"===s?1:2,itemKey:e=>e.id,role:"list"})}function lv(e){let{queries:t,scrollContainerRef:s,postId:l,width:n,height:i}=e,r=(0,F.useRef)(t.length);return(0,F.useEffect)(()=>{t.length<=1||r.current===t.length||setTimeout(()=>{let e="imagine-masonry-section-".concat(t.length-1),a=document.getElementById(e);a&&lu(a,s.current,80)},350)},[t.length,s,r]),(0,a.jsx)("div",{children:t.map((e,r)=>(0,a.jsxs)("div",{id:"imagine-masonry-section-".concat(r),className:"flex flex-col gap-3",children:[(0,a.jsx)(lc,{prompt:e,widthStyle:"fit"}),(0,a.jsx)(lr,{prompt:e,scrollContainerRef:s,postId:l,width:n,height:i,positionerConfig:lp(n,!0),freezeLoading:r<t.length-1})]},"imagine-masonry-section-".concat(r)))})}var lj=s(94748),ly=s.n(lj),lb=s(6132),lw=s(77232);function lk(e){let{value:t,onValueChange:s,className:l}=e,{t:n}=(0,p.Bd)("imagine"),i=(0,X.Di)();return(0,a.jsxs)("div",{className:(0,h.cn)("flex p-0  backdrop-blur-lg rounded-full border border-white/15 border-opacity-5",{"gap-0":i},l),"aria-label":"Text alignment",onClick:()=>s("video"===t?"image":"video"),children:[(0,a.jsxs)(eL.$n,{shape:"circle",size:"sm",variant:"video"===t?"secondary":"tertiary",className:(0,h.cn)("text-white","video"===t?"bg-white/15 backdrop-blur-sm hover:bg-white/15":"bg-transparent hover:bg-white/10 text-white/40 hover:text-white"),onClick:()=>s("video"),children:[(0,a.jsx)(d.Lc_,{className:"size-4"}),(0,a.jsx)("span",{className:(0,h.cn)("font-semibold sr-only","video"===t?"text-primary":"text-secondary"),children:n("imagine-post-tab.video","Video")})]}),(0,a.jsxs)(eL.$n,{shape:"circle",size:"sm",variant:"image"===t?"secondary":"tertiary",className:(0,h.cn)(" text-white","image"===t?"bg-white/15 backdrop-blur-sm hover:bg-white/15":"bg-transparent hover:bg-white/10 text-white/40 hover:text-white"),onClick:()=>s("image"),children:[(0,a.jsx)(d._V3,{className:"size-4"}),(0,a.jsx)("span",{className:(0,h.cn)("font-semibold sr-only","image"===t?"text-primary":"text-secondary"),children:n("imagine-post-tab.image","Image")})]})]})}let lN=F.memo(function(e){let t,s,{mediaId:l,imageWidth:n,imageHeight:i,imageSrc:r,videoSrc:o,audioSrc:c,className:u,videoPlayingRef:m}=e,{t:f}=(0,p.Bd)("imagine"),[x,g]=(0,F.useState)(o?"video":"image"),v=(0,F.useRef)(null),j=(0,F.useRef)(null),[y,b]=(0,F.useState)(!0);(0,F.useEffect)(()=>{m&&(m.current="video"===x)},[m,x]),(0,F.useEffect)(()=>{if(o){var e;g("video"),null==(e=v.current)||e.load()}},[o]),(0,F.useEffect)(()=>{v.current&&("image"===x?v.current.pause():"video"===x&&v.current.play())},[x]),(0,F.useEffect)(()=>{let e=v.current,t=j.current;if(!e||!t)return;let s=()=>{t.play(),t.currentTime=e.currentTime},a=()=>t.pause(),l=()=>{t.currentTime=e.currentTime},n=()=>{t.pause(),t.currentTime=0};return e.addEventListener("play",s),e.addEventListener("pause",a),e.addEventListener("seeking",l),e.addEventListener("ended",n),()=>{e.removeEventListener("play",s),e.removeEventListener("pause",a),e.removeEventListener("seeking",l),e.removeEventListener("ended",n)}},[]);let w=(0,F.useCallback)(()=>{let e=v.current,t=j.current;if(!t||!e)return;let s=!y;e.muted=s,t.muted=s,b(s),s||e.paused||(t.play(),t.currentTime=e.currentTime)},[y,v,j]),k=(0,aZ.B)(e=>e.setImageDimensions),N=(0,F.useCallback)(e=>{let t=e.target;k(l,t.width,t.height)},[k,l]),I=(0,F.useMemo)(()=>(null!=n?n:832)/(null!=i?i:1248),[n,i]),C=(0,F.useRef)(null),S=window.innerHeight-160,{width:E}=(0,a0.X)(C);return I>E/S?(t=E,s=E/I):(s=S,t=S*I),(0,a.jsx)("div",{className:"w-full",ref:C,children:(0,a.jsxs)("div",{className:(0,h.cn)("relative mx-auto overflow-hidden rounded-2xl",u),style:{width:t,height:s},children:[(0,a.jsxs)("div",{className:"grid",children:[(0,a.jsx)("img",{onLoad:N,src:r,className:(0,h.cn)("col-start-1 row-start-1 w-full h-full object-cover","image"!==x&&"invisible pointer-events-none"),alt:f("generic-image-alt","Generated image")}),o&&(0,a.jsx)("video",{ref:v,src:o,muted:!0,autoPlay:!0,controls:!1,loop:!0,poster:r,className:(0,h.cn)("col-start-1 row-start-1 w-full h-full object-cover","video"!==x&&"invisible pointer-events-none"),children:f("video-unsupported.label","Your browser does not support the video tag.")})]}),o&&c&&(0,a.jsx)("audio",{ref:j,src:c,muted:y,loop:!0,className:"hidden",children:f("audio-unsupported.label","Your browser does not support the audio tag.")}),(0,a.jsx)(lk,{value:x,onValueChange:g,className:(0,h.cn)("absolute bottom-0 left-0 m-2",{hidden:!o})}),(0,a.jsxs)(eL.$n,{shape:"circle",size:"sm",variant:"secondary",className:(0,h.cn)("text-white absolute bottom-2 right-2 bg-white/15 backdrop-blur-sm hover:bg-white/15","border border-white/15 border-opacity-5","video"!==x&&"hidden"),onClick:w,children:[y?(0,a.jsx)(d.ysl,{className:"size-4"}):(0,a.jsx)(d.jIq,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:y?f("video-mute-button.label","Mute"):f("video-unmute-button.label","Unmute")})]})]})})});var lI=s(28245),lC=s(4295);let lS=[""];function lE(e,t){(0,w.iu)(e,void 0,{location:"imagine-rabbithole",...t})}function l_(){let e=(0,Q.h)(),{route:t}=(0,L.wK)(),s="imagine-post"===t.page?t.postId:(0,ej.Z)("only for imagine post page"),l=(0,aZ.B)(e=>e.postPageSections[s])||lS,n=(0,aZ.B)(e=>e.pushPostPageSection),i=(0,lC.c)(),r=(0,aZ.B)(e=>!!(e.byId[s]||e.favoritesById[s])),o=i&&!r&&!e.DISABLE_IMAGINE_SHARE_APP_REDIRECT;return!e.SHOW_IMAGINE||o?(0,a.jsx)(aH.default,{}):(0,a.jsxs)("div",{className:"w-full relative",children:[(0,a.jsx)(lz,{queries:l}),(0,a.jsx)("div",{className:"absolute left-0 bottom-0 w-full p-3",children:(0,a.jsx)(le,{setQuery:e=>n(s,e),showFavorites:!0,navigateOnQuery:!1})})]},s)}function lz(e){var t,s,l,n,i,r,o,c,u;let{queries:m}=e,{ASSET_SERVER_URL:h}=(0,tj.v)(),{t:f}=(0,p.Bd)("imagine"),{route:x,push:g}=(0,L.wK)(),v="imagine-post"===x.page?x.postId:(0,ej.Z)("only for imagine post page"),j=(0,aZ.B)(e=>e.fetchMediaPost),{isErrored:y,isLoading:b}=(0,aS.v)(j(v)),w=(0,aZ.B)(e=>e.byId[v]||e.favoritesById[v]),k=(0,aZ.B)(e=>{var t;return(null!=(t=e.videoByMediaId[v])?t:[]).findLast(e=>(null==e?void 0:e.progress)===100)});(null==w||null==(t=w.mimeType)?void 0:t.includes("video"))&&(k=w),(0,F.useEffect)(()=>{let e=e=>{"Escape"===e.key&&window.history.back()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let N=(null==k?void 0:k.videoUrl)||(null==k?void 0:k.mediaUrl),I=null==k||null==(s=k.audioUrls)?void 0:s[0],C=null!=(o=null==k?void 0:k.id)?o:null==k?void 0:k.videoId,S=(0,F.useRef)(!1),E=(0,F.useRef)(null),_=(0,F.useRef)(null),{width:z}=(0,a0.X)(_),{height:P}=(0,a0.X)(E),A=(0,F.useRef)(m.length);lm(E,v),(0,F.useEffect)(()=>{if(m.length<=1||A.current===m.length)return;let e=setTimeout(()=>{let e="imagine-masonry-section-".concat(m.length-1),t=document.getElementById(e);t&&lu(t,E.current,80)},350);return()=>clearTimeout(e)},[A,m.length]);let M=(0,J.tg)({ref:E,direction:"bottom"});if((0,F.useEffect)(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)},[g,w]),b&&!w)return"loading";if(!w)return"not found";let D=(null==(l=w.mimeType)?void 0:l.includes("video"))&&(null==(n=w.originalPost)?void 0:n.mediaUrl),R=D?null==(i=w.originalPost)?void 0:i.mediaUrl:null!=(c=w.blobSrc)?c:w.mediaUrl,T=D&&null!=(u=null==(r=w.originalPost)?void 0:r.prompt)?u:w.prompt;return(0,a.jsxs)("main",{className:"w-full h-dvh relative overflow-y-auto",style:{scrollbarWidth:"none",...M},ref:E,children:[(0,a.jsx)("div",{className:"h-0 sticky top-0 z-10 flex flex-row",children:(0,a.jsx)(eL.$n,{variant:"secondary",shape:"circle",size:"md","aria-label":f("imagine-back-button.label","Back"),onClick:()=>window.history.back(),className:"sticky top-0 !bg-surface-l1 z-10 mt-2 mx-2",children:(0,a.jsx)(d.nkM,{className:"size-4"})})}),(0,a.jsxs)("article",{className:"max-w-[646px] my-4  mx-auto flex flex-col gap-4",ref:_,children:[(0,a.jsx)("div",{children:(0,a.jsx)(lN,{mediaId:w.id,imageWidth:w.width,imageHeight:w.height,imageSrc:R||"",videoSrc:(0,tx.sU)(h,N),audioSrc:(0,tx.sU)(h,I),videoPlayingRef:S})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(lD,{post:w}),(0,a.jsx)(lM,{post:w,videoPlayingRef:S,videoUrl:N}),(0,a.jsx)(lR,{post:w,videoPlayingRef:S,videoId:C})]}),(0,a.jsx)(lA,{post:w})]}),T&&(0,a.jsx)(a.Fragment,{children:m.map((e,t)=>(0,a.jsxs)("div",{id:"imagine-masonry-section-".concat(t),className:"flex flex-col gap-4",children:[(0,a.jsx)(lc,{prompt:e||T,widthStyle:0===t?"full":"fit"}),(0,a.jsx)(lr,{isInitial:0===t,width:z,height:P,prompt:e||(null!=T?T:""),scrollContainerRef:E,postId:v+t,freezeLoading:t<m.length-1})]},"imagine-masonry-section-".concat(t)))})]})]})}let lP=lb.z.object({display_name:lb.z.string(),mode_name:lb.z.string(),is_mature:lb.z.boolean().optional()});function lA(e){let{post:t}=e,{t:s}=(0,p.Bd)("imagine"),{replace:l}=(0,L.wK)(),n=(0,aZ.B)(e=>ly()(e.videoByMediaId[t.id])),i=(0,aZ.B)(e=>e.fetchMediaPost),r=(0,aZ.B)(e=>e.generateVideoForImage),o=(0,tg.C$)(e=>e.setShowAgeVerification),c=(0,tg.C$)(e=>e.setAgeVerificationCallback),u=(0,tg.C$)(e=>e.ageVerificationCallback),{stage:m}=(0,lI.S)(),f=function(){let e=(0,Q.h)(),{stage:t}=(0,lI.S)();return(0,F.useMemo)(()=>{let s=[];for(let a of e.MEDIA_GEN_VIDEO_CONFIG.get("media_gen_video_prompt_available_modes",[])){let e=lP.safeParse(a);e.success&&("nopass"!==t||!e.data.is_mature)&&s.push(e.data)}return s},[e.MEDIA_GEN_VIDEO_CONFIG,t])}(),x=(0,aZ.B)(e=>e.smoothedVideoProgress[t.id]||e.smoothedVideoProgress[t.mediaPostId||""]),g=e=>{let s=()=>{var s,a,n;lE("image_feed_video_generation_started",{location:"imagine-post-page",mode:e.mode_name,source:"lightbox"});let o=null==(s=t.originalPost)?void 0:s.id;if(o)return void i(o).then(t=>{var s,a;r(null!=(a=null==(s=t.originalPost)?void 0:s.id)?a:t.id,e.mode_name).then(()=>lE("image_feed_video_generated",{location:"imagine-post-page",mode:e.mode_name})).catch(t=>{lE("image_feed_video_generation_error",{location:"imagine-post-page",mode:e.mode_name}),(0,w.vV)("imagine-post-page",t)}),l({page:"imagine-post",postId:t.id})}).catch(e=>{lE("image_feed_video_generation_error",{location:"imagine-post-page",message:"failed to fetch original post"}),(0,w.vV)("imagine-post-page",e)});r(null!=(n=null==(a=t.originalPost)?void 0:a.id)?n:t.id,e.mode_name).then(()=>lE("image_feed_video_generated",{location:"imagine-post-page",mode:e.mode_name})).catch(t=>{lE("image_feed_video_generation_error",{location:"imagine-post-page",mode:e.mode_name}),(0,w.vV)("imagine-post-page",t)})};if(!e.is_mature||"pass"===m)return void s();let a=()=>{s(),u===a&&c(void 0)};c(a),o(!0)};if("number"==typeof(null==n?void 0:n.progress)&&n.progress<100)return(0,a.jsxs)(eL.$n,{shape:"pill",size:"md",variant:"secondary",className:(0,h.cn)(n&&"cursor-progress"),children:[(0,a.jsx)(d.jGG,{fill:"currentColor",strokeWidth:0,className:"size-4"}),(0,a.jsx)("span",{className:"w-[4ch]","aria-live":"polite",role:"status","aria-label":s("image-make-video-progres.aria","Video generation progress: {{progressValuePercentage}}%",{progressValuePercentage:n.progress}),children:s("image-make-video-progress.label","{{progressValuePercentage}}%",{progressValuePercentage:Math.round(null!=x?x:0)})})]});if(n)return(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(eL.$n,{shape:"pill",size:"md",variant:"secondary",className:"group",children:[(0,a.jsx)(d.jGG,{fill:"currentColor",strokeWidth:0,className:"size-4"}),s("video-redo-button.label","Redo"),(0,a.jsx)(d.yQN,{className:"size-4 group-data-[state=open]:rotate-180 transition-rotate duration-200"})]})}),(0,a.jsx)(e_.SQ,{align:"end",side:"bottom",children:f.map(e=>(0,a.jsx)(e_._2,{onSelect:()=>g(e),children:e.display_name},e.mode_name))})]});let v=f.find(e=>"normal"===e.mode_name)||f[0];return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)(eL.$n,{shape:"pill",size:"md",variant:"secondary",onClick:()=>v&&g(v),className:"rounded-e-none border-r border-border-l2 pe-2",children:[(0,a.jsx)(d.jGG,{fill:"currentColor",strokeWidth:0,className:"size-4"}),s("image-make-video-button.label","Make video")]}),(0,a.jsxs)(e_.rI,{children:[(0,a.jsx)(e_.ty,{asChild:!0,children:(0,a.jsxs)(eL.$n,{shape:"pill",size:"md",variant:"secondary",className:"group rounded-s-none border-s-0 ps-2 pe-3",children:[(0,a.jsx)(d.yQN,{className:"size-4 group-data-[state=open]:rotate-180 transition-rotate duration-200"}),(0,a.jsx)("span",{className:"sr-only",children:s("video-generation-model-selector.label","Pick style")})]})}),(0,a.jsx)(e_.SQ,{align:"end",side:"bottom",children:f.map(e=>(0,a.jsx)(e_._2,{onSelect:()=>g(e),children:e.display_name},e.mode_name))})]})]})}function lM(e){let{post:t,videoPlayingRef:s,videoUrl:l}=e,{t:n}=(0,p.Bd)("imagine"),{ASSET_SERVER_URL:i}=(0,tj.v)();return(0,a.jsxs)(eL.$n,{shape:"circle",size:"md",variant:"secondary",onClick:()=>{lE("image_feed_image_saved");let e=s.current?l:t.mediaUrl,a=(0,tx.sU)(i,e),n=s.current?"grok-video-".concat(t.id,".mp4"):"grok-image-".concat(t.id,".png");(0,t_.G)(a,n,!1).catch(e=>{(0,w.vV)("imagine-post-page:downloadImage",e)})},children:[(0,a.jsx)(d.f5X,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:n("image-download-button.label","Download image")})]})}function lD(e){var t;let{post:s}=e,{t:l}=(0,p.Bd)("imagine"),n=(0,aZ.B)(e=>e.like),i=(0,aZ.B)(e=>e.unlike),r=(null==(t=s.userInteractionStatus)?void 0:t.likeStatus)===!0;return(0,a.jsxs)(eL.$n,{shape:"circle",size:"md",variant:"secondary",onClick:async()=>{r?await i(s.id):await n(s.id),r||lE("image_feed_image_liked")},children:[(0,a.jsx)(d.C3E,{className:(0,h.cn)("size-4",r&&"text-red-400 dark:text-red-500"),fill:r?"currentColor":"none",stroke:r?"none":"currentColor"}),(0,a.jsx)("span",{className:"sr-only",children:r?l("image-unlike-button.label","Unsave"):l("image-like-button.label","Save image")})]})}function lR(e){let{post:t,videoPlayingRef:s,videoId:l}=e,{t:n}=(0,p.Bd)("imagine"),i=(0,X.Di)(),{route:r}=(0,L.wK)(),o=(0,aZ.B)(e=>e.resolveMediaPostForMaybeGenerated),c=async()=>{var e;let a,i=(0,L.KQ)(r,window.location.origin),c=await o(t);if(s.current&&l){let e=new URL(i);e.pathname=e.pathname.replace(/\/post\/[^\/]+$/,"/post/".concat(l)),a=e.toString()}else if(c&&!i.includes(c.id)){let e=new URL(i);e.pathname=e.pathname.replace(/\/post\/[^\/]+$/,"/post/".concat(c.id)),a=e.toString()}else a=i;(0,lw.g)(a,n("image-share-copy-link-success","Public link copied")),lE("image_feed_media_shared",{type:"copy_link",media:s.current?"video":"image",post_id:null!=(e=null==c?void 0:c.id)?e:t.id,post_link:a})};return(0,a.jsxs)(eL.gx,{shape:i?"circle":"pill",size:"md",variant:"secondary",onClick:c,tooltipContent:n("image-share-button.public-warning","Anyone with the link can view this"),tooltipContentProps:{side:"bottom"},children:[(0,a.jsx)(d.SYj,{className:"size-4"}),(0,a.jsx)("span",{className:(0,h.cn)(i&&"sr-only"),children:n("image-share-button.label","Share")})]})}function lT(){(function(){let{route:e,push:t}=(0,L.wK)(),{user:s}=(0,u.useSession)();(0,F.useEffect)(()=>n.aP.subscribe((a,l)=>{if(!a.conversationId||a.conversationId===l.conversationId||"chat"===e.page&&e.conversationId!==a.conversationId||"main"!==e.page)return;let n=tg.C$.getState().isIncognito||!s;t({page:"chat",conversationId:n?null:a.conversationId,temporary:n})}),[t,e,s])})(),function(){let{route:e}=(0,L.wK)();(0,F.useEffect)(()=>{let{conversationMode:t,voiceConnectionStatus:s,exitVoiceMode:a}=n.aP.getState();"voice"!==t||"disconnecting"===s||["main","chat"].includes(e.page)||a("navigation").catch(e=>(0,w.vV)("page:handleVoiceModeExit",e))},[e.page])}(),(0,eg.YT)();let{SHOW_FINANCIAL_PAGE:e}=(0,Q.h)(),t=(0,aV.n)(),{route:s}=(0,L.wK)();switch((0,F.useEffect)(()=>{let e=(0,L.KQ)(s,window.location.origin),t=document.querySelector("head link[rel='canonical']");return t||((t=document.createElement("link")).rel="canonical",document.head.appendChild(t)),t.href=e,()=>{let e=document.querySelector("head link[rel='canonical']");e&&document.head.removeChild(e)}},[s]),s.page){case"main":case"chat":return(0,a.jsx)(l.A,{});case"history":if(t)return(0,a.jsx)(a$,{});return(0,a.jsx)(D.default,{});case"workspace":return(0,a.jsx)(sz.w8,{workspaceId:s.workspaceId});case"workspaces":return(0,a.jsx)(sz.TP,{});case"files":return(0,a.jsx)(s_,{});case"tasks":return(0,a.jsx)(ed,{});case"images":case"unknown":default:return(0,a.jsx)(D.default,{});case"plans":return(0,a.jsx)(O,{});case"finance":if(e)return(0,a.jsx)(aR,{});return(0,a.jsx)(D.default,{});case"faq":return(0,a.jsx)(ew,{});case"share-links":return(0,a.jsx)(K,{});case"deleted-conversations":return(0,a.jsx)(M,{});case"imagine":return(0,a.jsx)(lf,{});case"imagine-favorites":return(0,a.jsx)(lf,{variant:"favorites"});case"imagine-post":return(0,a.jsx)(l_,{})}}},59886:(e,t,s)=>{"use strict";s.d(t,{t:()=>l});var a=s(79342);s(88382);let l=e=>{let{trackClassName:t,progressClassName:s,size:l,thickness:n,progressPercentage:i,offsetDegrees:r=0}=e,o=100/l*n,c=50-o/2,d=2*Math.PI*c,u=1-i/100,m=d*u,h=n/2;m+=h*(1-u*u);let f=-90+h/d*180+r;return(0,a.jsx)("svg",{width:l,height:l,viewBox:"0 0 100 100",children:(0,a.jsxs)("g",{transform:"rotate("+f+" 50 50)",children:[(0,a.jsx)("circle",{cx:"50",cy:"50",r:c,strokeWidth:o,fill:"none",className:t}),i>=100?(0,a.jsx)("circle",{cx:"50",cy:"50",r:c,strokeWidth:o,fill:"none",className:s}):i>0?(0,a.jsx)("circle",{opacity:function(e,t,s){return Math.min(Math.max((s-0)/(1.5-e),0),1)}(0,1.5,i),cx:"50",cy:"50",r:c,strokeWidth:o,fill:"none",className:s,strokeDasharray:"".concat(d," ").concat(d),strokeDashoffset:m,strokeLinecap:"round"}):null]})})}},62227:(e,t,s)=>{"use strict";s.d(t,{N:()=>c});var a=s(79342),l=s(11750),n=s(27636),i=s(88382),r=s(65146);let o=e=>{let{task:t,iconPosition:s="left"}=e,{getScheduleLabel:r}=(0,n.Ay)(),o=i.useMemo(()=>t&&t.taskCadence&&t.timeOfDay&&t.timezone?r(t.taskCadence,t.timeOfDay,t.timezone,t.dayOfWeek,t.dayOfMonth,t.dayOfYear):"",[t,r]);return(0,a.jsxs)("h1",{className:"text-sm font-semibold text-fg-primary flex items-center gap-1 line-clamp-1",children:["left"===s&&(0,a.jsx)(l.kM6,{size:14}),(0,a.jsx)("p",{className:"text-sm font-medium line-clamp-1",children:o}),"right"===s&&(0,a.jsx)(l.kM6,{size:14})]})},c=e=>{let{task:t,isScheduled:s,iconPosition:n="left"}=e,{t:i}=(0,r.Bd)("tasks");return s?(0,a.jsx)(o,{task:t,iconPosition:n}):(0,a.jsxs)("p",{className:"flex items-center gap-1 text-sm font-medium text-yellow-200",children:[(0,a.jsx)(l.J0U,{size:14})," ",i("task-card.not-scheduled","Paused")]})}},70154:(e,t,s)=>{Promise.resolve().then(s.bind(s,55410))},87549:(e,t,s)=>{"use strict";s.d(t,{B:()=>o});var a=s(79342),l=s(16538),n=s(34323),i=s(16506),r=s(88382);let o=e=>{let{syntax:t,value:s,isStreaming:o,editable:c,autofocus:d,onContentUpdate:u}=e,m=(0,r.useRef)(void 0),[h,f]=(0,r.useState)(!1),x=(0,r.useRef)(null),{resolvedTheme:p}=(0,i.D)();(0,r.useEffect)(()=>{(0,l.q)()},[]);let g=(0,r.useCallback)((e,t)=>{t.isFlush||u(e)},[u]),v=(0,r.useCallback)(e=>{x.current=e,f(!0)},[]);(0,r.useEffect)(()=>{let e=x.current;if(h&&e&&c&&d){var t,s;let a={lineNumber:1,column:(null!=(s=null==(t=e.getModel())?void 0:t.getLineLength(1))?s:0)+1};e.setPosition(a),e.focus()}},[h,d]),(0,r.useEffect)(()=>{let e=x.current;if(!e||!l.x||!o)return;let t=e.getValue(),a=e.getModel();if(!a)return;if(!s.includes(t))return void e.setValue(s);let n=s.substring(t.length),i=a.getPositionAt(t.length);e.executeEdits("stream-update",[{range:new l.x.Range(i.lineNumber,i.column,i.lineNumber,i.column),forceMoveMarkers:!0,text:n}])},[h,s,o]);let j=(0,r.useCallback)(()=>{m.current&&m.current();let e=null===l.x||void 0===l.x?void 0:l.x.editor.getEditors()[0];if(e){var t;let s=e.getSelection();if(!s)return;if(null==(t=e.getModel())?void 0:t.getValueInRange(s)){let t=document.createElement("div"),a={getId:()=>"selected-text.widget",getDomNode:()=>t,getPosition:()=>l.x?{position:{lineNumber:s.endLineNumber,column:s.startColumn},preference:[l.x.editor.ContentWidgetPositionPreference.BELOW,l.x.editor.ContentWidgetPositionPreference.ABOVE]}:{position:{lineNumber:s.endLineNumber,column:s.startColumn},preference:[]}};e.addContentWidget(a),m.current=()=>e.removeContentWidget(a)}}},[]),y=(0,r.useMemo)(()=>({contextmenu:!1,suggestOnTriggerCharacters:!1,acceptSuggestionOnEnter:"off",lineNumbers:"on",readOnly:!c,quickSuggestions:!1,fontFamily:"var(--font-ibm-plex-mono)",fontSize:14,stickyScroll:{enabled:!1},wordBasedSuggestions:"off",wordWrap:"on",automaticLayout:!0,parameterHints:{enabled:!1},hover:{enabled:!1},minimap:{enabled:!1},scrollbar:{useShadows:!1},scrollBeyondLastLine:!1,padding:{bottom:30}}),[c]),b=(0,r.useCallback)(e=>{e.languages.register({id:"latex"}),e.languages.setMonarchTokensProvider("latex",{tokenizer:{root:[[/[\\][a-zA-Z]+/,"keyword"],[/\$[^$]*\$/,"string"],[/\\[\(\[][^{}]*\\[\)\]]/,"string"],[/%.*$/,"comment"],[/[{}]/,"delimiter"],[/\\(begin|end)\{[a-zA-Z]*\}/,"keyword"],[/[\[\]()]/,"delimiter"]]}})},[]);return(0,a.jsx)("div",{className:"w-full h-full max-h-full",onMouseUp:j,children:(0,a.jsx)(n.Ay,{height:"100%",width:"100%",onMount:v,value:o?void 0:s,language:t,onChange:g,beforeMount:b,theme:"dark"===p?"dark":"light",options:y})})}},93875:(e,t,s)=>{"use strict";s.d(t,{H:()=>x});var a=s(42419),l=s(23232),n=s(52265),i=s(77232),r=s(87891),o=s(88382),c=s(65146),d=s(14908),u=s(3353),m=s(56907),h=s(61349),f=s(71865);let x=e=>{let{assetId:t,content:s,filename:x}=e,p=(0,l._)(),g=(0,r.R)(e=>e.shareAsset),v=(0,r.R)(e=>e.cloneAsset),[j,y]=(0,o.useState)(!1),[b,w]=(0,o.useState)(!1),[k,N]=(0,o.useState)(!1),I=(0,f.n)(),{t:C}=(0,c.Bd)("files"),S=(0,o.useCallback)(async()=>{p("file_content_copy_click",void 0,{location:"files:useFileActions:handleCopy",contentType:"text/markdown"}),s&&(await (0,a.L)(s),setTimeout(()=>{y(!1)},1e3),y(!0),d.oR.success(C("files.content.copied","Copied")))},[s,p,C]),E=(0,o.useCallback)(()=>{p("file_content_download_click",void 0,{location:"files:useFileActions:handleDownload",contentType:"text/markdown"});let e=new Blob([s],{type:"text/markdown"});(0,n.W)(e,x)},[p,s,x]);return{handleCopy:S,copyPressed:j,handleDownload:E,handleShare:(0,o.useCallback)(async()=>{if(p("file_content_share_click",void 0,{location:"files:useFileActions:handleShare",contentType:"text/markdown"}),!t)return;if(I)return void function(e){let{assetId:t,title:s}=e,a=["share-asset",t];u.Q.getState().openShareDialog({title:s,onSave:async()=>Promise.resolve().then(()=>{(0,h.SX)().invalidateQueries({queryKey:a})}).catch(e=>{throw e}),useFetchData:()=>(0,m.IT)({queryKey:a,queryFn:async()=>({sharedWithTeam:!1,sharedWithUserIds:[]})})})}({assetId:t,title:"".concat(C("share-asset.title","Share")," ").concat(x)});w(!0);let e=!1;try{await g(t),e=!0}catch(e){d.oR.error(C("Failed to share file.","Failed to share file."))}finally{w(!1)}if(!e)return;setTimeout(()=>{N(!1)},1e3),N(!0);let s=window.location.origin+"/shared-file/"+t;(0,i.g)(s,C("Copied share link to clipboard.","Copied share link to clipboard."))},[p,t,g,C,x,I]),sharePressed:k,shareLoading:b,handleClone:(0,o.useCallback)(async()=>{if(p("file_content_clone_click",void 0,{location:"files:useFileActions:handleClone",contentType:"text/markdown"}),!t)return;let{assetId:e}=await v(t);e&&(window.location.href="/files/?file=".concat(e))},[p,t,v])}}}},e=>{var t=t=>e(e.s=t);e.O(0,[85354,81262,62254,51829,51335,64713,28422,55050,94150,4684,55701,37866,97652,26294,8527,77186,58895,18096,24657,95861,72869,20337,34511,6132,67303,36917,66432,74248,9159,53592,77123,33846,49705,21572,34759,22067,7405,94368,24823,11750,20549,10953,29023,80562,13002,14987,47610,20204,77358],()=>t(70154)),_N_E=e.O()}]);